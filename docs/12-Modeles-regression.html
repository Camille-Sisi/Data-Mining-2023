<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 12 Modèles de régression : application sur le RP 2019 | DATA MINING</title>
  <meta name="description" content="Titre du cours" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 12 Modèles de régression : application sur le RP 2019 | DATA MINING" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Titre du cours" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 12 Modèles de régression : application sur le RP 2019 | DATA MINING" />
  
  <meta name="twitter:description" content="Titre du cours" />
  

<meta name="author" content="Camille Signoretto, Maîtresse de conférences en économie, Université Paris Cité" />


<meta name="date" content="2023-05-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="11-Clustering-application.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/tidyverse.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Mining :  <em>Camille Signoretto</em></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html"><i class="fa fa-check"></i>Présentation</a>
<ul>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html#à-propos-de-ce-document"><i class="fa fa-check"></i>À propos de ce document</a></li>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html#prérequis"><i class="fa fa-check"></i>Prérequis</a></li>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html#remerciements"><i class="fa fa-check"></i>Remerciements</a></li>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html#licence"><i class="fa fa-check"></i>Licence</a></li>
</ul></li>
<li class="part"><span><b>Séance 1 : Data Wrangling</b></span></li>
<li class="chapter" data-level="1" data-path="01-Base-de-donnees.html"><a href="01-Base-de-donnees.html"><i class="fa fa-check"></i><b>1</b> Récupération de la base de données</a>
<ul>
<li class="chapter" data-level="1.1" data-path="01-Base-de-donnees.html"><a href="01-Base-de-donnees.html#les-données-du-recensement-de-la-population-rp"><i class="fa fa-check"></i><b>1.1</b> Les données du Recensement de la Population (RP)</a></li>
<li class="chapter" data-level="1.2" data-path="01-Base-de-donnees.html"><a href="01-Base-de-donnees.html#quelles-informations-intéressantes-dans-cette-base"><i class="fa fa-check"></i><b>1.2</b> Quelles informations intéressantes dans cette base ?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="02-Manipulation-base.html"><a href="02-Manipulation-base.html"><i class="fa fa-check"></i><b>2</b> Manipulation de la base</a>
<ul>
<li class="chapter" data-level="2.1" data-path="02-Manipulation-base.html"><a href="02-Manipulation-base.html#format-des-données---wide-ou-long"><i class="fa fa-check"></i><b>2.1</b> Format des données - WIDE ou LONG</a></li>
<li class="chapter" data-level="2.2" data-path="02-Manipulation-base.html"><a href="02-Manipulation-base.html#sélectionner-un-champ-réduit-de-la-base-séparer-les-données"><i class="fa fa-check"></i><b>2.2</b> Sélectionner un champ réduit de la base, séparer les données</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html"><i class="fa fa-check"></i><b>3</b> Manipulation des variables</a>
<ul>
<li class="chapter" data-level="3.1" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#manipulation-des-variables-qualitatives"><i class="fa fa-check"></i><b>3.1</b> Manipulation des variables qualitatives</a></li>
<li class="chapter" data-level="3.2" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#manipulation-des-variables-quantitatives"><i class="fa fa-check"></i><b>3.2</b> Manipulation des variables quantitatives</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#détecter-et-visualiser-les-valeurs-manquantes"><i class="fa fa-check"></i><b>3.2.1</b> Détecter et “visualiser” les valeurs manquantes</a></li>
<li class="chapter" data-level="3.2.2" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#gérer-les-valeurs-manquantes"><i class="fa fa-check"></i><b>3.2.2</b> Gérer les valeurs manquantes</a></li>
<li class="chapter" data-level="3.2.3" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#détecter-et-visualiser-les-valeurs-aberrantes"><i class="fa fa-check"></i><b>3.2.3</b> Détecter et “visualiser” les valeurs aberrantes</a></li>
<li class="chapter" data-level="3.2.4" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#découper-en-classes-une-variable-quantitative"><i class="fa fa-check"></i><b>3.2.4</b> Découper en classes une variable quantitative</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="04-Récapitulatif.html"><a href="04-Récapitulatif.html"><i class="fa fa-check"></i><b>4</b> Récapitulatig séance 1 - Data Wrangling</a>
<ul>
<li class="chapter" data-level="4.1" data-path="04-Récapitulatif.html"><a href="04-Récapitulatif.html#ce-quon-a-appris"><i class="fa fa-check"></i><b>4.1</b> Ce qu’on a appris</a></li>
<li class="chapter" data-level="4.2" data-path="04-Récapitulatif.html"><a href="04-Récapitulatif.html#enregistrement-des-tables"><i class="fa fa-check"></i><b>4.2</b> Enregistrement des tables</a></li>
</ul></li>
<li class="part"><span><b>Séance 2 : Data Mining - Analyse descriptive</b></span></li>
<li class="chapter" data-level="5" data-path="05-Questions-fouille-donnees.html"><a href="05-Questions-fouille-donnees.html"><i class="fa fa-check"></i><b>5</b> Quelles questions intéressantes pour une “fouille de données” sur cette base ?</a>
<ul>
<li class="chapter" data-level="5.1" data-path="05-Questions-fouille-donnees.html"><a href="05-Questions-fouille-donnees.html#caractéristiques-des-logements-de-la-commune-de-paris"><i class="fa fa-check"></i><b>5.1</b> Caractéristiques des logements de la commune de Paris</a></li>
<li class="chapter" data-level="5.2" data-path="05-Questions-fouille-donnees.html"><a href="05-Questions-fouille-donnees.html#systématiser-nos-procédures-construire-une-fonction"><i class="fa fa-check"></i><b>5.2</b> Systématiser nos procédures : construire une fonction</a></li>
</ul></li>
<li class="part"><span><b>Séance 3 : Introduction à ShinyApp</b></span></li>
<li class="chapter" data-level="6" data-path="06-Intro-a-Shiny-theorique.html"><a href="06-Intro-a-Shiny-theorique.html"><i class="fa fa-check"></i><b>6</b> Les applications interactives avec Shiny App</a>
<ul>
<li class="chapter" data-level="6.1" data-path="06-Intro-a-Shiny-theorique.html"><a href="06-Intro-a-Shiny-theorique.html#la-structure-générale-dune-application-shiny"><i class="fa fa-check"></i><b>6.1</b> La structure générale d’une application Shiny</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="06-Intro-a-Shiny-theorique.html"><a href="06-Intro-a-Shiny-theorique.html#la-partie-ui"><i class="fa fa-check"></i><b>6.1.1</b> La partie “UI”</a></li>
<li class="chapter" data-level="6.1.2" data-path="06-Intro-a-Shiny-theorique.html"><a href="06-Intro-a-Shiny-theorique.html#la-partie-server"><i class="fa fa-check"></i><b>6.1.2</b> La partie “Server”</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="06-Intro-a-Shiny-theorique.html"><a href="06-Intro-a-Shiny-theorique.html#la-réactivité"><i class="fa fa-check"></i><b>6.2</b> La réactivité</a></li>
<li class="chapter" data-level="6.3" data-path="06-Intro-a-Shiny-theorique.html"><a href="06-Intro-a-Shiny-theorique.html#un-exemple-avec-le-code-du-script-par-défaut"><i class="fa fa-check"></i><b>6.3</b> Un exemple avec le code du script par défaut</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="07-Intro-a-Shiny-exemples.html"><a href="07-Intro-a-Shiny-exemples.html"><i class="fa fa-check"></i><b>7</b> La création d’une application Shiny “pas à pas” avec l’une de nos bases de données</a>
<ul>
<li class="chapter" data-level="7.1" data-path="07-Intro-a-Shiny-exemples.html"><a href="07-Intro-a-Shiny-exemples.html#application-vide"><i class="fa fa-check"></i><b>7.1</b> Application vide</a></li>
<li class="chapter" data-level="7.2" data-path="07-Intro-a-Shiny-exemples.html"><a href="07-Intro-a-Shiny-exemples.html#ajout-dun-titre-et-dun-widget"><i class="fa fa-check"></i><b>7.2</b> Ajout d’un titre et d’un widget</a></li>
<li class="chapter" data-level="7.3" data-path="07-Intro-a-Shiny-exemples.html"><a href="07-Intro-a-Shiny-exemples.html#ajout-dun-graphique"><i class="fa fa-check"></i><b>7.3</b> Ajout d’un graphique</a></li>
<li class="chapter" data-level="7.4" data-path="07-Intro-a-Shiny-exemples.html"><a href="07-Intro-a-Shiny-exemples.html#modification-du-graphique-filtrer-selon-une-variable"><i class="fa fa-check"></i><b>7.4</b> Modification du graphique : filtrer selon une variable</a></li>
<li class="chapter" data-level="7.5" data-path="07-Intro-a-Shiny-exemples.html"><a href="07-Intro-a-Shiny-exemples.html#modification-du-graphique-selon-une-variable-au-choix-parmi-deux"><i class="fa fa-check"></i><b>7.5</b> Modification du graphique : selon une variable au choix parmi deux</a></li>
</ul></li>
<li class="part"><span><b>Séances 4 à 6 : Data Visualization</b></span></li>
<li class="chapter" data-level="8" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html"><i class="fa fa-check"></i><b>8</b> Data Visualization et Ggplot2 : aspects théoriques</a>
<ul>
<li class="chapter" data-level="8.1" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#présentation-générale-de-ggplot2"><i class="fa fa-check"></i><b>8.1</b> Présentation générale de Ggplot2</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#les-aesthetics-ou-arguments-esthétiques"><i class="fa fa-check"></i><b>8.1.1</b> Les “aesthetics” ou arguments esthétiques</a></li>
<li class="chapter" data-level="8.1.2" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#les-géométries"><i class="fa fa-check"></i><b>8.1.2</b> Les géométries</a></li>
<li class="chapter" data-level="8.1.3" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#les-facettes"><i class="fa fa-check"></i><b>8.1.3</b> Les facettes</a></li>
<li class="chapter" data-level="8.1.4" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#les-statistiques"><i class="fa fa-check"></i><b>8.1.4</b> Les statistiques</a></li>
<li class="chapter" data-level="8.1.5" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#les-coordonnées"><i class="fa fa-check"></i><b>8.1.5</b> Les coordonnées</a></li>
<li class="chapter" data-level="8.1.6" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#les-thèmes"><i class="fa fa-check"></i><b>8.1.6</b> Les thèmes</a></li>
<li class="chapter" data-level="8.1.7" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#les-autres-options-graphiques-titres-échelles-des-axes-etc."><i class="fa fa-check"></i><b>8.1.7</b> Les autres options graphiques : titres, échelles des axes, etc.</a></li>
<li class="chapter" data-level="8.1.8" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#code-minimal"><i class="fa fa-check"></i><b>8.1.8</b> Code minimal</a></li>
<li class="chapter" data-level="8.1.9" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#liens-utiles-pour-aller-plus-loin"><i class="fa fa-check"></i><b>8.1.9</b> Liens utiles pour aller plus loin</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#les-grands-principes-de-data-visualization"><i class="fa fa-check"></i><b>8.2</b> Les grands principes de data visualization</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="09-Ggplot-pratique.html"><a href="09-Ggplot-pratique.html"><i class="fa fa-check"></i><b>9</b> Le package Ggplot en pratiques</a>
<ul>
<li class="chapter" data-level="9.1" data-path="09-Ggplot-pratique.html"><a href="09-Ggplot-pratique.html#exemple-de-la-construction-dun-graphique-pas-à-pas"><i class="fa fa-check"></i><b>9.1</b> Exemple de la construction d’un graphique pas à pas</a></li>
<li class="chapter" data-level="9.2" data-path="09-Ggplot-pratique.html"><a href="09-Ggplot-pratique.html#dautres-exemples-à-travers-des-exercices"><i class="fa fa-check"></i><b>9.2</b> D’autres exemples à travers des exercices</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="09-Ggplot-pratique.html"><a href="09-Ggplot-pratique.html#distribution-du-prix-au-m2-pour-les-appartements-selon-les-arrondissements-de-paris"><i class="fa fa-check"></i><b>9.2.1</b> Distribution du prix au m2 pour les appartements, selon les arrondissements de Paris</a></li>
<li class="chapter" data-level="9.2.2" data-path="09-Ggplot-pratique.html"><a href="09-Ggplot-pratique.html#comparaison-des-montants-moyen-et-médian-du-prix-au-m2-par-département-de-paris-et-sa-petite-couronne"><i class="fa fa-check"></i><b>9.2.2</b> Comparaison des montants moyen et médian du prix au m2, par département de Paris et sa petite couronne</a></li>
<li class="chapter" data-level="9.2.3" data-path="09-Ggplot-pratique.html"><a href="09-Ggplot-pratique.html#evolution-du-prix-moyen-au-m2-des-ventes-dappartements-à-paris"><i class="fa fa-check"></i><b>9.2.3</b> Evolution du prix moyen au m2 des ventes d’appartements à Paris</a></li>
<li class="chapter" data-level="9.2.4" data-path="09-Ggplot-pratique.html"><a href="09-Ggplot-pratique.html#top-5-du-prix-au-m2-des-ventes-dappartements-selon-les-communes-ou-arrondissements"><i class="fa fa-check"></i><b>9.2.4</b> Top 5 du prix au m2 des ventes d’appartements selon les communes (ou arrondissements)</a></li>
<li class="chapter" data-level="9.2.5" data-path="09-Ggplot-pratique.html"><a href="09-Ggplot-pratique.html#à-vous-de-jouer"><i class="fa fa-check"></i><b>9.2.5</b> À vous de “jouer” !</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-Retour-sur-Shiny.html"><a href="10-Retour-sur-Shiny.html"><i class="fa fa-check"></i><b>10</b> Application sur Shiny</a>
<ul>
<li class="chapter" data-level="10.1" data-path="10-Retour-sur-Shiny.html"><a href="10-Retour-sur-Shiny.html#application-avec-un-tableau-et-un-graphique"><i class="fa fa-check"></i><b>10.1</b> Application avec un tableau et un graphique</a></li>
<li class="chapter" data-level="10.2" data-path="10-Retour-sur-Shiny.html"><a href="10-Retour-sur-Shiny.html#introduction-dune-réactivité-appliquée-à-la-table-de-données"><i class="fa fa-check"></i><b>10.2</b> Introduction d’une réactivité appliquée à la table de données</a></li>
<li class="chapter" data-level="10.3" data-path="10-Retour-sur-Shiny.html"><a href="10-Retour-sur-Shiny.html#introduction-dune-réactivité-sur-les-inputs-contexte-réactif"><i class="fa fa-check"></i><b>10.3</b> Introduction d’une réactivité sur les inputs (contexte réactif)</a></li>
</ul></li>
<li class="part"><span><b>Séance 7 : Data Mining</b></span></li>
<li class="chapter" data-level="11" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html"><i class="fa fa-check"></i><b>11</b> Clustering : application sur le RP 2019</a>
<ul>
<li class="chapter" data-level="11.1" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#choix-des-variables-et-préparation-du-tableau-final"><i class="fa fa-check"></i><b>11.1</b> Choix des variables et préparation du tableau final</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#variables-socio-professionnelles-caractérisant-la-personne-de-référence-du-ménage"><i class="fa fa-check"></i><b>11.1.1</b> Variables socio-professionnelles caractérisant la personne de référence du ménage</a></li>
<li class="chapter" data-level="11.1.2" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#création-des-différents-tableaux-de-contingence"><i class="fa fa-check"></i><b>11.1.2</b> Création des différents tableaux de contingence</a></li>
<li class="chapter" data-level="11.1.3" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#création-du-tableau-final"><i class="fa fa-check"></i><b>11.1.3</b> Création du tableau final</a></li>
<li class="chapter" data-level="11.1.4" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#choix-des-variables-actives-dans-le-clustering"><i class="fa fa-check"></i><b>11.1.4</b> choix des variables actives dans le clustering</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#la-méthode-de-la-cah-appliquée-à-nos-données"><i class="fa fa-check"></i><b>11.2</b> La méthode de la CAH appliquée à nos données</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#constitution-des-classes"><i class="fa fa-check"></i><b>11.2.1</b> Constitution des classes</a></li>
<li class="chapter" data-level="11.2.2" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#visualisation-sur-la-carte-de-la-commune"><i class="fa fa-check"></i><b>11.2.2</b> Visualisation sur la carte de la commune</a></li>
<li class="chapter" data-level="11.2.3" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#interprétation"><i class="fa fa-check"></i><b>11.2.3</b> Interprétation</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#la-méthode-des-k-means-appliquée-à-nos-données"><i class="fa fa-check"></i><b>11.3</b> La méthode des <em>k-means</em> appliquée à nos données</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="12-Modeles-regression.html"><a href="12-Modeles-regression.html"><i class="fa fa-check"></i><b>12</b> Modèles de régression : application sur le RP 2019</a>
<ul>
<li class="chapter" data-level="12.1" data-path="12-Modeles-regression.html"><a href="12-Modeles-regression.html#la-création-des-bases-dapprentissage-et-de-test"><i class="fa fa-check"></i><b>12.1</b> La création des bases d’apprentissage et de test</a></li>
<li class="chapter" data-level="12.2" data-path="12-Modeles-regression.html"><a href="12-Modeles-regression.html#un-modèle-à-visée-principale-descriptiveexplicative-la-régression-logistique"><i class="fa fa-check"></i><b>12.2</b> Un modèle à visée principale descriptive/explicative : la régression logistique</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="12-Modeles-regression.html"><a href="12-Modeles-regression.html#le-modèle-initial"><i class="fa fa-check"></i><b>12.2.1</b> Le modèle initial</a></li>
<li class="chapter" data-level="12.2.2" data-path="12-Modeles-regression.html"><a href="12-Modeles-regression.html#lévaluation-du-modèle-et-la-recherche-éventuelle-dun-meilleur-modèle"><i class="fa fa-check"></i><b>12.2.2</b> L’évaluation du modèle et la recherche éventuelle d’un “meilleur” modèle</a></li>
<li class="chapter" data-level="12.2.3" data-path="12-Modeles-regression.html"><a href="12-Modeles-regression.html#le-modèle-final-et-linterprétation-des-résultats"><i class="fa fa-check"></i><b>12.2.3</b> Le modèle final et l’interprétation des résultats</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="12-Modeles-regression.html"><a href="12-Modeles-regression.html#un-modèle-à-visée-principale-prédictive-labre-de-décision"><i class="fa fa-check"></i><b>12.3</b> Un modèle à visée principale prédictive : l’abre de décision</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="12-Modeles-regression.html"><a href="12-Modeles-regression.html#le-modèle-initial-1"><i class="fa fa-check"></i><b>12.3.1</b> Le modèle initial</a></li>
<li class="chapter" data-level="12.3.2" data-path="12-Modeles-regression.html"><a href="12-Modeles-regression.html#lévaluation-du-modèle"><i class="fa fa-check"></i><b>12.3.2</b> L’évaluation du modèle</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DATA MINING</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="c12-Modeles-regression" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Section 12</span> Modèles de régression : application sur le RP 2019<a href="12-Modeles-regression.html#c12-Modeles-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div align="justify">

<p>On cherche maintenant à expliquer un phénomène ou une variable par rapport à d’autres. On va ici s’intéresser au fait d’être en emploi plutôt que de ne pas l’être (regroupant 2 situations : au chômage et inactif).</p>
<p>On va repartir de la base RP2019, mais comme elle porte sur les logements, pour être cohérent, on va utiliser les variables se rapportant à la personne de référence du ménage. Si ce n’est pas idéal (car le mieux aurait été d’utiliser plutôt la base des individus, ce qui aurait permis d’avoir davantage de variables individuelles), cela permet quand même de réaliser quelques modèles descriptifs et prédictifs.</p>
<div id="la-création-des-bases-dapprentissage-et-de-test" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> La création des bases d’apprentissage et de test<a href="12-Modeles-regression.html#la-création-des-bases-dapprentissage-et-de-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>On crée notre base de travail en ne prenant que les variables qui nous intéressent et le champ le plus pertinent pour cette analyse : on ne travaillera que sur Paris et le 12ème arrondissement et sur les logements en résidence principale (on supprime la modalité “Y” des variables).</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="12-Modeles-regression.html#cb191-1" aria-hidden="true" tabindex="-1"></a>RP_Paris <span class="ot">&lt;-</span> RP <span class="sc">%&gt;%</span> </span>
<span id="cb191-2"><a href="12-Modeles-regression.html#cb191-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COMMUNE<span class="sc">==</span><span class="st">&quot;75056&quot;</span> <span class="sc">&amp;</span> HLML<span class="sc">!=</span><span class="st">&quot;Y&quot;</span> <span class="sc">&amp;</span> DIPLM<span class="sc">!=</span><span class="st">&quot;YY&quot;</span> <span class="sc">&amp;</span> IMMIM <span class="sc">!=</span><span class="st">&quot;Y&quot;</span> </span>
<span id="cb191-3"><a href="12-Modeles-regression.html#cb191-3" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">&amp;</span> RECHM <span class="sc">!=</span><span class="st">&quot;Y&quot;</span> <span class="sc">&amp;</span>  <span class="sc">!</span>AGEMEN8 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;00&quot;</span>,  <span class="st">&quot;YY&quot;</span>) <span class="sc">&amp;</span> </span>
<span id="cb191-4"><a href="12-Modeles-regression.html#cb191-4" aria-hidden="true" tabindex="-1"></a>           ARM <span class="sc">==</span> <span class="st">&quot;75112&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb191-5"><a href="12-Modeles-regression.html#cb191-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diplome=</span><span class="fu">as.factor</span>(<span class="fu">case_when</span>(DIPLM <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;01&quot;</span>, <span class="st">&quot;02&quot;</span>, <span class="st">&quot;03&quot;</span>, <span class="st">&quot;11&quot;</span>, <span class="st">&quot;12&quot;</span>,</span>
<span id="cb191-6"><a href="12-Modeles-regression.html#cb191-6" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">&quot;13&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Peu_pas_dipl&quot;</span>,</span>
<span id="cb191-7"><a href="12-Modeles-regression.html#cb191-7" aria-hidden="true" tabindex="-1"></a>                                     DIPLM <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;14&quot;</span>, <span class="st">&quot;15&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Bac&quot;</span>,</span>
<span id="cb191-8"><a href="12-Modeles-regression.html#cb191-8" aria-hidden="true" tabindex="-1"></a>                                     DIPLM <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;16&quot;</span>, <span class="st">&quot;17&quot;</span>, <span class="st">&quot;18&quot;</span>, <span class="st">&quot;19&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Sup_Bac&quot;</span>)),</span>
<span id="cb191-9"><a href="12-Modeles-regression.html#cb191-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">emploi=</span><span class="fu">as.factor</span>(<span class="fu">case_when</span>(RECHM <span class="sc">%in%</span> <span class="fu">c</span>( <span class="st">&quot;Z&quot;</span>) <span class="sc">~</span> <span class="st">&quot;oui&quot;</span>,</span>
<span id="cb191-10"><a href="12-Modeles-regression.html#cb191-10" aria-hidden="true" tabindex="-1"></a>                                    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;non&quot;</span>)),</span>
<span id="cb191-11"><a href="12-Modeles-regression.html#cb191-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">immigres=</span><span class="fu">as.factor</span>(<span class="fu">case_when</span>(IMMIM<span class="sc">==</span><span class="st">&quot;1&quot;</span> <span class="sc">~</span><span class="st">&quot;Oui&quot;</span>,</span>
<span id="cb191-12"><a href="12-Modeles-regression.html#cb191-12" aria-hidden="true" tabindex="-1"></a>                                      IMMIM<span class="sc">==</span><span class="st">&quot;2&quot;</span> <span class="sc">~</span> <span class="st">&quot;Non&quot;</span>)),</span>
<span id="cb191-13"><a href="12-Modeles-regression.html#cb191-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">proprio=</span><span class="fu">as.factor</span>(<span class="fu">case_when</span>(STOCD <span class="sc">==</span> <span class="st">&quot;10&quot;</span> <span class="sc">~</span> <span class="st">&quot;Oui&quot;</span>,</span>
<span id="cb191-14"><a href="12-Modeles-regression.html#cb191-14" aria-hidden="true" tabindex="-1"></a>                                     <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Non&quot;</span>)),</span>
<span id="cb191-15"><a href="12-Modeles-regression.html#cb191-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">voiture=</span><span class="fu">as.factor</span>(<span class="fu">case_when</span>(VOIT <span class="sc">==</span> <span class="st">&quot;0&quot;</span> <span class="sc">~</span> <span class="st">&quot;Non&quot;</span>,</span>
<span id="cb191-16"><a href="12-Modeles-regression.html#cb191-16" aria-hidden="true" tabindex="-1"></a>                                     <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Oui&quot;</span>)),</span>
<span id="cb191-17"><a href="12-Modeles-regression.html#cb191-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">celibataire=</span><span class="fu">as.factor</span>(<span class="fu">case_when</span>(STAT_CONJM<span class="sc">==</span><span class="st">&quot;6&quot;</span> <span class="sc">~</span> <span class="st">&quot;Oui&quot;</span>,</span>
<span id="cb191-18"><a href="12-Modeles-regression.html#cb191-18" aria-hidden="true" tabindex="-1"></a>                                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Non&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb191-19"><a href="12-Modeles-regression.html#cb191-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(immigres, proprio, diplome, emploi, voiture, SEXEM, celibataire)</span></code></pre></div>
<p>On divise ensuite notre base de données en deux pour avoir un échantillon dit d’apprentissage ou d’entraînement, et un autre dit test.<br />
On utilise pour cela la fonction <code>sample</code> (mais d’autres fonctions existent) en lui spécifiant la façon de diviser la base avec l’argument <code>prob=</code> : ici on choisit de diviser notre base selon un rapport 70% <em>vs</em> 30%, autrement dit notre base d’apprentissage comprendra 70% des données de la base initiale, alors que la base de test comprendra les 30% restants. On pourrait procéder à un rapport du type 80% <em>vs</em> 20%, ou 75% <em>vs</em> 25%, etc.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="12-Modeles-regression.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On choisit la façon de diviser notre base et on l&#39;applique en créant 2 bases</span></span>
<span id="cb192-2"><a href="12-Modeles-regression.html#cb192-2" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="fu">nrow</span>(RP_Paris), <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.70</span>,<span class="fl">0.3</span>))</span>
<span id="cb192-3"><a href="12-Modeles-regression.html#cb192-3" aria-hidden="true" tabindex="-1"></a>RP_Paris_train <span class="ot">&lt;-</span> RP_Paris[sample, ]</span>
<span id="cb192-4"><a href="12-Modeles-regression.html#cb192-4" aria-hidden="true" tabindex="-1"></a>RP_Paris_test <span class="ot">&lt;-</span> RP_Paris[<span class="sc">!</span>sample, ]</span>
<span id="cb192-5"><a href="12-Modeles-regression.html#cb192-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-6"><a href="12-Modeles-regression.html#cb192-6" aria-hidden="true" tabindex="-1"></a><span class="co"># On regarde quelle est la taille de nos deux bases</span></span>
<span id="cb192-7"><a href="12-Modeles-regression.html#cb192-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(RP_Paris_train)</span></code></pre></div>
<pre><code>[1] 20818     7</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="12-Modeles-regression.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(RP_Paris_test)</span></code></pre></div>
<pre><code>[1] 8981    7</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="12-Modeles-regression.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On vérifie que les proportions de notre variable d&#39;intérêt est assez</span></span>
<span id="cb196-2"><a href="12-Modeles-regression.html#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="co"># proche entre les deux bases</span></span>
<span id="cb196-3"><a href="12-Modeles-regression.html#cb196-3" aria-hidden="true" tabindex="-1"></a>RP_Paris_train <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(emploi) <span class="sc">%&gt;%</span> <span class="fu">adorn_pct_formatting</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb196-4"><a href="12-Modeles-regression.html#cb196-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="st">&quot;row&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code></pre></div>
<div id="kpnsjmcekn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kpnsjmcekn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kpnsjmcekn thead, #kpnsjmcekn tbody, #kpnsjmcekn tfoot, #kpnsjmcekn tr, #kpnsjmcekn td, #kpnsjmcekn th {
  border-style: none;
}

#kpnsjmcekn p {
  margin: 0;
  padding: 0;
}

#kpnsjmcekn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kpnsjmcekn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kpnsjmcekn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kpnsjmcekn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kpnsjmcekn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kpnsjmcekn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kpnsjmcekn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kpnsjmcekn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kpnsjmcekn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kpnsjmcekn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kpnsjmcekn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kpnsjmcekn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kpnsjmcekn .gt_spanner_row {
  border-bottom-style: hidden;
}

#kpnsjmcekn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kpnsjmcekn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kpnsjmcekn .gt_from_md > :first-child {
  margin-top: 0;
}

#kpnsjmcekn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kpnsjmcekn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kpnsjmcekn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kpnsjmcekn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kpnsjmcekn .gt_row_group_first td {
  border-top-width: 2px;
}

#kpnsjmcekn .gt_row_group_first th {
  border-top-width: 2px;
}

#kpnsjmcekn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kpnsjmcekn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kpnsjmcekn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kpnsjmcekn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kpnsjmcekn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kpnsjmcekn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kpnsjmcekn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kpnsjmcekn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kpnsjmcekn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kpnsjmcekn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kpnsjmcekn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kpnsjmcekn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kpnsjmcekn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kpnsjmcekn .gt_left {
  text-align: left;
}

#kpnsjmcekn .gt_center {
  text-align: center;
}

#kpnsjmcekn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kpnsjmcekn .gt_font_normal {
  font-weight: normal;
}

#kpnsjmcekn .gt_font_bold {
  font-weight: bold;
}

#kpnsjmcekn .gt_font_italic {
  font-style: italic;
}

#kpnsjmcekn .gt_super {
  font-size: 65%;
}

#kpnsjmcekn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kpnsjmcekn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kpnsjmcekn .gt_indent_1 {
  text-indent: 5px;
}

#kpnsjmcekn .gt_indent_2 {
  text-indent: 10px;
}

#kpnsjmcekn .gt_indent_3 {
  text-indent: 15px;
}

#kpnsjmcekn .gt_indent_4 {
  text-indent: 20px;
}

#kpnsjmcekn .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="emploi">emploi</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="percent">percent</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="emploi" class="gt_row gt_center">non</td>
<td headers="n" class="gt_row gt_right">7384</td>
<td headers="percent" class="gt_row gt_right">35.5%</td></tr>
    <tr><td headers="emploi" class="gt_row gt_center">oui</td>
<td headers="n" class="gt_row gt_right">13434</td>
<td headers="percent" class="gt_row gt_right">64.5%</td></tr>
    <tr><td headers="emploi" class="gt_row gt_center">Total</td>
<td headers="n" class="gt_row gt_right">20818</td>
<td headers="percent" class="gt_row gt_right">-</td></tr>
  </tbody>
  
  
</table>
</div>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="12-Modeles-regression.html#cb197-1" aria-hidden="true" tabindex="-1"></a>RP_Paris_test <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(emploi) <span class="sc">%&gt;%</span> <span class="fu">adorn_pct_formatting</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb197-2"><a href="12-Modeles-regression.html#cb197-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="st">&quot;row&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code></pre></div>
<div id="sknuvkkqaj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#sknuvkkqaj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#sknuvkkqaj thead, #sknuvkkqaj tbody, #sknuvkkqaj tfoot, #sknuvkkqaj tr, #sknuvkkqaj td, #sknuvkkqaj th {
  border-style: none;
}

#sknuvkkqaj p {
  margin: 0;
  padding: 0;
}

#sknuvkkqaj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sknuvkkqaj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#sknuvkkqaj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sknuvkkqaj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sknuvkkqaj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sknuvkkqaj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sknuvkkqaj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sknuvkkqaj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sknuvkkqaj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sknuvkkqaj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sknuvkkqaj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sknuvkkqaj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sknuvkkqaj .gt_spanner_row {
  border-bottom-style: hidden;
}

#sknuvkkqaj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#sknuvkkqaj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sknuvkkqaj .gt_from_md > :first-child {
  margin-top: 0;
}

#sknuvkkqaj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sknuvkkqaj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sknuvkkqaj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#sknuvkkqaj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sknuvkkqaj .gt_row_group_first td {
  border-top-width: 2px;
}

#sknuvkkqaj .gt_row_group_first th {
  border-top-width: 2px;
}

#sknuvkkqaj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sknuvkkqaj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sknuvkkqaj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sknuvkkqaj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sknuvkkqaj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sknuvkkqaj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sknuvkkqaj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#sknuvkkqaj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sknuvkkqaj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sknuvkkqaj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sknuvkkqaj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sknuvkkqaj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sknuvkkqaj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sknuvkkqaj .gt_left {
  text-align: left;
}

#sknuvkkqaj .gt_center {
  text-align: center;
}

#sknuvkkqaj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sknuvkkqaj .gt_font_normal {
  font-weight: normal;
}

#sknuvkkqaj .gt_font_bold {
  font-weight: bold;
}

#sknuvkkqaj .gt_font_italic {
  font-style: italic;
}

#sknuvkkqaj .gt_super {
  font-size: 65%;
}

#sknuvkkqaj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#sknuvkkqaj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sknuvkkqaj .gt_indent_1 {
  text-indent: 5px;
}

#sknuvkkqaj .gt_indent_2 {
  text-indent: 10px;
}

#sknuvkkqaj .gt_indent_3 {
  text-indent: 15px;
}

#sknuvkkqaj .gt_indent_4 {
  text-indent: 20px;
}

#sknuvkkqaj .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="emploi">emploi</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="percent">percent</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="emploi" class="gt_row gt_center">non</td>
<td headers="n" class="gt_row gt_right">3188</td>
<td headers="percent" class="gt_row gt_right">35.5%</td></tr>
    <tr><td headers="emploi" class="gt_row gt_center">oui</td>
<td headers="n" class="gt_row gt_right">5793</td>
<td headers="percent" class="gt_row gt_right">64.5%</td></tr>
    <tr><td headers="emploi" class="gt_row gt_center">Total</td>
<td headers="n" class="gt_row gt_right">8981</td>
<td headers="percent" class="gt_row gt_right">-</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Les deux bases présentent une répartition emploi/non emploi très proche donc pas de biais par rapport à cela.</p>
</div>
<div id="un-modèle-à-visée-principale-descriptiveexplicative-la-régression-logistique" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Un modèle à visée principale descriptive/explicative : la régression logistique<a href="12-Modeles-regression.html#un-modèle-à-visée-principale-descriptiveexplicative-la-régression-logistique" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La fonction <code>glm</code> du package <strong><code>stats</code></strong> (à installer avant appel dans la librarie) est principalement utilisée pour modéliser différents types de régression : l’argument <code>family=binomial("logit")</code> permet d’utiliser un modèle logit.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="12-Modeles-regression.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;stats&quot;)</span></span>
<span id="cb198-2"><a href="12-Modeles-regression.html#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span></code></pre></div>
<div id="le-modèle-initial" class="section level3 hasAnchor" number="12.2.1">
<h3><span class="header-section-number">12.2.1</span> Le modèle initial<a href="12-Modeles-regression.html#le-modèle-initial" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>On crée le modèle en spécifiant la variable d’intérêt puis les variables explicatives ou l’ensemble des variables présentes dans la base si nous avons déjà procédé à une sélection des variables : c’est le cas ici donc c’est pour cela que l’on indique juste un “.” après le “~”, sinon on devrait écrire les variables une par une, ou les sctoker dans une liste et appeler la liste.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="12-Modeles-regression.html#cb199-1" aria-hidden="true" tabindex="-1"></a>logit_1 <span class="ot">&lt;-</span> <span class="fu">glm</span> (emploi <span class="sc">~</span> ., <span class="at">data=</span>RP_Paris_train, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="st">&quot;logit&quot;</span>))</span>
<span id="cb199-2"><a href="12-Modeles-regression.html#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_1)</span></code></pre></div>
<pre><code>
Call:
glm(formula = emploi ~ ., family = binomial(&quot;logit&quot;), data = RP_Paris_train)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1533  -1.0508   0.6647   0.8707   1.8215  

Coefficients:
                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)          0.46101    0.04923   9.364  &lt; 2e-16 ***
immigresOui          0.19282    0.04073   4.734 2.20e-06 ***
proprioOui          -0.78629    0.03530 -22.276  &lt; 2e-16 ***
diplomePeu_pas_dipl -0.64759    0.04912 -13.184  &lt; 2e-16 ***
diplomeSup_Bac       0.93661    0.04431  21.136  &lt; 2e-16 ***
voitureOui           0.46097    0.03547  12.996  &lt; 2e-16 ***
SEXEM2              -0.47491    0.03162 -15.017  &lt; 2e-16 ***
celibataireOui       0.16332    0.03373   4.841 1.29e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 27101  on 20817  degrees of freedom
Residual deviance: 24239  on 20810  degrees of freedom
AIC: 24255

Number of Fisher Scoring iterations: 4</code></pre>
<p>Toutes les variables sont significatives.</p>
<!--On peut ensuite évaluer la significativité globale du modèle, : -->
<p>Même si ce modèle doit permettre essentiellement d’expliquer un phénomène, ici être en emploi par rapport à ne pas l’être (soit au chômage, soit inactif), on peut l’utiliser aussi pour prédire les données. C’est pour quoi nous avons d’abord appliqué le logit sur la base (réduite) d’apprentissage.</p>
<p>On va donc l’appliquer maintenant à la base test, en créant des indicateurs mesurant le taux de prédiction ou au contraire d’erreur.<br />
Le modèle <code>predict</code> permet d’abord d’abord de calculer la probabilité d’être en emploi pour chaque individu, l’argument <code>type="response"</code> permettant d’appliquer le modèle logistique. Il est plus intéressant d’avoir la probabilité d’une variable de type qualitative, “oui”/“non” comme la variable d’intérêt du modèle, il faut donc procéder à une transformation aboutissant à une nouvelle variable. Enfin, on crée une matrice de confusion qui est en réalité un tableau croisé entre les valeurs observées et les prédicitions du modèle ; et on calcule un taux d’erreur en rapportant la somme des éléments hors diagonale principale à la somme des observations totales (de la matrice donc).</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="12-Modeles-regression.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle de prédiction pour récupérer les probabilités individuelles d&#39;être en emploi</span></span>
<span id="cb201-2"><a href="12-Modeles-regression.html#cb201-2" aria-hidden="true" tabindex="-1"></a>pred.proba <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_1, <span class="at">newdata =</span> RP_Paris_test, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb201-3"><a href="12-Modeles-regression.html#cb201-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-4"><a href="12-Modeles-regression.html#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="co"># On transforme les probas en variable qualitative</span></span>
<span id="cb201-5"><a href="12-Modeles-regression.html#cb201-5" aria-hidden="true" tabindex="-1"></a>pred.moda <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(pred.proba<span class="sc">&gt;</span><span class="fl">0.5</span> <span class="sc">~</span> <span class="st">&quot;oui&quot;</span>,</span>
<span id="cb201-6"><a href="12-Modeles-regression.html#cb201-6" aria-hidden="true" tabindex="-1"></a>                              <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;non&quot;</span>))</span>
<span id="cb201-7"><a href="12-Modeles-regression.html#cb201-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-8"><a href="12-Modeles-regression.html#cb201-8" aria-hidden="true" tabindex="-1"></a><span class="co"># On crée la matrice de confusion</span></span>
<span id="cb201-9"><a href="12-Modeles-regression.html#cb201-9" aria-hidden="true" tabindex="-1"></a>matrice_conf <span class="ot">&lt;-</span> <span class="fu">table</span>(RP_Paris_test<span class="sc">$</span>emploi, pred.moda)</span>
<span id="cb201-10"><a href="12-Modeles-regression.html#cb201-10" aria-hidden="true" tabindex="-1"></a>matrice_conf</span></code></pre></div>
<pre><code>     pred.moda
       non  oui
  non 1274 1914
  oui  785 5008</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="12-Modeles-regression.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On calcule le taux d&#39;erreur</span></span>
<span id="cb203-2"><a href="12-Modeles-regression.html#cb203-2" aria-hidden="true" tabindex="-1"></a>tx_erreur <span class="ot">&lt;-</span> (matrice_conf[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">+</span>matrice_conf[<span class="dv">1</span>,<span class="dv">2</span>])<span class="sc">/</span><span class="fu">sum</span>(matrice_conf)</span>
<span id="cb203-3"><a href="12-Modeles-regression.html#cb203-3" aria-hidden="true" tabindex="-1"></a>tx_erreur <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>[1] 30.05233</code></pre>
<p>On voit que parmi la modalité observée “non” de la base de données, le modèle prédit en réalité plus de “oui” que de “non”, donc il prédit assez mal ici cette modalité ; en revanche, la prédiction est meilleure si on regarde la modalité “oui”, puisque la majorité des prédictions se retrouvent bien en “oui”. Le taux d’erreur de 30% montre bien que le modèle ne prédit pas hyper bien.</p>
</div>
<div id="lévaluation-du-modèle-et-la-recherche-éventuelle-dun-meilleur-modèle" class="section level3 hasAnchor" number="12.2.2">
<h3><span class="header-section-number">12.2.2</span> L’évaluation du modèle et la recherche éventuelle d’un “meilleur” modèle<a href="12-Modeles-regression.html#lévaluation-du-modèle-et-la-recherche-éventuelle-dun-meilleur-modèle" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>On peut améliorer le modèle en recherchant celui qui est le “meilleur” en faisant une sélection sur les variables, plus précisément en demandant au modèle de choisir les variables les plus explicatives, car peut-être que certaines ne sont pas nécessaires à l’explication du modèle (dans notre cas, nous avons néanmoins vu que toutes les variables étaient significatives donc probablement nécessaires). Pour une sélection “pas à pas”, il faut utiliser le package <strong><code>MASS</code></strong> et la fonction <code>stepAIC</code> car c’est à travers le critère AIC (“Akaike Information Criterion”, plus il sera faible, meilleur sera le modèle) que le modèle va chercher à être “meilleur”. On va d’abord faire cette sélection de façon “descendante” c’est-à-dire en partant du modèle initial “logit_1” ici : on part du modèle avec l’ensemble des variables et on en supprime une au fur et à mesure pour voir si le modèle est “meilleur”.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="12-Modeles-regression.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;MASS)</span></span>
<span id="cb205-2"><a href="12-Modeles-regression.html#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb205-3"><a href="12-Modeles-regression.html#cb205-3" aria-hidden="true" tabindex="-1"></a>logit_backward <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(logit_1, </span>
<span id="cb205-4"><a href="12-Modeles-regression.html#cb205-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">scope=</span><span class="fu">list</span>(<span class="at">lower=</span><span class="st">&quot;emploi ~ 1&quot;</span>, </span>
<span id="cb205-5"><a href="12-Modeles-regression.html#cb205-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">upper=</span><span class="st">&quot;emploi ~ immigres + proprio + diplome +</span></span>
<span id="cb205-6"><a href="12-Modeles-regression.html#cb205-6" aria-hidden="true" tabindex="-1"></a><span class="st">                          voiture + SEXEM + celibataire&quot;</span>),</span>
<span id="cb205-7"><a href="12-Modeles-regression.html#cb205-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">direction=</span><span class="st">&quot;backward&quot;</span>)</span></code></pre></div>
<pre><code>Start:  AIC=24255.39
emploi ~ immigres + proprio + diplome + voiture + SEXEM + celibataire

              Df Deviance   AIC
&lt;none&gt;              24239 24255
- immigres     1    24262 24276
- celibataire  1    24263 24277
- voiture      1    24411 24425
- SEXEM        1    24467 24481
- proprio      1    24742 24756
- diplome      2    26238 26250</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="12-Modeles-regression.html#cb207-1" aria-hidden="true" tabindex="-1"></a>logit_backward</span></code></pre></div>
<pre><code>
Call:  glm(formula = emploi ~ immigres + proprio + diplome + voiture + 
    SEXEM + celibataire, family = binomial(&quot;logit&quot;), data = RP_Paris_train)

Coefficients:
        (Intercept)          immigresOui           proprioOui  
             0.4610               0.1928              -0.7863  
diplomePeu_pas_dipl       diplomeSup_Bac           voitureOui  
            -0.6476               0.9366               0.4610  
             SEXEM2       celibataireOui  
            -0.4749               0.1633  

Degrees of Freedom: 20817 Total (i.e. Null);  20810 Residual
Null Deviance:      27100 
Residual Deviance: 24240    AIC: 24260</code></pre>
<p>Le “meilleur” modèle semble bien être celui qu’on utilise avec l’ensemble des variables qu’on avait mis.</p>
<p>Pour une sélection des variables de façon “ascendante”, en partant d’un modèle sans variable puis on ajoute une à une les variables. On utilise la même fonction mais en changeant les paramètres et en créant un modèle “vide” avant :</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="12-Modeles-regression.html#cb209-1" aria-hidden="true" tabindex="-1"></a>logit_0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(emploi <span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span>RP_Paris_train, <span class="at">family=</span><span class="fu">binomial</span>(<span class="st">&quot;logit&quot;</span>))</span>
<span id="cb209-2"><a href="12-Modeles-regression.html#cb209-2" aria-hidden="true" tabindex="-1"></a>logit_forward <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(logit_0, </span>
<span id="cb209-3"><a href="12-Modeles-regression.html#cb209-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">scope=</span><span class="fu">list</span>(<span class="at">lower=</span><span class="st">&quot;emploi ~ 1&quot;</span>, </span>
<span id="cb209-4"><a href="12-Modeles-regression.html#cb209-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">upper=</span><span class="st">&quot;emploi ~ immigres + proprio + diplome + </span></span>
<span id="cb209-5"><a href="12-Modeles-regression.html#cb209-5" aria-hidden="true" tabindex="-1"></a><span class="st">                                           voiture + SEXEM + celibataire&quot;</span>),</span>
<span id="cb209-6"><a href="12-Modeles-regression.html#cb209-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">direction=</span><span class="st">&quot;forward&quot;</span>)</span></code></pre></div>
<pre><code>Start:  AIC=27078.04
emploi ~ 1

              Df Deviance   AIC
+ diplome      2    25049 25055
+ SEXEM        1    26753 26757
+ proprio      1    26786 26790
+ voiture      1    26937 26941
+ celibataire  1    27008 27012
&lt;none&gt;              27076 27078
+ immigres     1    27075 27079

Step:  AIC=25054.83
emploi ~ diplome

              Df Deviance   AIC
+ proprio      1    24541 24549
+ SEXEM        1    24751 24759
+ voiture      1    24958 24966
+ immigres     1    25016 25024
+ celibataire  1    25028 25036
&lt;none&gt;              25049 25055

Step:  AIC=24549.44
emploi ~ diplome + proprio

              Df Deviance   AIC
+ SEXEM        1    24246 24256
+ voiture      1    24343 24353
+ immigres     1    24533 24543
&lt;none&gt;              24541 24549
+ celibataire  1    24541 24551

Step:  AIC=24255.6
emploi ~ diplome + proprio + SEXEM

              Df Deviance   AIC
+ voiture      1    24104 24116
+ celibataire  1    24239 24251
+ immigres     1    24241 24253
&lt;none&gt;              24246 24256

Step:  AIC=24116.32
emploi ~ diplome + proprio + SEXEM + voiture

              Df Deviance   AIC
+ celibataire  1    24073 24087
+ immigres     1    24098 24112
&lt;none&gt;              24104 24116

Step:  AIC=24086.7
emploi ~ diplome + proprio + SEXEM + voiture + celibataire

           Df Deviance   AIC
+ immigres  1    24064 24080
&lt;none&gt;           24073 24087

Step:  AIC=24080.02
emploi ~ diplome + proprio + SEXEM + voiture + celibataire + 
    immigres</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="12-Modeles-regression.html#cb211-1" aria-hidden="true" tabindex="-1"></a>logit_forward</span></code></pre></div>
<pre><code>
Call:  glm(formula = emploi ~ diplome + proprio + SEXEM + voiture + 
    celibataire + immigres, family = binomial(&quot;logit&quot;), data = RP_Paris_train)

Coefficients:
        (Intercept)  diplomePeu_pas_dipl       diplomeSup_Bac  
             0.4806              -0.6722               0.9532  
         proprioOui               SEXEM2           voitureOui  
            -0.8053              -0.4966               0.4588  
     celibataireOui          immigresOui  
             0.1959               0.1200  

Degrees of Freedom: 20817 Total (i.e. Null);  20810 Residual
Null Deviance:      27080 
Residual Deviance: 24060    AIC: 24080</code></pre>
<p>Le taux d’AIC diminue à chaque variable ajoutée donc le meilleur modèle est bien celui avec l’ensemble des variables explicatives mises dans le modèle initial.</p>
</div>
<div id="le-modèle-final-et-linterprétation-des-résultats" class="section level3 hasAnchor" number="12.2.3">
<h3><span class="header-section-number">12.2.3</span> Le modèle final et l’interprétation des résultats<a href="12-Modeles-regression.html#le-modèle-final-et-linterprétation-des-résultats" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finalement, on peut estimer notre modèle sur l’ensemble de la base et étudier plus précisément les résultats avec les odds-ratios par exemple pour commenter plus facilement les coefficients.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="12-Modeles-regression.html#cb213-1" aria-hidden="true" tabindex="-1"></a>logit_VF <span class="ot">&lt;-</span> <span class="fu">glm</span> (emploi <span class="sc">~</span> ., <span class="at">data=</span>RP_Paris, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="st">&quot;logit&quot;</span>))</span>
<span id="cb213-2"><a href="12-Modeles-regression.html#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_VF)</span></code></pre></div>
<pre><code>
Call:
glm(formula = emploi ~ ., family = binomial(&quot;logit&quot;), data = RP_Paris)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1496  -1.0521   0.6583   0.8656   1.8216  

Coefficients:
                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)          0.45772    0.04106  11.146  &lt; 2e-16 ***
immigresOui          0.15838    0.03400   4.658 3.19e-06 ***
proprioOui          -0.80891    0.02950 -27.419  &lt; 2e-16 ***
diplomePeu_pas_dipl -0.61950    0.04090 -15.145  &lt; 2e-16 ***
diplomeSup_Bac       0.96143    0.03696  26.014  &lt; 2e-16 ***
voitureOui           0.44997    0.02966  15.171  &lt; 2e-16 ***
SEXEM2              -0.47726    0.02645 -18.043  &lt; 2e-16 ***
celibataireOui       0.17846    0.02819   6.331 2.44e-10 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 38760  on 29798  degrees of freedom
Residual deviance: 34611  on 29791  degrees of freedom
AIC: 34627

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="12-Modeles-regression.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Résumé des résultats sous forme de tableau avec les odds-ratio</span></span>
<span id="cb215-2"><a href="12-Modeles-regression.html#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="co"># avec la librairie &quot;questionr&quot; d&#39;abord</span></span>
<span id="cb215-3"><a href="12-Modeles-regression.html#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(questionr)</span>
<span id="cb215-4"><a href="12-Modeles-regression.html#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="fu">odds.ratio</span>(logit_VF)</span></code></pre></div>
<pre><code># A tibble: 8 x 4
     OR `2.5 %` `97.5 %`         p
  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 1.58    1.46     1.71  7.45e- 29
2 1.17    1.10     1.25  3.19e-  6
3 0.445   0.420    0.472 1.64e-165
4 0.538   0.497    0.583 8.19e- 52
5 2.62    2.43     2.81  3.41e-149
6 1.57    1.48     1.66  5.52e- 52
7 0.620   0.589    0.653 8.89e- 73
8 1.20    1.13     1.26  2.44e- 10</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="12-Modeles-regression.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># puis avec la librarie &quot;forestmodel&quot; pour avoir un meilleur rendu</span></span>
<span id="cb217-2"><a href="12-Modeles-regression.html#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;forestmodel&quot;)</span></span>
<span id="cb217-3"><a href="12-Modeles-regression.html#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forestmodel)</span>
<span id="cb217-4"><a href="12-Modeles-regression.html#cb217-4" aria-hidden="true" tabindex="-1"></a><span class="fu">forest_model</span>(logit_VF)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/unnamed-chunk-130-1.svg" width="672" /></p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="12-Modeles-regression.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ou encore avec &quot;gt_summary&quot; pour avoir un meilleur rendu</span></span>
<span id="cb218-2"><a href="12-Modeles-regression.html#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb218-3"><a href="12-Modeles-regression.html#cb218-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_gtsummary_language</span>(<span class="st">&quot;fr&quot;</span>, <span class="at">decimal.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="at">big.mark=</span><span class="st">&quot; &quot;</span>)</span>
<span id="cb218-4"><a href="12-Modeles-regression.html#cb218-4" aria-hidden="true" tabindex="-1"></a>logit_VF <span class="sc">%&gt;%</span> </span>
<span id="cb218-5"><a href="12-Modeles-regression.html#cb218-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_regression</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb218-6"><a href="12-Modeles-regression.html#cb218-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_global_p</span>(<span class="at">keep=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb218-7"><a href="12-Modeles-regression.html#cb218-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(label <span class="sc">~</span> <span class="st">&quot;**Variable**&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb218-8"><a href="12-Modeles-regression.html#cb218-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_caption</span>(<span class="st">&quot;**Tableau de résultats. Variables expliquant le fait d&#39;être en emploi**&quot;</span>)</span></code></pre></div>
<div id="rtmqlwpoda" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rtmqlwpoda table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rtmqlwpoda thead, #rtmqlwpoda tbody, #rtmqlwpoda tfoot, #rtmqlwpoda tr, #rtmqlwpoda td, #rtmqlwpoda th {
  border-style: none;
}

#rtmqlwpoda p {
  margin: 0;
  padding: 0;
}

#rtmqlwpoda .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rtmqlwpoda .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rtmqlwpoda .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rtmqlwpoda .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rtmqlwpoda .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rtmqlwpoda .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rtmqlwpoda .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rtmqlwpoda .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rtmqlwpoda .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rtmqlwpoda .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rtmqlwpoda .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rtmqlwpoda .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rtmqlwpoda .gt_spanner_row {
  border-bottom-style: hidden;
}

#rtmqlwpoda .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rtmqlwpoda .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rtmqlwpoda .gt_from_md > :first-child {
  margin-top: 0;
}

#rtmqlwpoda .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rtmqlwpoda .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rtmqlwpoda .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rtmqlwpoda .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rtmqlwpoda .gt_row_group_first td {
  border-top-width: 2px;
}

#rtmqlwpoda .gt_row_group_first th {
  border-top-width: 2px;
}

#rtmqlwpoda .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rtmqlwpoda .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rtmqlwpoda .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rtmqlwpoda .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rtmqlwpoda .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rtmqlwpoda .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rtmqlwpoda .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rtmqlwpoda .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rtmqlwpoda .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rtmqlwpoda .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rtmqlwpoda .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rtmqlwpoda .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rtmqlwpoda .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rtmqlwpoda .gt_left {
  text-align: left;
}

#rtmqlwpoda .gt_center {
  text-align: center;
}

#rtmqlwpoda .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rtmqlwpoda .gt_font_normal {
  font-weight: normal;
}

#rtmqlwpoda .gt_font_bold {
  font-weight: bold;
}

#rtmqlwpoda .gt_font_italic {
  font-style: italic;
}

#rtmqlwpoda .gt_super {
  font-size: 65%;
}

#rtmqlwpoda .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rtmqlwpoda .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rtmqlwpoda .gt_indent_1 {
  text-indent: 5px;
}

#rtmqlwpoda .gt_indent_2 {
  text-indent: 10px;
}

#rtmqlwpoda .gt_indent_3 {
  text-indent: 15px;
}

#rtmqlwpoda .gt_indent_4 {
  text-indent: 20px;
}

#rtmqlwpoda .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <caption><span id="tab:unnamed-chunk-130">Table 12.1: </span><strong>Tableau de résultats. Variables expliquant le fait d’être en emploi</strong></caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;Variable&lt;/strong&gt;"><strong>Variable</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;OR&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;"><strong>OR</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;95% IC&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;"><strong>95% IC</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;p-valeur&lt;/strong&gt;"><strong>p-valeur</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">immigres</td>
<td headers="estimate" class="gt_row gt_center"></td>
<td headers="ci" class="gt_row gt_center"></td>
<td headers="p.value" class="gt_row gt_center"><0,001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Non</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="ci" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Oui</td>
<td headers="estimate" class="gt_row gt_center">1,17</td>
<td headers="ci" class="gt_row gt_center">1,10 – 1,25</td>
<td headers="p.value" class="gt_row gt_center"><0,001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">proprio</td>
<td headers="estimate" class="gt_row gt_center"></td>
<td headers="ci" class="gt_row gt_center"></td>
<td headers="p.value" class="gt_row gt_center"><0,001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Non</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="ci" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Oui</td>
<td headers="estimate" class="gt_row gt_center">0,45</td>
<td headers="ci" class="gt_row gt_center">0,42 – 0,47</td>
<td headers="p.value" class="gt_row gt_center"><0,001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">diplome</td>
<td headers="estimate" class="gt_row gt_center"></td>
<td headers="ci" class="gt_row gt_center"></td>
<td headers="p.value" class="gt_row gt_center"><0,001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Bac</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="ci" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Peu_pas_dipl</td>
<td headers="estimate" class="gt_row gt_center">0,54</td>
<td headers="ci" class="gt_row gt_center">0,50 – 0,58</td>
<td headers="p.value" class="gt_row gt_center"><0,001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Sup_Bac</td>
<td headers="estimate" class="gt_row gt_center">2,62</td>
<td headers="ci" class="gt_row gt_center">2,43 – 2,81</td>
<td headers="p.value" class="gt_row gt_center"><0,001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">voiture</td>
<td headers="estimate" class="gt_row gt_center"></td>
<td headers="ci" class="gt_row gt_center"></td>
<td headers="p.value" class="gt_row gt_center"><0,001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Non</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="ci" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Oui</td>
<td headers="estimate" class="gt_row gt_center">1,57</td>
<td headers="ci" class="gt_row gt_center">1,48 – 1,66</td>
<td headers="p.value" class="gt_row gt_center"><0,001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">SEXEM</td>
<td headers="estimate" class="gt_row gt_center"></td>
<td headers="ci" class="gt_row gt_center"></td>
<td headers="p.value" class="gt_row gt_center"><0,001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    1</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="ci" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    2</td>
<td headers="estimate" class="gt_row gt_center">0,62</td>
<td headers="ci" class="gt_row gt_center">0,59 – 0,65</td>
<td headers="p.value" class="gt_row gt_center"><0,001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">celibataire</td>
<td headers="estimate" class="gt_row gt_center"></td>
<td headers="ci" class="gt_row gt_center"></td>
<td headers="p.value" class="gt_row gt_center"><0,001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Non</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="ci" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Oui</td>
<td headers="estimate" class="gt_row gt_center">1,20</td>
<td headers="ci" class="gt_row gt_center">1,13 – 1,26</td>
<td headers="p.value" class="gt_row gt_center"><0,001</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> OR = rapport de cotes, IC = intervalle de confiance</td>
    </tr>
  </tfoot>
</table>
</div>
<p>On privilégiera plutôt les deux derniers types de tableaux : ainsi, on note que le fait d’être immigré augmente de 1,17 fois (ou de 17%) la probabilité d’être en emploi, tandis qu’être propriétaire diminue de 55% (1-0,45 * 100) cette probabilité, probablement car c’est un proxy de l’âge puisqu’on trouve plus de propriétaires chez les retraités qui sont donc inactifs. Le diplôme joue un rôle important, comme attendu : par rapport à avoir le bac, être peu ou pas diplômé diminue la probabilité d’être en emploi, d’environ 46%, alors qu’avoir un diplôme supérieur au bac augmente cette même probabilité, elle la multiplie par 2,62. Ensuite, on observe qu’avoir une voiture augmente aussi la probabilité d’être en emploi, être célibataire également, tandis qu’être une femme diminue cette même probabilité.</p>
<p>On peut aussi vouloir visualiser ces résultats, on peut pour cela utiliser la librarie <strong><code>GGally</code></strong> et la fonction <code>ggcoef_model()</code>.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="12-Modeles-regression.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Résumé des résultats sous forme graphqiue</span></span>
<span id="cb219-2"><a href="12-Modeles-regression.html#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb219-3"><a href="12-Modeles-regression.html#cb219-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcoef_model</span>(logit_VF, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb219-4"><a href="12-Modeles-regression.html#cb219-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Varibles expliquant le fait d&#39;être en emploi&quot;</span>) </span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/unnamed-chunk-131-1.svg" width="672" />
C’est peut-être le meilleur rendu…</p>
</div>
</div>
<div id="un-modèle-à-visée-principale-prédictive-labre-de-décision" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Un modèle à visée principale prédictive : l’abre de décision<a href="12-Modeles-regression.html#un-modèle-à-visée-principale-prédictive-labre-de-décision" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>On va procéder à la même analyse en cherchant, cette fois, à prédire si un individu sera en emploi ou non à partir des variables sélectionnées précédemment.<br />
On repart donc des deux tables créées et on va utiliser un modèle dit d’apprentissage supervisé, l’abre de décision. Sa construction repose sur un partitionnement récursif des observations qui se fait à partir de noeuds coupés, ces coupures pourront répondre à des règles et des conditions à spécifier ou faire varier pour avoir un meilleur modèle.<br />
Ici on va utiliser un arbre de classification puisque notre variable est qualitative (binaire).</p>
<p>C’est le package <strong><code>rpart</code></strong> qui est spécialisé dans les modèles d’arbres de décision, à installer donc d’abord puis à appeler dans la librairie ; et <strong><code>rpart.plot</code></strong> permettra d’avoir un arbre plus esthétique et informatif.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="12-Modeles-regression.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;rpart&quot;)</span></span>
<span id="cb220-2"><a href="12-Modeles-regression.html#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;rpart.plot&quot;)</span></span>
<span id="cb220-3"><a href="12-Modeles-regression.html#cb220-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb220-4"><a href="12-Modeles-regression.html#cb220-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span></code></pre></div>
<div id="le-modèle-initial-1" class="section level3 hasAnchor" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> Le modèle initial<a href="12-Modeles-regression.html#le-modèle-initial-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La spécification du modèle est assez simple, on précise la variable d’intérêt, les éventuelles variables explicatives ou toutes celles qui sont dans la table avec le <code>.</code> (comme précédemment pour le modèle logit), la base de données sur laquelle appliquer le modèle, et dans l’argument <code>method=</code> on spécifie le type de modèle, soit “class” pour une variable d’intérêt qualitative ou binaire, soit “anova” pour une variable d’intérêt quantitative ou continue.</p>
<p>On va d’abord appliquer le modèle sur notre échantillon d’apprentissage ou d’entraînement :</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="12-Modeles-regression.html#cb221-1" aria-hidden="true" tabindex="-1"></a>arbre_1 <span class="ot">&lt;-</span> <span class="fu">rpart</span>(emploi <span class="sc">~</span> ., <span class="at">data=</span>RP_Paris_train, <span class="at">method=</span><span class="st">&quot;class&quot;</span>)</span>
<span id="cb221-2"><a href="12-Modeles-regression.html#cb221-2" aria-hidden="true" tabindex="-1"></a>arbre_1</span></code></pre></div>
<pre><code>n= 20818 

node), split, n, loss, yval, (yprob)
      * denotes terminal node

 1) root 20818 7384 oui (0.3546931 0.6453069)  
   2) diplome=Bac,Peu_pas_dipl 7908 3662 non (0.5369246 0.4630754)  
     4) proprio=Oui 1934  552 non (0.7145812 0.2854188) *
     5) proprio=Non 5974 2864 oui (0.4794108 0.5205892)  
      10) voiture=Non 4305 2019 non (0.5310105 0.4689895)  
        20) diplome=Peu_pas_dipl 2781 1152 non (0.5857605 0.4142395) *
        21) diplome=Bac 1524  657 oui (0.4311024 0.5688976) *
      11) voiture=Oui 1669  578 oui (0.3463152 0.6536848) *
   3) diplome=Sup_Bac 12910 3138 oui (0.2430674 0.7569326) *</code></pre>
<p>Le modèle nous donne d’abord les résultats en format texte, ce sont des indications sur les différentes “noeuds” puis “branches” de l’arbre, etc. : “node” pour noeud et son numéro, “split” pour la condition de coupure/le critère de décision, “n” pour le nombre total d’observations dans un noeud, “loss” le nombre d’observations qui n’appartient pas à la modalité prédite, “yval” la modalité prédite (majoritaire en fait) pour les individus présents à l’étape du noeud, et “yprob” la proportion d’observations pour les individus présents à l’étape du noeud qui prend la valeur prédite en seconde position. Le petit astérix “*” précise que le noeud est une feuille (“terminal”).</p>
<p>Par exemple, ici le premier noeud indiqué “root” représente l’ensemble de l’échantillon (c’est la “racine” de l’arbre), soit 20818 observations, et il y a 64% d’observations qui auront la modalité “oui” (donc qui seront/seraient en emploi). La première variable discriminante est le diplôme : ceux ayant un bac ou étant peu ou pas diplômés (moins que le bac) forment une première branche avec un groupe qui n’est pas en emploi, alors que les diplômés supérieurs au bac forment l’autre branche et un groupe qui est en emploi. Etc.</p>
<p>On peut regarder quelles sont les variables les plus importantes dans le modèle par ordre :</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="12-Modeles-regression.html#cb223-1" aria-hidden="true" tabindex="-1"></a>arbre_1<span class="sc">$</span>variable.importance</span></code></pre></div>
<pre><code>   diplome    proprio    voiture      SEXEM   immigres 
797.609746 173.660620  83.744043  46.758124   9.561252 </code></pre>
<p>Le diplôme est la variable la plus discriminante, comme on l’avait supposé puisque c’était la première variable qui divisait notre échantillon, ensuite vient le fait d’être propriétaire ou non (qui est en réalité ici une variable qui indique aussi l’âge car on a plus de probabilité d’être propriétaire une fois à la retraite, et donc d’être inactif), etc., et en tout dernier le fait d’être immigré ou non.</p>
<p>On va mieux étudier cela avec le résultat visuel.<br />
Pour avoir ainsi graphiquement l’arbre, il faut appeler la fonction <code>rpart.plot()</code> du même package, l’argument “extra” permettant de préciser le type de modèle : “106” pour des modèles en classes avec une variable qualitative et binaire, “104” pour des modèles en classes mais avec une variable d’intérêt qualitative avec plus de 2 modalités, et “100” pour les autres modèles.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="12-Modeles-regression.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On dessine l&#39;arbre</span></span>
<span id="cb225-2"><a href="12-Modeles-regression.html#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(arbre_1, <span class="at">extra=</span><span class="dv">106</span>)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/unnamed-chunk-135-1.svg" width="672" /></p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="12-Modeles-regression.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ou avec la librarie `rattle`</span></span>
<span id="cb226-2"><a href="12-Modeles-regression.html#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(rattle)</span></span>
<span id="cb226-3"><a href="12-Modeles-regression.html#cb226-3" aria-hidden="true" tabindex="-1"></a><span class="co">#fancyRpartPlot(arbre_1)</span></span></code></pre></div>
<p>Au sommet de l’arbre on a donc la racine (qui est le 1er noeud), puis il se divise en 2 branches pour aboutir à deux autres noeuds, etc.<br />
On voit donc que la branche partant sur la gauche, c’est le cas où la variable de diplôme est égale à la modalité “Bac” ou “Peu ou pas diplôme” car on voit le “yes” qui est encadré (et ça sera le cas à chaque fois même si ce n’est pas de nouveau inscrit), la modalité prédite est alors le “non” donc pas en emploi qui est constitué de 38% des individus du noeud précédent (donc de l’échantillon total) et les individus de ce groupe (=bacheliers ou peu/pas diplômés) ont une probabilité de 47% d’être dans la situation prédite c’est-à-dire en emploi. L’autre branche indique les individidus ou observations qui prennent toutes les autres modalités de la variable.
Tout en bas, se trouvent les feuilles de l’arbre, c’est lorsqu’il n’y a plus aucune branche qui part du noeud en question.<br />
Ainsi, un individu qui aurait le bac ou un diplôme inférieur, ne serait pas propriétaire, n’aurait pas de voiture et serait une femme, il serait en emploi avec une probabilité de 41% et ce groupe constitue 12% de l’échantillon utilisé soit du total des observations.</p>
</div>
<div id="lévaluation-du-modèle" class="section level3 hasAnchor" number="12.3.2">
<h3><span class="header-section-number">12.3.2</span> L’évaluation du modèle<a href="12-Modeles-regression.html#lévaluation-du-modèle" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>On peut vérifier la bonne (ou non) prédiction du modèle en l’appliquant sur l’échantillon dit test, puis en comparant les proportions prédites avec celles effectivement observées dans la base dans la matrice de confusion (construite de la même façon que précédemment), et enfin en calculant un taux de concordance ou au contraire un taux d’erreur à partir de cette une matrice de confusion :</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="12-Modeles-regression.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle appliqué sur l&#39;échantillon test</span></span>
<span id="cb227-2"><a href="12-Modeles-regression.html#cb227-2" aria-hidden="true" tabindex="-1"></a>predict_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(arbre_1, RP_Paris_test, <span class="at">type=</span><span class="st">&quot;class&quot;</span>)</span>
<span id="cb227-3"><a href="12-Modeles-regression.html#cb227-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-4"><a href="12-Modeles-regression.html#cb227-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparaison des résultats - Matrice de confusion</span></span>
<span id="cb227-5"><a href="12-Modeles-regression.html#cb227-5" aria-hidden="true" tabindex="-1"></a>mat_confusion <span class="ot">&lt;-</span> <span class="fu">table</span>(RP_Paris_test<span class="sc">$</span>emploi, predict_test)</span>
<span id="cb227-6"><a href="12-Modeles-regression.html#cb227-6" aria-hidden="true" tabindex="-1"></a>mat_confusion</span></code></pre></div>
<pre><code>     predict_test
       non  oui
  non 1199 1968
  oui  685 5129</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="12-Modeles-regression.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Taux de concordance : rapport entre la somme des éléments </span></span>
<span id="cb229-2"><a href="12-Modeles-regression.html#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="co"># de la diagonale principale et la somme des observations </span></span>
<span id="cb229-3"><a href="12-Modeles-regression.html#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="co"># totales (soit de la matrice)</span></span>
<span id="cb229-4"><a href="12-Modeles-regression.html#cb229-4" aria-hidden="true" tabindex="-1"></a>tx_concordance <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(mat_confusion) <span class="sc">/</span> <span class="fu">sum</span>(mat_confusion))</span>
<span id="cb229-5"><a href="12-Modeles-regression.html#cb229-5" aria-hidden="true" tabindex="-1"></a>tx_concordance <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>[1] 70.45986</code></pre>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="12-Modeles-regression.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Taux d&#39;erreur</span></span>
<span id="cb231-2"><a href="12-Modeles-regression.html#cb231-2" aria-hidden="true" tabindex="-1"></a>tx_erreur <span class="ot">&lt;-</span> (mat_confusion[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">+</span> mat_confusion[<span class="dv">1</span>, <span class="dv">2</span>]) <span class="sc">/</span> <span class="fu">sum</span>(mat_confusion)</span>
<span id="cb231-3"><a href="12-Modeles-regression.html#cb231-3" aria-hidden="true" tabindex="-1"></a>tx_erreur <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>[1] 29.54014</code></pre>
<p>On peut regarder aussi ce que cela donner sur la base d’apprentissage.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="12-Modeles-regression.html#cb233-1" aria-hidden="true" tabindex="-1"></a>predict_train <span class="ot">&lt;-</span> <span class="fu">predict</span>(arbre_1, RP_Paris_train, <span class="at">type=</span><span class="st">&quot;class&quot;</span>)</span>
<span id="cb233-2"><a href="12-Modeles-regression.html#cb233-2" aria-hidden="true" tabindex="-1"></a>mat_confusion_1 <span class="ot">&lt;-</span> <span class="fu">table</span>(RP_Paris_train<span class="sc">$</span>emploi, predict_train)</span>
<span id="cb233-3"><a href="12-Modeles-regression.html#cb233-3" aria-hidden="true" tabindex="-1"></a>mat_confusion_1</span></code></pre></div>
<pre><code>     predict_train
        non   oui
  non  2825  4580
  oui  1551 11862</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="12-Modeles-regression.html#cb235-1" aria-hidden="true" tabindex="-1"></a>tx_erreur_1 <span class="ot">&lt;-</span> (mat_confusion_1[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">+</span> mat_confusion_1[<span class="dv">1</span>, <span class="dv">2</span>]) <span class="sc">/</span> <span class="fu">sum</span>(mat_confusion_1)</span>
<span id="cb235-2"><a href="12-Modeles-regression.html#cb235-2" aria-hidden="true" tabindex="-1"></a>tx_erreur_1 <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>[1] 29.45048</code></pre>
<p>Dans les deux cas, les taux d’erreur sont assez élevés, d’environ 29%. Le modèle ne prédit pas hyper bien. On peut noter qu’on a pratiquement le même taux d’erreur que le modèle logit réalisé précédemment…</p>
<p>Vérifions si nous pouvons l’améliorer en modifiant les paramètres de construction de l’arbre, c’est-à-dire en jouant sur les conditions de coupure d’un noeud et sur les règles d’arrêt de ces coupures. On l’effectue avec la fonction <code>rpart.control()</code> avec les arguments suivants (règles d’arrêt principalement) : <code>minsplit=</code> donne le nombre minimum d’observations (individus) présentes à l’étape d’un noeud pour envisager une coupure ; <code>minbucket=</code> qui donne le nombre minimum d’observations/individus présentes à l’étape d’un noeud qu’engendrerait la coupure du noeud parent ; <code>maxdepth</code> qui donne la profondeur de l’arbre ; et <code>cp=</code> qui est un paramètre de complexité (plus il est petit, plus grand est l’abre de régression).</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="12-Modeles-regression.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Définition des règles de décision</span></span>
<span id="cb237-2"><a href="12-Modeles-regression.html#cb237-2" aria-hidden="true" tabindex="-1"></a>ajust_param <span class="ot">&lt;-</span> <span class="fu">rpart.control</span>(<span class="at">minsplit=</span><span class="dv">50</span>, <span class="at">minbucket =</span> <span class="dv">50</span>, <span class="at">maxdepth =</span> <span class="dv">7</span>, <span class="at">cp=</span><span class="dv">0</span>)</span>
<span id="cb237-3"><a href="12-Modeles-regression.html#cb237-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4"><a href="12-Modeles-regression.html#cb237-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustement du modèle en indiquant le paramètre &quot;control&quot;</span></span>
<span id="cb237-5"><a href="12-Modeles-regression.html#cb237-5" aria-hidden="true" tabindex="-1"></a>arbre_2 <span class="ot">&lt;-</span> <span class="fu">rpart</span>(emploi<span class="sc">~</span>., <span class="at">data=</span>RP_Paris_train, <span class="at">method=</span><span class="st">&quot;class&quot;</span>, </span>
<span id="cb237-6"><a href="12-Modeles-regression.html#cb237-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control =</span> ajust_param)</span>
<span id="cb237-7"><a href="12-Modeles-regression.html#cb237-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-8"><a href="12-Modeles-regression.html#cb237-8" aria-hidden="true" tabindex="-1"></a><span class="co"># On étudie de nouveau la matrice de confusion et </span></span>
<span id="cb237-9"><a href="12-Modeles-regression.html#cb237-9" aria-hidden="true" tabindex="-1"></a><span class="co"># le taux d&#39;erreur associé au nouveau modèle</span></span>
<span id="cb237-10"><a href="12-Modeles-regression.html#cb237-10" aria-hidden="true" tabindex="-1"></a>predict_train <span class="ot">&lt;-</span> <span class="fu">predict</span>(arbre_2, RP_Paris_train, <span class="at">type=</span><span class="st">&quot;class&quot;</span>)</span>
<span id="cb237-11"><a href="12-Modeles-regression.html#cb237-11" aria-hidden="true" tabindex="-1"></a>mat_confusion_ajust <span class="ot">&lt;-</span> <span class="fu">table</span>(RP_Paris_train<span class="sc">$</span>emploi, predict_train)</span>
<span id="cb237-12"><a href="12-Modeles-regression.html#cb237-12" aria-hidden="true" tabindex="-1"></a>mat_confusion_ajust</span></code></pre></div>
<pre><code>     predict_train
        non   oui
  non  2757  4627
  oui  1334 12100</code></pre>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="12-Modeles-regression.html#cb239-1" aria-hidden="true" tabindex="-1"></a>tx_erreur_1 <span class="ot">&lt;-</span> (mat_confusion_ajust[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">+</span> </span>
<span id="cb239-2"><a href="12-Modeles-regression.html#cb239-2" aria-hidden="true" tabindex="-1"></a>                  mat_confusion_ajust[<span class="dv">1</span>, <span class="dv">2</span>]) <span class="sc">/</span> <span class="fu">sum</span>(mat_confusion_ajust)</span>
<span id="cb239-3"><a href="12-Modeles-regression.html#cb239-3" aria-hidden="true" tabindex="-1"></a>tx_erreur_1 <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>[1] 28.63387</code></pre>
<p>Le taux d’erreur est un peu plus faible, mais la différence est très légère !</p>
<p>On cherche à minimiser l’erreur de prédicition de l’arbre afin de définir le niveau d’élagage optimal permettant ensuite de simplifier l’arbre.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="12-Modeles-regression.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 fonctions liées à l&#39;argument &quot;cp=&quot; de notre modèle</span></span>
<span id="cb241-2"><a href="12-Modeles-regression.html#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="fu">printcp</span>(arbre_1)</span></code></pre></div>
<pre><code>
Classification tree:
rpart(formula = emploi ~ ., data = RP_Paris_train, method = &quot;class&quot;)

Variables actually used in tree construction:
[1] diplome proprio SEXEM   voiture

Root node error: 7405/20818 = 0.3557

n= 20818 

        CP nsplit rel error  xerror      xstd
1 0.069007      0   1.00000 1.00000 0.0093278
2 0.044294      1   0.93099 0.93099 0.0091701
3 0.029372      2   0.88670 0.88670 0.0090541
4 0.010000      4   0.82795 0.82795 0.0088815</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="12-Modeles-regression.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotcp</span>(arbre_1)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/unnamed-chunk-139-1.svg" width="672" />
Ici il faut donc indiquer la valeur 0.017 dans l’argument <code>cp=</code> pour minimiser l’erreur relative, c’est notre nouvelle règle d’arrêt. On va par conséquent reconstruire l’abre à partir de la fonction <code>prune()</code> en indiquant cette valeur optimale pour l’élaguer :</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="12-Modeles-regression.html#cb244-1" aria-hidden="true" tabindex="-1"></a>arbre_VF <span class="ot">&lt;-</span> <span class="fu">prune</span>(arbre_1, <span class="at">cp=</span><span class="fl">0.017</span>)</span>
<span id="cb244-2"><a href="12-Modeles-regression.html#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(arbre_VF)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/unnamed-chunk-140-1.svg" width="672" />
Cela ne change en réalité rien ici !</p>
<p>Pour aller plus loin, on utilise maintenant beaucoup en analyse prédictive les forêts d’arbre de décision, qui constituent comme son nom l’indique, un ensemble d’arbres de régression, ce qui permet d’avoir un taux d’erreur global moindre, car la principale critique de l’arbre de décision est son potentiel d’erreur.</p>

</div>
</div>
</div>







<script src="js/tidyverse.js"></script>
            </section>

          </div>
        </div>
      </div>
<a href="11-Clustering-application.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Camille-Sisi/github.io-Data-Mining-2023/master/12-Modeles-regression.Rmd",
"text": "Source"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
