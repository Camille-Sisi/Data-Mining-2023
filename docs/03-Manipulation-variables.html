<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 3 Manipulation des variables | DATA MINING</title>
  <meta name="description" content="Titre du cours" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 3 Manipulation des variables | DATA MINING" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Titre du cours" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 3 Manipulation des variables | DATA MINING" />
  
  <meta name="twitter:description" content="Titre du cours" />
  

<meta name="author" content="Camille Signoretto, Maîtresse de conférences en économie, Université Paris Cité" />


<meta name="date" content="2023-03-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="02-Manipulation-base.html"/>
<link rel="next" href="04-Récapitulatif.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>


<link rel="stylesheet" href="css/tidyverse.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Mining :  <em>Camille Signoretto</em></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html"><i class="fa fa-check"></i>Présentation</a>
<ul>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html#à-propos-de-ce-document"><i class="fa fa-check"></i>À propos de ce document</a></li>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html#prérequis"><i class="fa fa-check"></i>Prérequis</a></li>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html#remerciements"><i class="fa fa-check"></i>Remerciements</a></li>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html#licence"><i class="fa fa-check"></i>Licence</a></li>
</ul></li>
<li class="part"><span><b>Séance 1 : Data Wrangling</b></span></li>
<li class="chapter" data-level="1" data-path="01-Base-de-donnees.html"><a href="01-Base-de-donnees.html"><i class="fa fa-check"></i><b>1</b> Récupération de la base de données</a>
<ul>
<li class="chapter" data-level="1.1" data-path="01-Base-de-donnees.html"><a href="01-Base-de-donnees.html#les-données-du-recensement-de-la-population-rp"><i class="fa fa-check"></i><b>1.1</b> Les données du Recensement de la Population (RP)</a></li>
<li class="chapter" data-level="1.2" data-path="01-Base-de-donnees.html"><a href="01-Base-de-donnees.html#quelles-informations-intéressantes-dans-cette-base"><i class="fa fa-check"></i><b>1.2</b> Quelles informations intéressantes dans cette base ?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="02-Manipulation-base.html"><a href="02-Manipulation-base.html"><i class="fa fa-check"></i><b>2</b> Manipulation de la base</a>
<ul>
<li class="chapter" data-level="2.1" data-path="02-Manipulation-base.html"><a href="02-Manipulation-base.html#format-des-données---wide-ou-long"><i class="fa fa-check"></i><b>2.1</b> Format des données - WIDE ou LONG</a></li>
<li class="chapter" data-level="2.2" data-path="02-Manipulation-base.html"><a href="02-Manipulation-base.html#sélectionner-un-champ-réduit-de-la-base-séparer-les-données"><i class="fa fa-check"></i><b>2.2</b> Sélectionner un champ réduit de la base, séparer les données</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html"><i class="fa fa-check"></i><b>3</b> Manipulation des variables</a>
<ul>
<li class="chapter" data-level="3.1" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#manipulation-des-variables-qualitatives"><i class="fa fa-check"></i><b>3.1</b> Manipulation des variables qualitatives</a></li>
<li class="chapter" data-level="3.2" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#manipulation-des-variables-quantitatives"><i class="fa fa-check"></i><b>3.2</b> Manipulation des variables quantitatives</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#détecter-et-visualiser-les-valeurs-manquantes"><i class="fa fa-check"></i><b>3.2.1</b> Détecter et “visualiser” les valeurs manquantes</a></li>
<li class="chapter" data-level="3.2.2" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#gérer-les-valeurs-manquantes"><i class="fa fa-check"></i><b>3.2.2</b> Gérer les valeurs manquantes</a></li>
<li class="chapter" data-level="3.2.3" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#détecter-et-visualiser-les-valeurs-aberrantes"><i class="fa fa-check"></i><b>3.2.3</b> Détecter et “visualiser” les valeurs aberrantes</a></li>
<li class="chapter" data-level="3.2.4" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#découper-en-classes-une-variable-quantitative"><i class="fa fa-check"></i><b>3.2.4</b> Découper en classes une variable quantitative</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="04-Récapitulatif.html"><a href="04-Récapitulatif.html"><i class="fa fa-check"></i><b>4</b> Récapitulatig séance 1 - Data Wrangling</a>
<ul>
<li class="chapter" data-level="4.1" data-path="04-Récapitulatif.html"><a href="04-Récapitulatif.html#ce-quon-a-appris"><i class="fa fa-check"></i><b>4.1</b> Ce qu’on a appris</a></li>
<li class="chapter" data-level="4.2" data-path="04-Récapitulatif.html"><a href="04-Récapitulatif.html#enregistrement-des-tables"><i class="fa fa-check"></i><b>4.2</b> Enregistrement des tables</a></li>
</ul></li>
<li class="part"><span><b>Séance 2 : Data Mining - Analyse descriptive</b></span></li>
<li class="chapter" data-level="5" data-path="05-Questions-fouille-donnees.html"><a href="05-Questions-fouille-donnees.html"><i class="fa fa-check"></i><b>5</b> Quelles questions intéressantes pour une “fouille de données” sur cette base ?</a>
<ul>
<li class="chapter" data-level="5.1" data-path="05-Questions-fouille-donnees.html"><a href="05-Questions-fouille-donnees.html#caractéristiques-des-logements-de-la-commune-de-paris"><i class="fa fa-check"></i><b>5.1</b> Caractéristiques des logements de la commune de Paris</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DATA MINING</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="c03-Manipulation-variables" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Section 3</span> Manipulation des variables<a href="03-Manipulation-variables.html#c03-Manipulation-variables" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div align="justify">
<p>Dans la manipulation des variables, l’une des premières choses à réaliser est de les définir dans le bon format, variables quantitatives/continues ou variables qualitatives/catégorielles.</p>
<p>On l’a vu dans la section précédente, certaines variables sont encore codées comme des nombres entiers (“integer”) alors que sont des variables catégorielles. On va donc corriger cela.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="03-Manipulation-variables.html#cb15-1" aria-hidden="true" tabindex="-1"></a>RP <span class="ot">&lt;-</span> RP <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">COMMUNE=</span><span class="fu">as.factor</span>(COMMUNE),</span>
<span id="cb15-2"><a href="03-Manipulation-variables.html#cb15-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">AEMM=</span><span class="fu">as.factor</span>(AEMM),</span>
<span id="cb15-3"><a href="03-Manipulation-variables.html#cb15-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">AEMMR=</span><span class="fu">as.factor</span>(AEMMR),</span>
<span id="cb15-4"><a href="03-Manipulation-variables.html#cb15-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ANEMR=</span><span class="fu">as.factor</span>(ANEMR),</span>
<span id="cb15-5"><a href="03-Manipulation-variables.html#cb15-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">CATL=</span><span class="fu">as.factor</span>(CATL),</span>
<span id="cb15-6"><a href="03-Manipulation-variables.html#cb15-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">REGION=</span><span class="fu">as.factor</span>(REGION),</span>
<span id="cb15-7"><a href="03-Manipulation-variables.html#cb15-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">STOCD=</span><span class="fu">as.factor</span>(STOCD),</span>
<span id="cb15-8"><a href="03-Manipulation-variables.html#cb15-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">TYPL=</span><span class="fu">as.factor</span>(TYPL))</span></code></pre></div>
<p>On peut ainsi vérifier que ces variables sont bien des variables facteurs en regardant combien de modalités elles ont et quelles sont-elles. Par exemple, pour deux de nos variables ci-dessous :</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="03-Manipulation-variables.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nlevels</span>(RP<span class="sc">$</span>REGION)</span></code></pre></div>
<pre><code>[1] 1</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="03-Manipulation-variables.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(RP<span class="sc">$</span>REGION)</span></code></pre></div>
<pre><code>[1] &quot;11&quot;</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="03-Manipulation-variables.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nlevels</span>(RP<span class="sc">$</span>TYPL)</span></code></pre></div>
<pre><code>[1] 6</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="03-Manipulation-variables.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(RP<span class="sc">$</span>TYPL)</span></code></pre></div>
<pre><code>[1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; &quot;6&quot;</code></pre>
<p>Si on n’avait pas mis l’option transformant les variables caractères en variables facteurs lors du chargement des données, on pourrait le faire maintenant en utilisant la fonction <code>mutate_if</code> ou la combinaison de <code>mutate</code> et <code>across(where())</code> comme ceci <code>RP %&gt;% mutate_if(is.character, as.factor)</code> ou <code>RP %&gt;% mutate(across(where(is.character), as.factor))</code>.</p>
<p>On peut enfin vérifier quelles sont les variables numériques qui restent, en les sélectionnant avec <code>select(where())</code> ou <code>select_if()</code> :</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="03-Manipulation-variables.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RP %&gt;% select_if(is.numeric) %&gt;% head() %&gt;% gt()</span></span>
<span id="cb24-2"><a href="03-Manipulation-variables.html#cb24-2" aria-hidden="true" tabindex="-1"></a>RP <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code></pre></div>
<div id="iuuvwqqdlv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#iuuvwqqdlv .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#iuuvwqqdlv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iuuvwqqdlv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#iuuvwqqdlv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#iuuvwqqdlv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#iuuvwqqdlv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iuuvwqqdlv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iuuvwqqdlv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#iuuvwqqdlv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#iuuvwqqdlv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#iuuvwqqdlv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#iuuvwqqdlv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#iuuvwqqdlv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#iuuvwqqdlv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#iuuvwqqdlv .gt_from_md > :first-child {
  margin-top: 0;
}

#iuuvwqqdlv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#iuuvwqqdlv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#iuuvwqqdlv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#iuuvwqqdlv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#iuuvwqqdlv .gt_row_group_first td {
  border-top-width: 2px;
}

#iuuvwqqdlv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iuuvwqqdlv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#iuuvwqqdlv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#iuuvwqqdlv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iuuvwqqdlv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iuuvwqqdlv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#iuuvwqqdlv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#iuuvwqqdlv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iuuvwqqdlv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iuuvwqqdlv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iuuvwqqdlv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iuuvwqqdlv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iuuvwqqdlv .gt_left {
  text-align: left;
}

#iuuvwqqdlv .gt_center {
  text-align: center;
}

#iuuvwqqdlv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#iuuvwqqdlv .gt_font_normal {
  font-weight: normal;
}

#iuuvwqqdlv .gt_font_bold {
  font-weight: bold;
}

#iuuvwqqdlv .gt_font_italic {
  font-style: italic;
}

#iuuvwqqdlv .gt_super {
  font-size: 65%;
}

#iuuvwqqdlv .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#iuuvwqqdlv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#iuuvwqqdlv .gt_indent_1 {
  text-indent: 5px;
}

#iuuvwqqdlv .gt_indent_2 {
  text-indent: 10px;
}

#iuuvwqqdlv .gt_indent_3 {
  text-indent: 15px;
}

#iuuvwqqdlv .gt_indent_4 {
  text-indent: 20px;
}

#iuuvwqqdlv .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="ANEM">ANEM</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="IPONDL">IPONDL</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="ANEM" class="gt_row gt_right">10</td>
<td headers="IPONDL" class="gt_row gt_right">2.7933037</td></tr>
    <tr><td headers="ANEM" class="gt_row gt_right">1</td>
<td headers="IPONDL" class="gt_row gt_right">1.2335216</td></tr>
    <tr><td headers="ANEM" class="gt_row gt_right">999</td>
<td headers="IPONDL" class="gt_row gt_right">1.2335042</td></tr>
    <tr><td headers="ANEM" class="gt_row gt_right">0</td>
<td headers="IPONDL" class="gt_row gt_right">1.2335216</td></tr>
    <tr><td headers="ANEM" class="gt_row gt_right">1</td>
<td headers="IPONDL" class="gt_row gt_right">1.2335216</td></tr>
    <tr><td headers="ANEM" class="gt_row gt_right">3</td>
<td headers="IPONDL" class="gt_row gt_right">0.8138559</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Plus généralement, il est souvent d’usage d’utiliser la fonction <code>summary()</code> pour donner une idée sur l’ensemble des variables, soit de la distribution pour les variables quantitatives, soit de la répartition des différentes modalités pour les variables qualitatives ; la fonction permet également de nous donner l’information sur l’existence et le nombre de valeurs manquantes pour chaque variable.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="03-Manipulation-variables.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(RP)</span></code></pre></div>
<pre><code>    COMMUNE             ARM                 IRIS              ACHL       
 75056  : 555467   ZZZZZ  :2295363   ZZZZZZZZZ: 581311   B12    :818140  
 92012  :  26820   75115  :  60460   913770114:   3552   B11    :649489  
 93048  :  20906   75118  :  49438   920120303:   3464   C100   :365485  
 92026  :  19890   75120  :  42859   771830102:   2806   A11    :334104  
 93066  :  19773   75113  :  42469   930700109:   2790   A12    :272452  
 95018  :  18179   75117  :  42407   770580104:   2761   C115   : 52035  
 (Other):2189795   (Other): 317834   (Other)  :2254146   (Other):359125  
      AEMM             AEMMR            AGEMEN8            ANEM      
 0      : 305073   9      :1853886   40     :769947   Min.   :  0.0  
 2015   : 206636   0      : 305073   25     :668407   1st Qu.:  3.0  
 2016   : 188969   8      : 297912   55     :438609   Median : 10.0  
 2017   : 159198   7      : 196169   65     :375519   Mean   :118.9  
 2014   : 155990   6      : 132864   YY     :305073   3rd Qu.: 28.0  
 2013   : 124943   5      :  42981   80     :175740   Max.   :999.0  
 (Other):1710021   (Other):  21945   (Other):117535                  
     ANEMR        ASCEN       BAIN        BATI        CATIRIS     CATL       
 1      :588102   1: 937624   Z:2850830   Z:2850830   A:  30035   1:2545757  
 3      :519405   2:1608133                           D:   5918   2:  37266  
 2      :459050   Y: 305073                           H:2233566   3:  80286  
 0      :331413                                       Z: 581311   4: 187521  
 99     :305073                                                              
 4      :277251                                                              
 (Other):370536                                                              
 CHAU        CHFL       CHOS        CLIM        CMBL        CUIS       
 Z:2850830   1:966755   Z:2850830   Z:2850830   1: 379332   Z:2850830  
             2:817764                           2:1028138              
             3:688397                           3: 150297              
             4: 72841                           4: 860916              
             Y:305073                           5:  18780              
                                                6: 108294              
                                                Y: 305073              
 DEROU           DIPLM        EAU         EGOUL       ELEC       
 Z:2850830   18     :473997   Z:2850830   Z:2850830   Z:2850830  
             13     :452331                                      
             17     :307120                                      
             YY     :305073                                      
             16     :286439                                      
             14     :261403                                      
             (Other):764467                                      
     EMPLM         GARL        HLML           ILETUDM             ILTM       
 16     :1327619   1:1506531   1: 537003   Z      :2421856   Z      :863675  
 ZZ     : 863675   2:1039226   2:2008754   Y      : 305073   3      :725591  
 YY     : 305073   Y: 305073   Y: 305073   1      :  56301   2      :474425  
 21     : 117569                           3      :  42715   1      :454269  
 15     : 105008                           2      :  16778   Y      :305073  
 22     :  82872                           4      :   7948   4      : 24030  
 (Other):  49014                           (Other):    159   (Other):  3767  
 IMMIM       INAIM          INEEM             INP11M            INP15M       
 1: 577892   1:479110   0      :2148455   0      :1958176   0      :1829727  
 2:1967865   2:676390   Y      : 305073   Y      : 305073   1      : 327706  
 Y: 305073   3:652878   1      : 298391   1      : 304764   Y      : 305073  
             4: 59905   2      :  85141   2      : 210685   2      : 268584  
             5:  1536   3      :  12186   3      :  58780   3      :  91461  
             6:675938   4      :   1364   4      :  11010   4      :  21893  
             Y:305073   (Other):    220   (Other):   2342   (Other):   6386  
     INP17M            INP19M            INP24M            INP3M        
 0      :1766013   2      :1183058   0      :1486207   0      :2275034  
 1      : 341311   1      :1066824   1      : 478506   Y      : 305073  
 Y      : 305073   Y      : 305073   2      : 380933   1      : 226415  
 2      : 295837   3      : 203339   Y      : 305073   2      :  42123  
 3      : 106336   4      :  66880   3      : 143992   3      :   2088  
 4      :  27314   5      :  13938   4      :  40074   4      :     79  
 (Other):   8946   (Other):  11718   (Other):  16045   (Other):     18  
     INP60M            INP65M            INP5M             INP75M       
 0      :1715731   0      :1917057   0      :2181169   0      :2247449  
 1      : 529250   1      : 424697   Y      : 305073   Y      : 305073  
 Y      : 305073   Y      : 305073   1      : 261137   1      : 231763  
 2      : 297942   2      : 202800   2      :  92643   2      :  66397  
 3      :   2606   3      :   1114   3      :  10034   3      :    126  
 4      :    208   4      :     78   4      :    714   4      :     18  
 (Other):     20   (Other):     11   (Other):     60   (Other):      4  
     INPAM            INPER            INPER1            INPER2       
 1      :933808   1      :930543   1      :1286415   1      :1401005  
 2      :824575   2      :712282   0      : 609245   2      : 467215  
 0      :648315   3      :370524   2      : 442121   0      : 464663  
 Y      :305073   4      :334420   Y      : 305073   Y      : 305073  
 3      :107490   Y      :305073   3      : 162673   3      : 165457  
 4      : 26667   5      :136363   4      :  36238   4      :  37596  
 (Other):  4902   (Other): 61625   (Other):   9065   (Other):   9821  
     INPOM            INPSM             IPONDL            IRANM        
 1      :961312   0      :1646565   Min.   :  0.000   1      :2259196  
 0      :779020   1      : 451745   1st Qu.:  1.004   Y      : 305073  
 2      :711470   Y      : 305073   Median :  1.183   2      :  88870  
 Y      :305073   2      : 301109   Mean   :  2.068   3      :  74285  
 3      : 76984   3      : 108144   3rd Qu.:  3.106   4      :  69015  
 4      : 14898   4      :  28347   Max.   :506.470   5      :  36523  
 (Other):  2073   (Other):   9847                     (Other):  17868  
 METRODOM         NBPI        RECHM       REGION       SANI        SANIDOM     
 M:2850830   03     :600847   0: 538158   11:2850830   0:  17456   ZZ:2850830  
             04     :519672   1:  95994                1: 111392               
             02     :473779   2:  89148                2:2416909               
             05     :343159   9: 140375                Y: 305073               
             01     :311807   Y: 305073                                        
             YY     :305073   Z:1682082                                        
             (Other):296493                                                    
 SEXEM       STAT_CONJM  STOCD             SURF        TACTM        TPM        
 1:1429233   1:1028273   0 : 305073   4      :571276   11:1682082   1:1487709  
 2:1116524   2: 114351   10:1263064   3      :509245   12: 183924   2: 194373  
 Y: 305073   3: 274279   21: 545666   5      :424140   21: 554149   Y: 305073  
             4: 186866   22: 515399   Y      :305073   22:  49403   Z: 863675  
             5: 251538   23: 152208   7      :285136   24:  18617              
             6: 690450   30:  69420   1      :267500   25:  57582              
             Y: 305073                (Other):488460   YY: 305073              
     TRANSM           TRIRIS        TYPC        TYPL        VOIT       
 Z      :863675   ZZZZZZ : 951742   1: 633682   1: 915178   0: 780747  
 5      :773301   931411 :   5167   2: 318107   2:1867706   1:1117288  
 6      :664544   920841 :   4799   3:1555868   3:  37919   2: 540114  
 Y      :305073   910351 :   4770   4:  35025   4:  13999   3: 107608  
 2      :106503   920331 :   4197   5:   3075   5:   6442   X: 305073  
 1      : 53186   931071 :   4099   Y: 305073   6:   9586              
 (Other): 84548   (Other):1876056                                      
 WC         
 Z:2850830  
            
            
            
            
            
            </code></pre>
<p>Mais attention, le problème ici est que cela nous donne des fréquences non pondérées pour l’ensemble de nos variables qualitatives, donc qui n’ont finalement pas grand sens. De plus, pour la seule variable numérique (hors pondération), ‘ANEM’, on voit que la moyenne est de 118,9 ans, ce qui signifierait qu’en moyenne l’ancienneté d’emménagement dans le logement en région Île-de-France est de 119 ans environ, hmhm !! On va voir que cela s’explique vraimsemblablement par des valeurs manquantes codées en “999”.</p>
<div id="manipulation-des-variables-qualitatives" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Manipulation des variables qualitatives<a href="03-Manipulation-variables.html#manipulation-des-variables-qualitatives" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>On peut d’abord travailler sur les variables qualitatives qui correspondent ici à l’essentiel de nos variables.</p>
<p>Comme on le sait, on peut regarder les différents niveaux pour chacune d’entre elles, avec la fonction <code>levels()</code>. Si on veut appliquer la fonction à l’ensemble de nos variables facteurs sans avoir donc à les indiquer une par une, on peut avoir recours à la fonction <code>sapply()</code> qui permet d’appliquer la fonction indiquée entre parenthèses (ici <code>levels()</code>) à tous les éléments de notre table de données.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="03-Manipulation-variables.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour info, ici cela donnerait cela : </span></span>
<span id="cb27-2"><a href="03-Manipulation-variables.html#cb27-2" aria-hidden="true" tabindex="-1"></a>RP <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.factor)) <span class="sc">%&gt;%</span> <span class="fu">sapply</span>(levels)</span>
<span id="cb27-3"><a href="03-Manipulation-variables.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># on peut même se passer de la sélection sur les variables :</span></span>
<span id="cb27-4"><a href="03-Manipulation-variables.html#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># RP %&gt;% sapply(levels)</span></span></code></pre></div>
<p>On peut ensuite vouloir retravailler les modalités de ces variables, car par exemple les modalités ne sont pas parlantes puisque nommées par des codes chiffres, ou parce que les modalités sont trop nombreuses et qu’on souhaiterait les rassembler pour une analyse ultérieure.</p>
<p>Par exemple, si l’on veut étudier la répartition des logements en Île-de-France selon leut type, on peut utiliser la variable <code>TYPL</code> :</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="03-Manipulation-variables.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(RP<span class="sc">$</span>TYPL)</span></code></pre></div>
<pre><code>[1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; &quot;6&quot;</code></pre>
<p>Mais le moins qu’on puisse dire c’est que les 6 modalités de cette variable ne sont pas parlantes, on peut donc recoder les modalités de cette variable dans une étape <em>DATA</em> préalable comme ici ; on pourra bien sûr enchaîner plus tard les lignes de codes et réaliser cette étape dans une même procédure avec le tableau ou le graphique représentant cette variable.<br />
Commençons ici par l’étape <em>DATA</em> :</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="03-Manipulation-variables.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On cherche à quoi correspondent les modalités chiffrées de cette variable</span></span>
<span id="cb30-2"><a href="03-Manipulation-variables.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dans le fichier &quot;meta&quot;</span></span>
<span id="cb30-3"><a href="03-Manipulation-variables.html#cb30-3" aria-hidden="true" tabindex="-1"></a>meta <span class="sc">%&gt;%</span> <span class="fu">filter</span>(COD_VAR<span class="sc">==</span><span class="st">&quot;TYPL&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(COD_MOD, LIB_MOD)</span></code></pre></div>
<pre><code># A tibble: 7 x 2
  COD_MOD LIB_MOD                                    
  &lt;fct&gt;   &lt;fct&gt;                                      
1 1       Maison                                     
2 2       Appartement                                
3 3       Logement-foyer                             
4 4       Chambre d&#39;hôtel                            
5 5       Habitation de fortune                      
6 6       Pièce indépendante (ayant sa propre entrée)
7 Y       Hors résidence principale                  </code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="03-Manipulation-variables.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On recode à partir de ces libellés, tout en regroupant certaines modalités</span></span>
<span id="cb32-2"><a href="03-Manipulation-variables.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># qui sont très spécifiques et nous intéressent moins :</span></span>
<span id="cb32-3"><a href="03-Manipulation-variables.html#cb32-3" aria-hidden="true" tabindex="-1"></a>RP <span class="ot">&lt;-</span> RP <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">TYPL_moda =</span><span class="fu">as.factor</span>(<span class="fu">case_when</span>(TYPL <span class="sc">==</span> <span class="st">&quot;1&quot;</span> <span class="sc">~</span> <span class="st">&quot;Maison&quot;</span>,</span>
<span id="cb32-4"><a href="03-Manipulation-variables.html#cb32-4" aria-hidden="true" tabindex="-1"></a>                                                   TYPL <span class="sc">==</span> <span class="st">&quot;2&quot;</span> <span class="sc">~</span> <span class="st">&quot;Appartement&quot;</span>,</span>
<span id="cb32-5"><a href="03-Manipulation-variables.html#cb32-5" aria-hidden="true" tabindex="-1"></a>                                                   TYPL <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;3&quot;</span>,<span class="st">&quot;4&quot;</span>,<span class="st">&quot;5&quot;</span>,<span class="st">&quot;6&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Autres&quot;</span>)))</span>
<span id="cb32-6"><a href="03-Manipulation-variables.html#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(RP<span class="sc">$</span>TYPL_moda)</span></code></pre></div>
<pre><code>[1] &quot;Appartement&quot; &quot;Autres&quot;      &quot;Maison&quot;     </code></pre>
<p>Si l’on veut changer l’ordre des modalités, qui s’afficheront comme ci-dessus dans un tableau ou un graphique, on peut utiliser la fonction <code>fct_relevel()</code> du package <strong><code>forcats</code></strong> (à installer avant puis à appeler avant de l’utiliser) :</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="03-Manipulation-variables.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.package(&quot;forcats&quot;)</span></span>
<span id="cb34-2"><a href="03-Manipulation-variables.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb34-3"><a href="03-Manipulation-variables.html#cb34-3" aria-hidden="true" tabindex="-1"></a>RP <span class="ot">&lt;-</span> RP <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">TYPL_moda =</span> <span class="fu">fct_relevel</span>(TYPL_moda, <span class="fu">c</span>(<span class="st">&quot;Maison&quot;</span>,<span class="st">&quot;Appartement&quot;</span>,<span class="st">&quot;Autres&quot;</span>)))</span>
<span id="cb34-4"><a href="03-Manipulation-variables.html#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(RP<span class="sc">$</span>TYPL_moda)</span></code></pre></div>
<pre><code>[1] &quot;Maison&quot;      &quot;Appartement&quot; &quot;Autres&quot;     </code></pre>
<p>Plus largement, pour travailler sur les variables qualitatives en particulier lorsqu’elles sont en format facteur, le package <strong><code>forcats</code></strong> est très utile. Outre une fonction de transformation d’une variable caractère en facteur (<code>as_factor()</code> proche de la version de baseR <code>as.factor()</code> utilisée juste au-dessus), elle contient plein d’autres fonctions : <code>fct_collapse()</code> utilisée à la fin de la commande précédente pour renommer ou regrouper des modalités d’une variable (au lieu de la double fonction <code>as.factor()</code> et <code>case_when()</code>) ; <code>fct_relevel()</code> utilisée également au-dessus pour trier les modalités comme on le souhaite ; <code>fct_drop()</code> pour enlever des niveaux de facteurs vides/sans effectifs ; <code>fct_explicit_na()</code> pour rendre les NA explicites en créant une modalité “(missing)” ; <code>fct_reorder()</code> et <code>fct_reorder2()</code> pour réordonner les modalités d’une variable, très utile pour les graphiques car utilisables directement dans <code>ggplot()</code> ; <code>fct_lump()</code> pour regrouper les modalités les plus communes (ou au contraire les moins communes) en lui indiquant entre parenthèses le nombre <code>n=</code> de modalités souhaitées ou la proportion minimum souhaitée <code>prop=</code>, et en sélectionnant la variable avec la fonction <code>pull()</code> avant car elle doit être en format vecteur et non data.frame ; ou encore <code>fct_recode()</code> pour changer le niveau des facteurs ; <code>fct_other()</code> ; <code>fct_infreq()</code> et <code>fct_inorder()</code> ; etc. Un bon récapitulatif de ces fonctions est présenté <a href="https://thinkr.fr/forcats-forcats-vous-avez-dit-forcats/" target="_blank">ici</a>.</p>
</div>
<div id="manipulation-des-variables-quantitatives" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Manipulation des variables quantitatives<a href="03-Manipulation-variables.html#manipulation-des-variables-quantitatives" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Comme nous l’avons vu plus haut, il n’y a que 2 variables quantitatives dans cette base et l’une est la pondération, donc on va regarder plus précisément la variable <code>ANEM</code>. Cependant, celle-ci aussi est particulière car c’est une variable numérique constituée d’entiers naturels (et non de valeurs réelles) qui vont de 0 à 120, avec une modalité “999” ; dans le dictionnaire des variables (ou le fichier des métadonnées) disponible également sur le site de l’Insee, on se rend compte que la variable a été pensée comme catégorielle avec des modalités d’abord codées comme “000”, “001”, etc. Et quand on regarde à quoi correspond la modalité “999”, on voit qu’elle permet de donner la situation d’un “logement ordinaire inoccupé”.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="03-Manipulation-variables.html#cb36-1" aria-hidden="true" tabindex="-1"></a>meta <span class="sc">%&gt;%</span> <span class="fu">filter</span>(COD_VAR<span class="sc">==</span><span class="st">&quot;ANEM&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(COD_MOD, LIB_MOD) <span class="sc">%&gt;%</span> <span class="fu">tail</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 2
  COD_MOD LIB_MOD                    
  &lt;fct&gt;   &lt;fct&gt;                      
1 115     Depuis 115 ans             
2 116     Depuis 116 ans             
3 117     Depuis 117 ans             
4 118     Depuis 118 ans             
5 120     Depuis 120 ans             
6 999     Logement ordinaire inoccupé</code></pre>
<!-- Si on calcule la moyenne sans cette modalité, on obtient alors une moyenne de 13.4860554.-->
<p>On va recoder alors cette modalité comme des valeurs manquantes : dans <code>R</code>, ces valeurs sont notées <code>NA</code>. Cela nous permettra de la traiter comme une variable continue sur laquelle on pourra réaliser des statistiques sur sa distribution. Pour cela, dans une fonction <code>mutate()</code> combinée avec la fonction <code>across()</code> permettant de spécifier la variable sur laquelle on veut appliquer la transformation, on peut utiliser la fonction <code>na_if</code> qui permet de convertir des valeurs en <code>NA</code>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="03-Manipulation-variables.html#cb38-1" aria-hidden="true" tabindex="-1"></a>RP <span class="ot">&lt;-</span> RP <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(ANEM, <span class="sc">~</span> <span class="fu">na_if</span>(ANEM, <span class="dv">999</span>)))</span></code></pre></div>
<p>On peut alors regarder rapidement la distribution de cette variable.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="03-Manipulation-variables.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(RP<span class="sc">$</span>ANEM)</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
   0.00    3.00    8.00   13.49   20.00  117.00  305073 </code></pre>
<p>Si ce n’est pas la variable continue idéale (car encore une fois elle n’est pas à valeurs réelles), on va la prendre comme exemple ici pour étudier les différentes procédures que l’on peut réaliser dans une étape “Data wrangling” sur de telles variables.</p>
<div id="détecter-et-visualiser-les-valeurs-manquantes" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Détecter et “visualiser” les valeurs manquantes<a href="03-Manipulation-variables.html#détecter-et-visualiser-les-valeurs-manquantes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Même si l’information est donnée par la fonction <code>summary()</code> (mais qui nous donne d’autres informations), on peut également compter le nombre de valeurs manquantes <code>NA</code> pour chacune des variables avec la fonction <code>colSums()</code>, pour les avoir en proportion du nombre total d’observations (lignes), on peut utiliser la fonction <code>colMeans()</code> ; sinon ; on peut utiliser la fonction <code>summarise</code> combinée avec <code>across(where()), )</code> :</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="03-Manipulation-variables.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(RP))</span></code></pre></div>
<pre><code>   COMMUNE        ARM       IRIS       ACHL       AEMM      AEMMR    AGEMEN8 
         0          0          0          0          0          0          0 
      ANEM      ANEMR      ASCEN       BAIN       BATI    CATIRIS       CATL 
    305073          0          0          0          0          0          0 
      CHAU       CHFL       CHOS       CLIM       CMBL       CUIS      DEROU 
         0          0          0          0          0          0          0 
     DIPLM        EAU      EGOUL       ELEC      EMPLM       GARL       HLML 
         0          0          0          0          0          0          0 
   ILETUDM       ILTM      IMMIM      INAIM      INEEM     INP11M     INP15M 
         0          0          0          0          0          0          0 
    INP17M     INP19M     INP24M      INP3M     INP60M     INP65M      INP5M 
         0          0          0          0          0          0          0 
    INP75M      INPAM      INPER     INPER1     INPER2      INPOM      INPSM 
         0          0          0          0          0          0          0 
    IPONDL      IRANM   METRODOM       NBPI      RECHM     REGION       SANI 
         0          0          0          0          0          0          0 
   SANIDOM      SEXEM STAT_CONJM      STOCD       SURF      TACTM        TPM 
         0          0          0          0          0          0          0 
    TRANSM     TRIRIS       TYPC       TYPL       VOIT         WC  TYPL_moda 
         0          0          0          0          0          0          0 </code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="03-Manipulation-variables.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour les avoir en proportion par rapport au nombre total d&#39;observations</span></span>
<span id="cb43-2"><a href="03-Manipulation-variables.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># et arrondies à 2 chiffres après la virgule :</span></span>
<span id="cb43-3"><a href="03-Manipulation-variables.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">colMeans</span>(<span class="fu">is.na</span>(RP)<span class="sc">*</span><span class="dv">100</span>), <span class="dv">2</span>)</span></code></pre></div>
<pre><code>   COMMUNE        ARM       IRIS       ACHL       AEMM      AEMMR    AGEMEN8 
       0.0        0.0        0.0        0.0        0.0        0.0        0.0 
      ANEM      ANEMR      ASCEN       BAIN       BATI    CATIRIS       CATL 
      10.7        0.0        0.0        0.0        0.0        0.0        0.0 
      CHAU       CHFL       CHOS       CLIM       CMBL       CUIS      DEROU 
       0.0        0.0        0.0        0.0        0.0        0.0        0.0 
     DIPLM        EAU      EGOUL       ELEC      EMPLM       GARL       HLML 
       0.0        0.0        0.0        0.0        0.0        0.0        0.0 
   ILETUDM       ILTM      IMMIM      INAIM      INEEM     INP11M     INP15M 
       0.0        0.0        0.0        0.0        0.0        0.0        0.0 
    INP17M     INP19M     INP24M      INP3M     INP60M     INP65M      INP5M 
       0.0        0.0        0.0        0.0        0.0        0.0        0.0 
    INP75M      INPAM      INPER     INPER1     INPER2      INPOM      INPSM 
       0.0        0.0        0.0        0.0        0.0        0.0        0.0 
    IPONDL      IRANM   METRODOM       NBPI      RECHM     REGION       SANI 
       0.0        0.0        0.0        0.0        0.0        0.0        0.0 
   SANIDOM      SEXEM STAT_CONJM      STOCD       SURF      TACTM        TPM 
       0.0        0.0        0.0        0.0        0.0        0.0        0.0 
    TRANSM     TRIRIS       TYPC       TYPL       VOIT         WC  TYPL_moda 
       0.0        0.0        0.0        0.0        0.0        0.0        0.0 </code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="03-Manipulation-variables.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ou en langage tidyverse sur les seules variables numériques :</span></span>
<span id="cb45-2"><a href="03-Manipulation-variables.html#cb45-2" aria-hidden="true" tabindex="-1"></a>RP <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(.))))</span></code></pre></div>
<pre><code># A tibble: 1 x 2
    ANEM IPONDL
   &lt;int&gt;  &lt;int&gt;
1 305073      0</code></pre>
<p>Si votre base de données contient plusieurs variables avec un certain nombre de valeurs manquantes, il peut être intéressant d’en faire une analyse plus poussée. Différents packages existent pour détecter et visualiser les données manquantes. L’un d’entre eux est le package <strong><code>naniar</code></strong> : quelques fonctions permettent d’abord de décrire la base selon ses valeurs manquantes.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="03-Manipulation-variables.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb47-2"><a href="03-Manipulation-variables.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Ci-dessous : nombre de cellules du tableau ou de n_ij d&#39;une matrice </span></span>
<span id="cb47-3"><a href="03-Manipulation-variables.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># qui correspondent à des valeurs manquantes :</span></span>
<span id="cb47-4"><a href="03-Manipulation-variables.html#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">n_miss</span>(RP) </span></code></pre></div>
<pre><code>[1] 305073</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="03-Manipulation-variables.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour les avoir en proportion du nombre total de cellules du tableau</span></span>
<span id="cb49-2"><a href="03-Manipulation-variables.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># et non des seules lignes comme précédemment, </span></span>
<span id="cb49-3"><a href="03-Manipulation-variables.html#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># le résultat est déjà en pourcentage, sinon utiliser `prop_miss(RP)`)</span></span>
<span id="cb49-4"><a href="03-Manipulation-variables.html#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pct_miss</span>(RP) </span></code></pre></div>
<pre><code>[1] 0.1528743</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="03-Manipulation-variables.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ci-dessous : nombre de cellules du tableau ou de n_ij d&#39;une matrice </span></span>
<span id="cb51-2"><a href="03-Manipulation-variables.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># qui correspondent à des valeurs renseignées :</span></span>
<span id="cb51-3"><a href="03-Manipulation-variables.html#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">n_complete</span>(RP) </span></code></pre></div>
<pre><code>[1] 199253027</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="03-Manipulation-variables.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#en proportion</span></span>
<span id="cb53-2"><a href="03-Manipulation-variables.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pct_complete</span>(RP) </span></code></pre></div>
<pre><code>[1] 99.84713</code></pre>
<p>On peut ensuite visualiser le nombre de valeurs manquantes par variable, avec la fonction <code>gg_miss_var()</code> du même package.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="03-Manipulation-variables.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1er type de visualisation des valeurs manquantes</span></span>
<span id="cb55-2"><a href="03-Manipulation-variables.html#cb55-2" aria-hidden="true" tabindex="-1"></a>RP <span class="sc">%&gt;%</span>  <span class="fu">gg_miss_var</span>()</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/unnamed-chunk-32-1.svg" width="672" /></p>
<p>On peut également demander dans <code>gg_miss_var()</code> à ce que les valeurs soient en pourcentage, avec l’argument <code>show_pct=TRUE</code>.</p>
<p>On peut aussi réaliser des graphiques montrant le nombre de valeurs manquantes pour l’ensemble des variables numériques de la base, en fonction d’une autre variable de nature ‘factor’, avec l’argument <code>fct=</code> dans <code>gg_miss_fct()</code>. Cela est intéressant pour voir si certaines valeurs manquantes des variables se retrouvent davantage dans des modalités précises d’une autre variable. Par exemple, ici, selon le type de logement :</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="03-Manipulation-variables.html#cb56-1" aria-hidden="true" tabindex="-1"></a>RP <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric), TYPL_moda) <span class="sc">%&gt;%</span></span>
<span id="cb56-2"><a href="03-Manipulation-variables.html#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gg_miss_fct</span>(<span class="at">fct =</span> TYPL_moda)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/unnamed-chunk-33-1.svg" width="672" />
On voit que les valeurs manquantes sont plus nombreuses en proportion pour la modalité “5” et sont moins nombreuses dans les modalités “1” et “3” ; elles ne se distribuent ainsi pas de manière uniforme selon la variable du type de logement.</p>
<p>Plus généralement, la fonction <code>gg_miss_upset()</code> de ce même package <strong><code>naniar</code></strong> permet de visualiser des dépendances entre les valeurs manquantes des variables qui en ont, <em>ici</em>, cela ne marchera donc pas puisque nous n’avons qu’une variable avec valeurs manquantes. Voici le code néanmoins :</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="03-Manipulation-variables.html#cb57-1" aria-hidden="true" tabindex="-1"></a>RP <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> <span class="fu">gg_miss_upset</span>()</span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="03-Manipulation-variables.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VIM)</span>
<span id="cb58-2"><a href="03-Manipulation-variables.html#cb58-2" aria-hidden="true" tabindex="-1"></a>RP <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> <span class="fu">aggr</span>(<span class="at">sortVar=</span><span class="cn">TRUE</span>, <span class="at">only.miss =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Enfin, il est possible d’appliquer la fonction <code>geom_miss_point()</code> à une fonction <code>ggplot</code>, dans ce cas les valeurs manquantes de la ou des variables sont remplacées par des valeurs 10% plus basses que la valeur minimum observée des variables, et cela afin de les visualiser.</p>
<p>Il existe bien sûr bien d’autres packages, comme <strong><code>funModeling</code></strong>, <strong><code>Amelia</code></strong> et sa fonction <code>missmap()</code>, ou encore <strong><code>visdat</code></strong> et sa fonction <code>vis_miss()</code>. Enfin, d’autres packages comme <strong><code>VIM</code></strong> ou <strong><code>MICE</code></strong> permettent, non seulement de visualiser ces valeurs manquantes, mais également de leur appliquer des techniques pour les “gérer”, c’est ce que l’on va voir maintenant en résumé.</p>
</div>
<div id="gérer-les-valeurs-manquantes" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Gérer les valeurs manquantes<a href="03-Manipulation-variables.html#gérer-les-valeurs-manquantes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Il est bien de connaître le nombre et la proportion de valeurs manquantes dans nos données, comment ces dernières se répartissent entre elles, etc., mais il faut aussi comprendre quel impact elles peuvent avoir sur des analyses statistiques, de régressions ou autres algorithmes.</p>
<p>Dans une base de données tirée d’une enquête, les valeurs manquantes peuvent provenir d’une non-réponse de la part de l’enquêté (que ce soit un individu ou une entreprise), cette non-réponse pouvant être “totale” (on a aucune donnée pour cet enquêté alors qu’il fait partie de l’échantillon) ou “partielle” (on a une partie des réponses mais pas à toutes les questions et donc des variables parfois avec des valeurs manquantes) ; ou bien encore elles peuvent être dues à une mauvaise saisie de l’information par l’enquêteur. La pondération, si elle est présente dans une enquête, peut permettre de corriger cette non-réponse totale, voire partielle.</p>
<p>Les conséquences des valeurs manquantes dans une base de données dépendent de plusieurs choses : on doit d’abord se demander si l’information perdue aurait été pertinente et/ou aurait apporté un élément particulier/supplémentaire. Ensuite, la perte éventuelle d’information est-elle importante, en nombre/en proportion. Et enfin (et surtout), peut-elle créer un biais lors de l’estimation et précision du phénomène que l’on souhaite observer, décrire, analyser, etc. Selon l’importance de ces conséquences, il faut traiter ces valeurs manquantes, c’est-à-dire utiliser une procédure la plus adaptée possible selon le potentiel biais repéré.</p>
<p>Traditionnellement dans la littérature, on distingue 3 types de valeurs manquantes :</p>
<ul>
<li>valeur manquante entièrement due au hasard (‘MCAR’ pour Missing completely at random) : il n’y a pas de lien entre la valeur manquante pour une variable donnée et les autres variables, dit autrement la probabilité pour une variable qu’elle ait une valeur manquante est constante dans les données, elle ne diffère pas selon d’autres caractéristiques des individus ;</li>
<li>valeur manquante due au hasard (‘MAR’ pour Missing at random) : il y a un lien entre la valeur manquante pour une variable donnée et les valeurs observées d’autres variables, c’est-à-dire que la probabilité pour une variable qu’elle ait une valeur manquante dépend d’autres variables (de leurs valeurs observées), elle ne sera donc pas la même selon les individus, c’est ce qu’on essayait de regarder lorsqu’on a utilisé plus haut la fonction <code>gg_miss_fct(fct=)</code> ;</li>
<li>valeur ne manquant pas au hasard (‘NMAR’ pour Non missing at random) : il y a un lien entre la valeur manquante pour une variable et les valeurs manquantes/non observées d’autres variables. Ce sont celles qui risquent d’entraîner des biais importants si on ne les traite pas, c’est ce qu’on essayait de regarder plus haut également avec la fonction <code>gg_miss_upset()</code> cette fois.</li>
</ul>
<p>Comment alors les gérer ? En pratique, il est d’usage lorsque la proportion de valeurs manquantes ne dépasse pas 5% des données de ne rien faire de particulier ou simplement de les supprimer (vous pouvez pour la savoir utiliser les premières fonctions du package <strong><code>naniar</code></strong> présentées précédemment). Sinon, on essaye d’appliquer plusieurs méthodes, simples ou plus complexes.</p>
<p>Dans le cas de valeurs manquantes entièrement dues au hasard (MCAR) et/ou d’une faible proportion des valeurs manquantes dans le total de la table de données, on peut décider de supprimer toutes les lignes qui contiennent au moins une valeur manquante, afin d’avoir une table de données complètes, on peut utiliser la fonction <code>na.omit()</code> ou <code>complete.cases()</code> ; attention à ne pas remplacer votre table de données initiale en réalisant cette procédure.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="03-Manipulation-variables.html#cb59-1" aria-hidden="true" tabindex="-1"></a>RP_sansNA <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(RP)</span>
<span id="cb59-2"><a href="03-Manipulation-variables.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co"># OU : </span></span>
<span id="cb59-3"><a href="03-Manipulation-variables.html#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co"># RP_sansNA &lt;- RP[complete.cases(RP), ]</span></span>
<span id="cb59-4"><a href="03-Manipulation-variables.html#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="03-Manipulation-variables.html#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour vérification : </span></span>
<span id="cb59-6"><a href="03-Manipulation-variables.html#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(RP_sansNA))</span></code></pre></div>
<pre><code>   COMMUNE        ARM       IRIS       ACHL       AEMM      AEMMR    AGEMEN8 
         0          0          0          0          0          0          0 
      ANEM      ANEMR      ASCEN       BAIN       BATI    CATIRIS       CATL 
         0          0          0          0          0          0          0 
      CHAU       CHFL       CHOS       CLIM       CMBL       CUIS      DEROU 
         0          0          0          0          0          0          0 
     DIPLM        EAU      EGOUL       ELEC      EMPLM       GARL       HLML 
         0          0          0          0          0          0          0 
   ILETUDM       ILTM      IMMIM      INAIM      INEEM     INP11M     INP15M 
         0          0          0          0          0          0          0 
    INP17M     INP19M     INP24M      INP3M     INP60M     INP65M      INP5M 
         0          0          0          0          0          0          0 
    INP75M      INPAM      INPER     INPER1     INPER2      INPOM      INPSM 
         0          0          0          0          0          0          0 
    IPONDL      IRANM   METRODOM       NBPI      RECHM     REGION       SANI 
         0          0          0          0          0          0          0 
   SANIDOM      SEXEM STAT_CONJM      STOCD       SURF      TACTM        TPM 
         0          0          0          0          0          0          0 
    TRANSM     TRIRIS       TYPC       TYPL       VOIT         WC  TYPL_moda 
         0          0          0          0          0          0          0 </code></pre>
<p>On se retrouve alors avec une table de 2 545 757 observations (lignes), on a donc perdu 305 073 observations, soit 10.70% des observations de la table initiale, ce qui est cohérent avec ce qu’on avait retiré de notre première analyse de détection des valeurs manquantes.</p>
<p>Des techniques d’imputation simple peuvent également être utilisées. On peut par exemple remplacer les valeurs manquantes d’une variable quantitative par sa moyenne ou sa médiane, pour cela on peut utiliser la fonction <code>replace_na()</code> du package <strong><code>tidyr</code></strong>, ou <code>impute()</code> du package <strong><code>Hmisc</code></strong>, ou encore <code>na.aggregate()</code> du package <strong><code>zoo</code></strong> On donne ainsi une valeur “artificielle” pour remplacer la valeur manquante. Dans le cas de variables qualitatives, on peut, de même, imputer la modalité dominante (avec la fonction <code>mode()</code> du package <strong><code>Hmisc</code></strong> ; ou avec l’argument <code>mode=</code> du package <strong><code>zoo</code></strong>). Par exemple, voici les codes pour remplacer les valeurs manquantes de la variable ‘ANEM’ par sa moyenne (ici on ne fait pas tourner ces codes) :</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="03-Manipulation-variables.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comme les valeurs de la variable &#39;ANEM&#39; sont des entiers naturels,</span></span>
<span id="cb61-2"><a href="03-Manipulation-variables.html#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># il faut arrondir la moyenne à l&#39;unité, sinon la fonction renvoie</span></span>
<span id="cb61-3"><a href="03-Manipulation-variables.html#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># une erreur</span></span>
<span id="cb61-4"><a href="03-Manipulation-variables.html#cb61-4" aria-hidden="true" tabindex="-1"></a>RP <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ANEM_bis =</span> <span class="fu">replace_na</span>(ANEM, <span class="fu">round</span>(<span class="fu">mean</span>(ANEM, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="dv">0</span>))) <span class="sc">%&gt;%</span> <span class="fu">select</span>(ANEM, ANEM_bis)</span>
<span id="cb61-5"><a href="03-Manipulation-variables.html#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="03-Manipulation-variables.html#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb61-7"><a href="03-Manipulation-variables.html#cb61-7" aria-hidden="true" tabindex="-1"></a>RP<span class="sc">$</span>ANEM_bis <span class="ot">&lt;-</span> <span class="fu">with</span>(RP, <span class="fu">impute</span>(ANEM, mean))</span>
<span id="cb61-8"><a href="03-Manipulation-variables.html#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="03-Manipulation-variables.html#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb61-10"><a href="03-Manipulation-variables.html#cb61-10" aria-hidden="true" tabindex="-1"></a>RP<span class="sc">$</span>ANEM_bis <span class="ot">&lt;-</span> <span class="fu">na.aggregate</span>(RP<span class="sc">$</span>ANEM, <span class="at">FUN =</span> mean)</span></code></pre></div>
<p>On peut néanmoins réaliser ce type d’imputation simple de manière un petit peu plus subtile. Par exemple, si la moyenne de la variable diffère sensiblement selon une autre variable (catégorielle), dans ce cas, on va plutôt remplacer les valeurs manquantes de la variable selon la moyenne associée à chaque modalité de cette autre variable en ajoutant un <code>group_by()</code> avant la fonction <code>mutate()</code> si on utilise la fonction <code>replace_na()</code> comme dans l’exemple précédent.</p>
<p>Si on ne veut pas supprimer ces lignes d’observations et perdre ainsi d’autres informations (celles des variables pour lesquelles la valeur était renseignée pour cette même observation), on peut simplement créer une variable indicatrice de valeur manquante, remplacer les <code>NA</code> par ‘999’ comme dans notre base de données actuelle pour des variables quantitatives, ou par une modalité ‘Manquant’ ou ‘Missing’ pour des variables qualitatives.</p>
<p>Plusieurs autres méthodes existent également dans le cas de valeurs manquantes dues au hasard (MAR), en voici la liste pour information et sans prétention d’exhaustivité : - analyse pondérée pour des valeurs MAR qui consiste à calculer la probabilité qu’une observation soit complète et ensuite à affecter à chacune des observations complètes, un poids inversement proportionnel à cette probabilité ; - imputation de la dernière observation pour des données temporelles ; - imputation “hot-deck” qui consiste à remplacer la valeur manquante par une valeur observée chez un autre individu ayant les mêmes caractéristiques, ou “cold-deck” (même démarche que précédement, sauf que la valeur imputée vient d’une autre source) ; - imputation par le “plus proche voisin” en utilisant une fonction de distance basée sur plusieurs autres variables/caractéristiques de l’individu ; - imputation par un modèle de régression où l’on va remplacer la valeur manquante par une valeur prédite obtenue par régression sur données complètes de la variable comportant des valeurs manquantes.</p>
<p>Il y a aussi des techniques plus complextes d’imputation multiple qui consiste à créer plusieurs valeurs possibles pour une valeur manquante d’une variable, cela peut être adaptée là aussi lorsque les valeurs manquantes sont dues au hasard (MAR).</p>
<p>Vous trouverez de multiples ressources sur internet dans des ouvrages libres d’accès, ou vous pouvez aller voir un des chapitres de l’ouvrage principal support du cours (Husson, 2018), avec des exemples d’utilisation.</p>
</div>
<div id="détecter-et-visualiser-les-valeurs-aberrantes" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Détecter et “visualiser” les valeurs aberrantes<a href="03-Manipulation-variables.html#détecter-et-visualiser-les-valeurs-aberrantes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pour cela, on va utiliser une autre base, téléchargée sur opendatasoft à partir de la fonction créée lors de la séance 1 de M. Grasland. Cette base dont le nom est <em>“aides-entreprises-covid-19-france”</em> renseigne du nombre et du montant des aides financières accordées aux entreprises françaises durant la crise du covid_19, selon en particulier le secteur d’activité et la localisation géographique.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="03-Manipulation-variables.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rappel fonction (soit vous l&#39;avez encore dans votre environnement, soit</span></span>
<span id="cb62-2"><a href="03-Manipulation-variables.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># vous l&#39;avez sauvegardé et dans ce cas il faut l&#39;appeler, soit vous devez </span></span>
<span id="cb62-3"><a href="03-Manipulation-variables.html#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># refaire tourner les lignes de codes suivantes...)</span></span>
<span id="cb62-4"><a href="03-Manipulation-variables.html#cb62-4" aria-hidden="true" tabindex="-1"></a>get_data <span class="ot">&lt;-</span> <span class="cf">function</span>(idtab, rows, start) {</span>
<span id="cb62-5"><a href="03-Manipulation-variables.html#cb62-5" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;https://public.opendatasoft.com/api/records/1.0/search/?dataset=&quot;</span>,idtab,<span class="st">&quot;&amp;q=&amp;rows=&quot;</span>,rows,<span class="st">&quot;&amp;start=&quot;</span>,start,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb62-6"><a href="03-Manipulation-variables.html#cb62-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">GET</span>(url)</span>
<span id="cb62-7"><a href="03-Manipulation-variables.html#cb62-7" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="fu">rawToChar</span>((x<span class="sc">$</span>content)))</span>
<span id="cb62-8"><a href="03-Manipulation-variables.html#cb62-8" aria-hidden="true" tabindex="-1"></a>  don <span class="ot">&lt;-</span> y<span class="sc">$</span>records<span class="sc">$</span>fields</span>
<span id="cb62-9"><a href="03-Manipulation-variables.html#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(don)</span>
<span id="cb62-10"><a href="03-Manipulation-variables.html#cb62-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-11"><a href="03-Manipulation-variables.html#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb62-12"><a href="03-Manipulation-variables.html#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb62-13"><a href="03-Manipulation-variables.html#cb62-13" aria-hidden="true" tabindex="-1"></a>dt_aidesCovid <span class="ot">&lt;-</span> <span class="fu">get_data</span>(<span class="at">idtab =</span> <span class="st">&quot;aides-entreprises-covid-19-france&quot;</span>, </span>
<span id="cb62-14"><a href="03-Manipulation-variables.html#cb62-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">rows=</span><span class="dv">2000</span>,</span>
<span id="cb62-15"><a href="03-Manipulation-variables.html#cb62-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">start=</span><span class="dv">0</span>)</span>
<span id="cb62-16"><a href="03-Manipulation-variables.html#cb62-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-17"><a href="03-Manipulation-variables.html#cb62-17" aria-hidden="true" tabindex="-1"></a>dt_aidesCovid <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>Rows: 1,680
Columns: 13
$ reg_code                &lt;int&gt; 84, 84, 84, 84, 84, 27, 27, 27, 27, 24, 24, 24~
$ geo_point_2d            &lt;list&gt; &lt;46.09983, 5.34885&gt;, &lt;45.728000, 4.164813&gt;, &lt;~
$ naf_section_name        &lt;chr&gt; &quot;Commerce&quot;, &quot;Industrie manufacturière&quot;, &quot;Const~
$ nombre_entreprises      &lt;int&gt; 2602, 1042, 3034, 6577, 3021, 61, 268, 45, 233~
$ plan                    &lt;chr&gt; &quot;Fonds de solidarité&quot;, &quot;Fonds de solidarité&quot;, ~
$ financial_support_count &lt;int&gt; 10424, 3820, 8936, 19967, 28020, 366, 2212, 19~
$ reg_name                &lt;chr&gt; &quot;Auvergne-Rhône-Alpes&quot;, &quot;Auvergne-Rhône-Alpes&quot;~
$ naf_section_code        &lt;chr&gt; &quot;G&quot;, &quot;C&quot;, &quot;F&quot;, &quot;F&quot;, &quot;I&quot;, &quot;J&quot;, &quot;R&quot;, &quot;K&quot;, &quot;L&quot;, &quot;~
$ total_meuros            &lt;dbl&gt; 31.889084, 9.551646, 13.922570, 33.039981, 247~
$ dep_name                &lt;chr&gt; &quot;Ain&quot;, &quot;Loire&quot;, &quot;Loire&quot;, &quot;Rhône&quot;, &quot;Savoie&quot;, &quot;N~
$ iso3_code               &lt;chr&gt; &quot;FXX&quot;, &quot;FXX&quot;, &quot;FXX&quot;, &quot;FXX&quot;, &quot;FXX&quot;, &quot;FXX&quot;, &quot;FXX~
$ dep_code                &lt;chr&gt; &quot;01&quot;, &quot;42&quot;, &quot;42&quot;, &quot;69&quot;, &quot;73&quot;, &quot;58&quot;, &quot;58&quot;, &quot;89&quot;~
$ total                   &lt;dbl&gt; 31889084, 9551646, 13922570, 33039981, 2478684~</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="03-Manipulation-variables.html#cb64-1" aria-hidden="true" tabindex="-1"></a>dt_aidesCovid <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code></pre></div>
<div id="iwqijrjvro" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#iwqijrjvro .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#iwqijrjvro .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iwqijrjvro .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#iwqijrjvro .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#iwqijrjvro .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#iwqijrjvro .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iwqijrjvro .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iwqijrjvro .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#iwqijrjvro .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#iwqijrjvro .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#iwqijrjvro .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#iwqijrjvro .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#iwqijrjvro .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#iwqijrjvro .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#iwqijrjvro .gt_from_md > :first-child {
  margin-top: 0;
}

#iwqijrjvro .gt_from_md > :last-child {
  margin-bottom: 0;
}

#iwqijrjvro .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#iwqijrjvro .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#iwqijrjvro .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#iwqijrjvro .gt_row_group_first td {
  border-top-width: 2px;
}

#iwqijrjvro .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iwqijrjvro .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#iwqijrjvro .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#iwqijrjvro .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iwqijrjvro .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iwqijrjvro .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#iwqijrjvro .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#iwqijrjvro .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iwqijrjvro .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iwqijrjvro .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iwqijrjvro .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iwqijrjvro .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iwqijrjvro .gt_left {
  text-align: left;
}

#iwqijrjvro .gt_center {
  text-align: center;
}

#iwqijrjvro .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#iwqijrjvro .gt_font_normal {
  font-weight: normal;
}

#iwqijrjvro .gt_font_bold {
  font-weight: bold;
}

#iwqijrjvro .gt_font_italic {
  font-style: italic;
}

#iwqijrjvro .gt_super {
  font-size: 65%;
}

#iwqijrjvro .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#iwqijrjvro .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#iwqijrjvro .gt_indent_1 {
  text-indent: 5px;
}

#iwqijrjvro .gt_indent_2 {
  text-indent: 10px;
}

#iwqijrjvro .gt_indent_3 {
  text-indent: 15px;
}

#iwqijrjvro .gt_indent_4 {
  text-indent: 20px;
}

#iwqijrjvro .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="reg_code">reg_code</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="geo_point_2d">geo_point_2d</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="naf_section_name">naf_section_name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="nombre_entreprises">nombre_entreprises</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="plan">plan</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="financial_support_count">financial_support_count</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="reg_name">reg_name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="naf_section_code">naf_section_code</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="total_meuros">total_meuros</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="dep_name">dep_name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="iso3_code">iso3_code</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="dep_code">dep_code</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="total">total</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="reg_code" class="gt_row gt_right">84</td>
<td headers="geo_point_2d" class="gt_row gt_center">46.09983, 5.34885</td>
<td headers="naf_section_name" class="gt_row gt_left">Commerce</td>
<td headers="nombre_entreprises" class="gt_row gt_right">2602</td>
<td headers="plan" class="gt_row gt_left">Fonds de solidarité</td>
<td headers="financial_support_count" class="gt_row gt_right">10424</td>
<td headers="reg_name" class="gt_row gt_left">Auvergne-Rhône-Alpes</td>
<td headers="naf_section_code" class="gt_row gt_left">G</td>
<td headers="total_meuros" class="gt_row gt_right">31.889084</td>
<td headers="dep_name" class="gt_row gt_left">Ain</td>
<td headers="iso3_code" class="gt_row gt_left">FXX</td>
<td headers="dep_code" class="gt_row gt_right">01</td>
<td headers="total" class="gt_row gt_right">31889084</td></tr>
    <tr><td headers="reg_code" class="gt_row gt_right">84</td>
<td headers="geo_point_2d" class="gt_row gt_center">45.728000, 4.164813</td>
<td headers="naf_section_name" class="gt_row gt_left">Industrie manufacturière</td>
<td headers="nombre_entreprises" class="gt_row gt_right">1042</td>
<td headers="plan" class="gt_row gt_left">Fonds de solidarité</td>
<td headers="financial_support_count" class="gt_row gt_right">3820</td>
<td headers="reg_name" class="gt_row gt_left">Auvergne-Rhône-Alpes</td>
<td headers="naf_section_code" class="gt_row gt_left">C</td>
<td headers="total_meuros" class="gt_row gt_right">9.551646</td>
<td headers="dep_name" class="gt_row gt_left">Loire</td>
<td headers="iso3_code" class="gt_row gt_left">FXX</td>
<td headers="dep_code" class="gt_row gt_right">42</td>
<td headers="total" class="gt_row gt_right">9551646</td></tr>
    <tr><td headers="reg_code" class="gt_row gt_right">84</td>
<td headers="geo_point_2d" class="gt_row gt_center">45.728000, 4.164813</td>
<td headers="naf_section_name" class="gt_row gt_left">Construction</td>
<td headers="nombre_entreprises" class="gt_row gt_right">3034</td>
<td headers="plan" class="gt_row gt_left">Fonds de solidarité</td>
<td headers="financial_support_count" class="gt_row gt_right">8936</td>
<td headers="reg_name" class="gt_row gt_left">Auvergne-Rhône-Alpes</td>
<td headers="naf_section_code" class="gt_row gt_left">F</td>
<td headers="total_meuros" class="gt_row gt_right">13.922570</td>
<td headers="dep_name" class="gt_row gt_left">Loire</td>
<td headers="iso3_code" class="gt_row gt_left">FXX</td>
<td headers="dep_code" class="gt_row gt_right">42</td>
<td headers="total" class="gt_row gt_right">13922570</td></tr>
    <tr><td headers="reg_code" class="gt_row gt_right">84</td>
<td headers="geo_point_2d" class="gt_row gt_center">45.871312, 4.640724</td>
<td headers="naf_section_name" class="gt_row gt_left">Construction</td>
<td headers="nombre_entreprises" class="gt_row gt_right">6577</td>
<td headers="plan" class="gt_row gt_left">Fonds de solidarité</td>
<td headers="financial_support_count" class="gt_row gt_right">19967</td>
<td headers="reg_name" class="gt_row gt_left">Auvergne-Rhône-Alpes</td>
<td headers="naf_section_code" class="gt_row gt_left">F</td>
<td headers="total_meuros" class="gt_row gt_right">33.039981</td>
<td headers="dep_name" class="gt_row gt_left">Rhône</td>
<td headers="iso3_code" class="gt_row gt_left">FXX</td>
<td headers="dep_code" class="gt_row gt_right">69</td>
<td headers="total" class="gt_row gt_right">33039981</td></tr>
    <tr><td headers="reg_code" class="gt_row gt_right">84</td>
<td headers="geo_point_2d" class="gt_row gt_center">45.477437, 6.442872</td>
<td headers="naf_section_name" class="gt_row gt_left">Hébergement et restauration</td>
<td headers="nombre_entreprises" class="gt_row gt_right">3021</td>
<td headers="plan" class="gt_row gt_left">Fonds de solidarité</td>
<td headers="financial_support_count" class="gt_row gt_right">28020</td>
<td headers="reg_name" class="gt_row gt_left">Auvergne-Rhône-Alpes</td>
<td headers="naf_section_code" class="gt_row gt_left">I</td>
<td headers="total_meuros" class="gt_row gt_right">247.868466</td>
<td headers="dep_name" class="gt_row gt_left">Savoie</td>
<td headers="iso3_code" class="gt_row gt_left">FXX</td>
<td headers="dep_code" class="gt_row gt_right">73</td>
<td headers="total" class="gt_row gt_right">247868466</td></tr>
    <tr><td headers="reg_code" class="gt_row gt_right">27</td>
<td headers="geo_point_2d" class="gt_row gt_center">47.115383, 3.504115</td>
<td headers="naf_section_name" class="gt_row gt_left">Information et communication</td>
<td headers="nombre_entreprises" class="gt_row gt_right">61</td>
<td headers="plan" class="gt_row gt_left">Fonds de solidarité</td>
<td headers="financial_support_count" class="gt_row gt_right">366</td>
<td headers="reg_name" class="gt_row gt_left">Bourgogne-Franche-Comté</td>
<td headers="naf_section_code" class="gt_row gt_left">J</td>
<td headers="total_meuros" class="gt_row gt_right">0.736895</td>
<td headers="dep_name" class="gt_row gt_left">Nièvre</td>
<td headers="iso3_code" class="gt_row gt_left">FXX</td>
<td headers="dep_code" class="gt_row gt_right">58</td>
<td headers="total" class="gt_row gt_right">736895</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Avant tout, comme indiqué dans la section précédente (2. Manipulation de la base), il faut comprendre quel est le format de ces données. Ici, les données sont micro-agrégées, c’est-à-dire qu’une observation est le croisement d’un secteur et d’un département ; il faut donc sommer les variables pour avoir une idée des montants de ces aides financières.<br />
Par exemple, on somme dans le code suivant le montant total des aides en euros et milliers d’euros, puis le nombre total des aides et enfin le nombre total d’entreprise concernées par ces aides ; la fonction <code>fmt_number()</code> ajoutée à la fin du code permet simplement d’avoir une séparation visuelle par milliers (un blanc ici ; le format chez les anglo-saxons étant une virgule…), puisque nous avons ici des montants très importants !</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="03-Manipulation-variables.html#cb65-1" aria-hidden="true" tabindex="-1"></a>dt_aidesCovid <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">total_aides=</span><span class="fu">sum</span>(total),</span>
<span id="cb65-2"><a href="03-Manipulation-variables.html#cb65-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">total_aides_meuros=</span><span class="fu">sum</span>(total_meuros),</span>
<span id="cb65-3"><a href="03-Manipulation-variables.html#cb65-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">nb_totales_aides=</span><span class="fu">sum</span>(financial_support_count),</span>
<span id="cb65-4"><a href="03-Manipulation-variables.html#cb65-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">nb_totales_entre=</span><span class="fu">sum</span>(nombre_entreprises)) <span class="sc">%&gt;%</span> <span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb65-5"><a href="03-Manipulation-variables.html#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="st">&quot;total_aides&quot;</span>, <span class="st">&quot;total_aides_meuros&quot;</span>, <span class="st">&quot;nb_totales_aides&quot;</span>, </span>
<span id="cb65-6"><a href="03-Manipulation-variables.html#cb65-6" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;nb_totales_entre&quot;</span>), <span class="at">sep_mark =</span> <span class="st">&quot; &quot;</span>, <span class="at">decimals =</span> <span class="dv">0</span>)</span></code></pre></div>
<div id="sjkocuvkgk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#sjkocuvkgk .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sjkocuvkgk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sjkocuvkgk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#sjkocuvkgk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sjkocuvkgk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sjkocuvkgk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sjkocuvkgk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sjkocuvkgk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sjkocuvkgk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sjkocuvkgk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sjkocuvkgk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sjkocuvkgk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sjkocuvkgk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#sjkocuvkgk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sjkocuvkgk .gt_from_md > :first-child {
  margin-top: 0;
}

#sjkocuvkgk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sjkocuvkgk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sjkocuvkgk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#sjkocuvkgk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sjkocuvkgk .gt_row_group_first td {
  border-top-width: 2px;
}

#sjkocuvkgk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sjkocuvkgk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sjkocuvkgk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sjkocuvkgk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sjkocuvkgk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sjkocuvkgk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sjkocuvkgk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sjkocuvkgk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sjkocuvkgk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sjkocuvkgk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sjkocuvkgk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sjkocuvkgk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sjkocuvkgk .gt_left {
  text-align: left;
}

#sjkocuvkgk .gt_center {
  text-align: center;
}

#sjkocuvkgk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sjkocuvkgk .gt_font_normal {
  font-weight: normal;
}

#sjkocuvkgk .gt_font_bold {
  font-weight: bold;
}

#sjkocuvkgk .gt_font_italic {
  font-style: italic;
}

#sjkocuvkgk .gt_super {
  font-size: 65%;
}

#sjkocuvkgk .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#sjkocuvkgk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sjkocuvkgk .gt_indent_1 {
  text-indent: 5px;
}

#sjkocuvkgk .gt_indent_2 {
  text-indent: 10px;
}

#sjkocuvkgk .gt_indent_3 {
  text-indent: 15px;
}

#sjkocuvkgk .gt_indent_4 {
  text-indent: 20px;
}

#sjkocuvkgk .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="total_aides">total_aides</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="total_aides_meuros">total_aides_meuros</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="nb_totales_aides">nb_totales_aides</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="nb_totales_entre">nb_totales_entre</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="total_aides" class="gt_row gt_right">35 490 463 923</td>
<td headers="total_aides_meuros" class="gt_row gt_right">35 490</td>
<td headers="nb_totales_aides" class="gt_row gt_right">10 531 765</td>
<td headers="nb_totales_entre" class="gt_row gt_right">2 016 218</td></tr>
  </tbody>
  
  
</table>
</div>
<p>On veut plus précisément étudier dans cette sous-section les possibles valeurs aberrantes. On peut alors afficher les valeurs maximum pour chacune de ces variables.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="03-Manipulation-variables.html#cb66-1" aria-hidden="true" tabindex="-1"></a>dt_aidesCovid <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">aides_max=</span><span class="fu">max</span>(total), <span class="at">aides_meuros_max=</span><span class="fu">max</span>(total_meuros),</span>
<span id="cb66-2"><a href="03-Manipulation-variables.html#cb66-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">nb_max_aides=</span><span class="fu">max</span>(financial_support_count),</span>
<span id="cb66-3"><a href="03-Manipulation-variables.html#cb66-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">nb_max_entre=</span><span class="fu">max</span>(nombre_entreprises)) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()  <span class="sc">%&gt;%</span> </span>
<span id="cb66-4"><a href="03-Manipulation-variables.html#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">sep_mark =</span> <span class="st">&quot; &quot;</span>, <span class="at">decimals =</span> <span class="dv">0</span>)</span></code></pre></div>
<div id="wpiltishua" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#wpiltishua .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wpiltishua .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wpiltishua .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wpiltishua .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wpiltishua .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wpiltishua .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wpiltishua .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wpiltishua .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wpiltishua .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wpiltishua .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wpiltishua .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wpiltishua .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wpiltishua .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wpiltishua .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wpiltishua .gt_from_md > :first-child {
  margin-top: 0;
}

#wpiltishua .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wpiltishua .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wpiltishua .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wpiltishua .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wpiltishua .gt_row_group_first td {
  border-top-width: 2px;
}

#wpiltishua .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wpiltishua .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wpiltishua .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wpiltishua .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wpiltishua .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wpiltishua .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wpiltishua .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wpiltishua .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wpiltishua .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wpiltishua .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wpiltishua .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wpiltishua .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wpiltishua .gt_left {
  text-align: left;
}

#wpiltishua .gt_center {
  text-align: center;
}

#wpiltishua .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wpiltishua .gt_font_normal {
  font-weight: normal;
}

#wpiltishua .gt_font_bold {
  font-weight: bold;
}

#wpiltishua .gt_font_italic {
  font-style: italic;
}

#wpiltishua .gt_super {
  font-size: 65%;
}

#wpiltishua .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#wpiltishua .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wpiltishua .gt_indent_1 {
  text-indent: 5px;
}

#wpiltishua .gt_indent_2 {
  text-indent: 10px;
}

#wpiltishua .gt_indent_3 {
  text-indent: 15px;
}

#wpiltishua .gt_indent_4 {
  text-indent: 20px;
}

#wpiltishua .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="aides_max">aides_max</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="aides_meuros_max">aides_meuros_max</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="nb_max_aides">nb_max_aides</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="nb_max_entre">nb_max_entre</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="aides_max" class="gt_row gt_right">1 649 963 187</td>
<td headers="aides_meuros_max" class="gt_row gt_right">1 650</td>
<td headers="nb_max_aides" class="gt_row gt_right">184 009</td>
<td headers="nb_max_entre" class="gt_row gt_right">35 383</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Ou faire quelques graphs sur la variable du montant total des aides en milliers d’euros “total_meuros” pour mieux visualiser de possibles valeurs aberrantes, de manière générale avec un histogramme, ou ventilées par région avec des “boîtes à moustache” :</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="03-Manipulation-variables.html#cb67-1" aria-hidden="true" tabindex="-1"></a>dt_aidesCovid <span class="sc">%&gt;%</span>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span>total_meuros) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">150</span>)</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/unnamed-chunk-42-1.svg" width="672" /></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="03-Manipulation-variables.html#cb68-1" aria-hidden="true" tabindex="-1"></a>dt_aidesCovid <span class="sc">%&gt;%</span>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span> reg_name, <span class="at">y =</span> total_meuros) <span class="sc">+</span>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb68-2"><a href="03-Manipulation-variables.html#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/unnamed-chunk-42-2.svg" width="672" /></p>
<p>On voit en effet quelques points qui semblent être des valeurs aberrantes ou “outliers” ; parfois, c’est à tel point qu’on n’arrive même pas à distinguer les différentes valeurs de la distribution marquées par le Boxplot et par conséquent les boxplot sont ramassées. Pour rappel, dans un boxplot, par défaut un point est affiché comme aberrant s’il est en dehors de l’intervalle suivant : <span class="math inline">\(I=[Q_{1}−1.5×IQR ; Q_{3}+1.5×IQR]\)</span>, <code>IQR</code> étant l’intervalle interquartile donc la différence entre Q1 et Q3.</p>
<p>Mais s’agit-il de “vraies” valeurs aberrantes ? Combien d’observations concernent-elles ? La fonction <code>boxplot.stats()</code> permet de récupérer les valeurs des observations indiquées comme aberrantes, comme cela on peut créer ensuite une variable indiquant si oui ou non l’observation a une valeur “aberrante”. Faisons-cela pour la variable “total_meuros” par exemple.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="03-Manipulation-variables.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On récupère les valeurs de la partie &#39;out&#39; des sorties de la fonction</span></span>
<span id="cb69-2"><a href="03-Manipulation-variables.html#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co"># &#39;boxplot.stats&#39;, qui correspondent aux valeurs de tout point de données</span></span>
<span id="cb69-3"><a href="03-Manipulation-variables.html#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># qui se situe au-delà des extrêmes de la boxplot</span></span>
<span id="cb69-4"><a href="03-Manipulation-variables.html#cb69-4" aria-hidden="true" tabindex="-1"></a>val_outliers <span class="ot">&lt;-</span> <span class="fu">boxplot.stats</span>(dt_aidesCovid<span class="sc">$</span>total_meuros)<span class="sc">$</span>out </span>
<span id="cb69-5"><a href="03-Manipulation-variables.html#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="03-Manipulation-variables.html#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co"># On crée une variable dans notre table d&#39;&quot;identification&quot; de ces outliers</span></span>
<span id="cb69-7"><a href="03-Manipulation-variables.html#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co"># avec comme modalité &quot;vraie&quot; si l&#39;observation a une valeur &quot;outliers&quot;, </span></span>
<span id="cb69-8"><a href="03-Manipulation-variables.html#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="co"># sinon &quot;Faux&quot;</span></span>
<span id="cb69-9"><a href="03-Manipulation-variables.html#cb69-9" aria-hidden="true" tabindex="-1"></a>dt_aidesCovid <span class="ot">&lt;-</span> dt_aidesCovid <span class="sc">%&gt;%</span> </span>
<span id="cb69-10"><a href="03-Manipulation-variables.html#cb69-10" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">mutate</span>(<span class="at">total_meuros_outliers =</span> </span>
<span id="cb69-11"><a href="03-Manipulation-variables.html#cb69-11" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">case_when</span>(total_meuros <span class="sc">%in%</span> <span class="fu">c</span>(val_outliers) <span class="sc">~</span> <span class="st">&quot;Vrai&quot;</span>,</span>
<span id="cb69-12"><a href="03-Manipulation-variables.html#cb69-12" aria-hidden="true" tabindex="-1"></a>                                     <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Faux&quot;</span>))</span>
<span id="cb69-13"><a href="03-Manipulation-variables.html#cb69-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-14"><a href="03-Manipulation-variables.html#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Puis on regarde la répartition avec la fonction `tabyl()` du package `janitor()` </span></span>
<span id="cb69-15"><a href="03-Manipulation-variables.html#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb69-16"><a href="03-Manipulation-variables.html#cb69-16" aria-hidden="true" tabindex="-1"></a>dt_aidesCovid <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(total_meuros_outliers) <span class="sc">%&gt;%</span> </span>
<span id="cb69-17"><a href="03-Manipulation-variables.html#cb69-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_pct_formatting</span>() <span class="sc">%&gt;%</span> <span class="fu">adorn_totals</span>(<span class="st">&quot;row&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 3 x 3
  total_meuros_outliers     n percent
  &lt;chr&gt;                 &lt;dbl&gt; &lt;chr&gt;  
1 Faux                   1484 88.3%  
2 Vrai                    196 11.7%  
3 Total                  1680 -      </code></pre>
<p>On y lit que pour cette variable, il y aurait près de 11,7% de valeurs aberrantes telles qu’indiquées par le boxplot, cela fait beaucoup ! On peut regarder plus précisément à quelles observations elles correspondent et à quel montant.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="03-Manipulation-variables.html#cb71-1" aria-hidden="true" tabindex="-1"></a>dt_aidesCovid <span class="sc">%&gt;%</span> <span class="fu">filter</span>(total_meuros_outliers<span class="sc">==</span><span class="st">&#39;Vrai&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb71-2"><a href="03-Manipulation-variables.html#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(total_meuros, naf_section_name, dep_name)  <span class="sc">%&gt;%</span></span>
<span id="cb71-3"><a href="03-Manipulation-variables.html#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(total_meuros) <span class="sc">%&gt;%</span>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code></pre></div>
<div id="guholryisc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#guholryisc .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#guholryisc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#guholryisc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#guholryisc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#guholryisc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#guholryisc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#guholryisc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#guholryisc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#guholryisc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#guholryisc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#guholryisc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#guholryisc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#guholryisc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#guholryisc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#guholryisc .gt_from_md > :first-child {
  margin-top: 0;
}

#guholryisc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#guholryisc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#guholryisc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#guholryisc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#guholryisc .gt_row_group_first td {
  border-top-width: 2px;
}

#guholryisc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#guholryisc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#guholryisc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#guholryisc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#guholryisc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#guholryisc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#guholryisc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#guholryisc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#guholryisc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#guholryisc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#guholryisc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#guholryisc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#guholryisc .gt_left {
  text-align: left;
}

#guholryisc .gt_center {
  text-align: center;
}

#guholryisc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#guholryisc .gt_font_normal {
  font-weight: normal;
}

#guholryisc .gt_font_bold {
  font-weight: bold;
}

#guholryisc .gt_font_italic {
  font-style: italic;
}

#guholryisc .gt_super {
  font-size: 65%;
}

#guholryisc .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#guholryisc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#guholryisc .gt_indent_1 {
  text-indent: 5px;
}

#guholryisc .gt_indent_2 {
  text-indent: 10px;
}

#guholryisc .gt_indent_3 {
  text-indent: 15px;
}

#guholryisc .gt_indent_4 {
  text-indent: 20px;
}

#guholryisc .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="total_meuros">total_meuros</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="naf_section_name">naf_section_name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="dep_name">dep_name</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="total_meuros" class="gt_row gt_right">41.41726</td>
<td headers="naf_section_name" class="gt_row gt_left">Transports et entreposage</td>
<td headers="dep_name" class="gt_row gt_left">Nord</td></tr>
    <tr><td headers="total_meuros" class="gt_row gt_right">41.54758</td>
<td headers="naf_section_name" class="gt_row gt_left">Commerce</td>
<td headers="dep_name" class="gt_row gt_left">Finistère</td></tr>
    <tr><td headers="total_meuros" class="gt_row gt_right">41.70506</td>
<td headers="naf_section_name" class="gt_row gt_left">Activités spécialisées, scientifiques et techniques</td>
<td headers="dep_name" class="gt_row gt_left">Bas-Rhin</td></tr>
    <tr><td headers="total_meuros" class="gt_row gt_right">41.74750</td>
<td headers="naf_section_name" class="gt_row gt_left">Hébergement et restauration</td>
<td headers="dep_name" class="gt_row gt_left">Aube</td></tr>
    <tr><td headers="total_meuros" class="gt_row gt_right">42.43167</td>
<td headers="naf_section_name" class="gt_row gt_left">Hébergement et restauration</td>
<td headers="dep_name" class="gt_row gt_left">Lot</td></tr>
    <tr><td headers="total_meuros" class="gt_row gt_right">42.45356</td>
<td headers="naf_section_name" class="gt_row gt_left">Hébergement et restauration</td>
<td headers="dep_name" class="gt_row gt_left">Eure-et-Loir</td></tr>
    <tr><td headers="total_meuros" class="gt_row gt_right">42.94316</td>
<td headers="naf_section_name" class="gt_row gt_left">Hébergement et restauration</td>
<td headers="dep_name" class="gt_row gt_left">Corrèze</td></tr>
    <tr><td headers="total_meuros" class="gt_row gt_right">43.24990</td>
<td headers="naf_section_name" class="gt_row gt_left">Hébergement et restauration</td>
<td headers="dep_name" class="gt_row gt_left">Haute-Loire</td></tr>
    <tr><td headers="total_meuros" class="gt_row gt_right">43.32271</td>
<td headers="naf_section_name" class="gt_row gt_left">Commerce</td>
<td headers="dep_name" class="gt_row gt_left">Morbihan</td></tr>
    <tr><td headers="total_meuros" class="gt_row gt_right">43.44017</td>
<td headers="naf_section_name" class="gt_row gt_left">Commerce</td>
<td headers="dep_name" class="gt_row gt_left">Calvados</td></tr>
  </tbody>
  
  
</table>
</div>
<p>OK on voit donc que cette procédure attribue des valeurs aberrantes pour des valeurs au-dessus de “41.41726” et donc à des observations qui seraient intéressants néanmoins à conserver ; attention par conséquent à identifier les valeurs dites aberrantes, éventuellement avec plusieurs méthodes (cf. ci-dessous) et surtout à les comprendre, il ne s’agit pas juste de les identifier pour les exclure ensuite des analyses.</p>
<p>Il existe en effet bien d’autres méthodes (méthode basée sur les percentiles ; méthode de Hampel), ainsi que des tests : par exemple, le package <strong><code>outliers</code></strong> vous permet de tester si une valeur (max ou min) est bien une valeur aberrante avec la fonction <code>grubbs.test()</code> (attention bis : à utiliser avec grande précaution et beaucoup de parcimonie), ou avec le package <strong><code>EnvStats</code></strong> et la fonction <code>rosnerTest()</code> pour détecter plusieurs “outliers” à la fois.</p>
<p>Pour gérer ces variables aberrantes, on peut les supprimer bien sûr si l’on est sûr que la valeur de la variable n’est pas “normale”, par exemple si on a une variable de salaire avec des modalités inférieures à 0, oui dans ce cas ce sont des mauvais outliers (et d’ailleurs peut-être même pas identifiés comme tel statistiquement) et on peut les supprimer ; de même pour des variables de résultats économiques, on va souvent élaguer la distribution en retirant les 1% (par exemple) du bas et du haut de la distribution pour supprimer des potentiels outliers.<br />
Sinon, on les isole en créant une variable dichotomique “0/1” ou “Faux/Vrai” ; ou on crée une variable qualitative avec plusieurs catégories.</p>
<p>Dans les graphiques, en particulier les boîtes à moustache, on peut les supprimer avec l’option <code>outlier.shape = NA</code> et mettre ensuite une échelle plus réduite (avec <code>ylim=c(0,175)</code>) pour que le graphique soit plus lisible, mais il faut alors bien préciser dans la légende que certaines valeurs ne sont pas visibles sur le graphique car retirées.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="03-Manipulation-variables.html#cb72-1" aria-hidden="true" tabindex="-1"></a>dt_aidesCovid <span class="sc">%&gt;%</span>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span> reg_name, <span class="at">y =</span> total_meuros) <span class="sc">+</span> </span>
<span id="cb72-2"><a href="03-Manipulation-variables.html#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span> <span class="fu">coord_flip</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">175</span>)) <span class="sc">+</span></span>
<span id="cb72-3"><a href="03-Manipulation-variables.html#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution des aides financières en millions d&#39;euros, </span></span>
<span id="cb72-4"><a href="03-Manipulation-variables.html#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="st">selon la région&quot;</span>, <span class="at">y=</span><span class="st">&quot;&quot;</span>, <span class="at">x=</span><span class="st">&quot;Région&quot;</span>, </span>
<span id="cb72-5"><a href="03-Manipulation-variables.html#cb72-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;Rq : les valeurs au-delà de 175 millions d&#39;euros ne sont pas affichées sur le graphique.&quot;</span>) <span class="sc">+</span></span>
<span id="cb72-6"><a href="03-Manipulation-variables.html#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="Data-Mining_files/figure-html/unnamed-chunk-45-1.svg" width="672" /></p>
</div>
<div id="découper-en-classes-une-variable-quantitative" class="section level3 hasAnchor" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Découper en classes une variable quantitative<a href="03-Manipulation-variables.html#découper-en-classes-une-variable-quantitative" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>On peut enfin découper en classes une variable quantitative et en faire donc une variable qualitative. On utilise pour cela la fonction <code>cut()</code> du langage de base de <code>R</code>. On peut par exemple découper la variable selon les principaux indicateurs de la distribution.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="03-Manipulation-variables.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb73-2"><a href="03-Manipulation-variables.html#cb73-2" aria-hidden="true" tabindex="-1"></a>dt_aidesCovid <span class="sc">%&gt;%</span> <span class="fu">get_summary_stats</span>(total_meuros) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code></pre></div>
<div id="udnodkxgtv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#udnodkxgtv .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#udnodkxgtv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#udnodkxgtv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#udnodkxgtv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#udnodkxgtv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#udnodkxgtv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#udnodkxgtv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#udnodkxgtv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#udnodkxgtv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#udnodkxgtv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#udnodkxgtv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#udnodkxgtv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#udnodkxgtv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#udnodkxgtv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#udnodkxgtv .gt_from_md > :first-child {
  margin-top: 0;
}

#udnodkxgtv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#udnodkxgtv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#udnodkxgtv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#udnodkxgtv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#udnodkxgtv .gt_row_group_first td {
  border-top-width: 2px;
}

#udnodkxgtv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#udnodkxgtv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#udnodkxgtv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#udnodkxgtv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#udnodkxgtv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#udnodkxgtv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#udnodkxgtv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#udnodkxgtv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#udnodkxgtv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#udnodkxgtv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#udnodkxgtv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#udnodkxgtv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#udnodkxgtv .gt_left {
  text-align: left;
}

#udnodkxgtv .gt_center {
  text-align: center;
}

#udnodkxgtv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#udnodkxgtv .gt_font_normal {
  font-weight: normal;
}

#udnodkxgtv .gt_font_bold {
  font-weight: bold;
}

#udnodkxgtv .gt_font_italic {
  font-style: italic;
}

#udnodkxgtv .gt_super {
  font-size: 65%;
}

#udnodkxgtv .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#udnodkxgtv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#udnodkxgtv .gt_indent_1 {
  text-indent: 5px;
}

#udnodkxgtv .gt_indent_2 {
  text-indent: 10px;
}

#udnodkxgtv .gt_indent_3 {
  text-indent: 15px;
}

#udnodkxgtv .gt_indent_4 {
  text-indent: 20px;
}

#udnodkxgtv .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="variable">variable</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="min">min</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="max">max</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="median">median</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="q1">q1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="q3">q3</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="iqr">iqr</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mad">mad</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mean">mean</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sd">sd</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="se">se</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="ci">ci</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="variable" class="gt_row gt_center">total_meuros</td>
<td headers="n" class="gt_row gt_right">1680</td>
<td headers="min" class="gt_row gt_right">0.006</td>
<td headers="max" class="gt_row gt_right">1649.963</td>
<td headers="median" class="gt_row gt_right">6.001</td>
<td headers="q1" class="gt_row gt_right">1.828</td>
<td headers="q3" class="gt_row gt_right">17.644</td>
<td headers="iqr" class="gt_row gt_right">15.815</td>
<td headers="mad" class="gt_row gt_right">7.56</td>
<td headers="mean" class="gt_row gt_right">21.125</td>
<td headers="sd" class="gt_row gt_right">60.662</td>
<td headers="se" class="gt_row gt_right">1.48</td>
<td headers="ci" class="gt_row gt_right">2.903</td></tr>
  </tbody>
  
  
</table>
</div>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="03-Manipulation-variables.html#cb74-1" aria-hidden="true" tabindex="-1"></a>dt_aidesCovid<span class="sc">$</span>total_meuros_cat <span class="ot">&lt;-</span> <span class="fu">cut</span>(dt_aidesCovid<span class="sc">$</span>total_meuros,  </span>
<span id="cb74-2"><a href="03-Manipulation-variables.html#cb74-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,</span>
<span id="cb74-3"><a href="03-Manipulation-variables.html#cb74-3" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">quantile</span>(dt_aidesCovid<span class="sc">$</span>total_meuros,<span class="fl">0.25</span>), </span>
<span id="cb74-4"><a href="03-Manipulation-variables.html#cb74-4" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">mean</span>(dt_aidesCovid<span class="sc">$</span>total_meuros), </span>
<span id="cb74-5"><a href="03-Manipulation-variables.html#cb74-5" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">max</span>(dt_aidesCovid<span class="sc">$</span>total_meuros)))</span>
<span id="cb74-6"><a href="03-Manipulation-variables.html#cb74-6" aria-hidden="true" tabindex="-1"></a>dt_aidesCovid <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(total_meuros_cat) <span class="sc">%&gt;%</span> <span class="fu">adorn_pct_formatting</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb74-7"><a href="03-Manipulation-variables.html#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="st">&quot;row&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code></pre></div>
<div id="rprkxlyypo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#rprkxlyypo .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rprkxlyypo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rprkxlyypo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rprkxlyypo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rprkxlyypo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rprkxlyypo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rprkxlyypo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rprkxlyypo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rprkxlyypo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rprkxlyypo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rprkxlyypo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rprkxlyypo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rprkxlyypo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rprkxlyypo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rprkxlyypo .gt_from_md > :first-child {
  margin-top: 0;
}

#rprkxlyypo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rprkxlyypo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rprkxlyypo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rprkxlyypo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rprkxlyypo .gt_row_group_first td {
  border-top-width: 2px;
}

#rprkxlyypo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rprkxlyypo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rprkxlyypo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rprkxlyypo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rprkxlyypo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rprkxlyypo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rprkxlyypo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rprkxlyypo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rprkxlyypo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rprkxlyypo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rprkxlyypo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rprkxlyypo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rprkxlyypo .gt_left {
  text-align: left;
}

#rprkxlyypo .gt_center {
  text-align: center;
}

#rprkxlyypo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rprkxlyypo .gt_font_normal {
  font-weight: normal;
}

#rprkxlyypo .gt_font_bold {
  font-weight: bold;
}

#rprkxlyypo .gt_font_italic {
  font-style: italic;
}

#rprkxlyypo .gt_super {
  font-size: 65%;
}

#rprkxlyypo .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#rprkxlyypo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rprkxlyypo .gt_indent_1 {
  text-indent: 5px;
}

#rprkxlyypo .gt_indent_2 {
  text-indent: 10px;
}

#rprkxlyypo .gt_indent_3 {
  text-indent: 15px;
}

#rprkxlyypo .gt_indent_4 {
  text-indent: 20px;
}

#rprkxlyypo .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_meuros_cat">total_meuros_cat</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="percent">percent</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="total_meuros_cat" class="gt_row gt_center">(0,1.83]</td>
<td headers="n" class="gt_row gt_right">420</td>
<td headers="percent" class="gt_row gt_right">25.0%</td></tr>
    <tr><td headers="total_meuros_cat" class="gt_row gt_center">(1.83,21.1]</td>
<td headers="n" class="gt_row gt_right">901</td>
<td headers="percent" class="gt_row gt_right">53.6%</td></tr>
    <tr><td headers="total_meuros_cat" class="gt_row gt_center">(21.1,1.65e+03]</td>
<td headers="n" class="gt_row gt_right">359</td>
<td headers="percent" class="gt_row gt_right">21.4%</td></tr>
    <tr><td headers="total_meuros_cat" class="gt_row gt_center">Total</td>
<td headers="n" class="gt_row gt_right">1680</td>
<td headers="percent" class="gt_row gt_right">-</td></tr>
  </tbody>
  
  
</table>
</div>
<p>On a une classe majoritaire (du Q1 à la moyenne), mais cela nous permet de distinguer 2 classes pour lesquelles le montant des aides financières est très faible ou au contraire très élevé.</p>
<p>À noter que si la variable quantitative en question a des valeurs manquantes, il faudra utiliser la fonction <code>fancycut()</code> ou <code>wafflecut()</code> du package <strong><code>fancycut</code></strong>, l’inconvénient est que cela nous oblige à indiquer les valeurs des différents indicateurs de la distribution. Pour trouver le même résultat que précédemment, le code serait alors le suivant :</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="03-Manipulation-variables.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fancycut)</span>
<span id="cb75-2"><a href="03-Manipulation-variables.html#cb75-2" aria-hidden="true" tabindex="-1"></a>dt_aidesCovid<span class="sc">$</span>total_meuros_cat1 <span class="ot">&lt;-</span> <span class="fu">fancycut</span>(dt_aidesCovid<span class="sc">$</span>total_meuros, <span class="st">&#39;1&#39;</span><span class="ot">=</span><span class="st">&#39;(0,1.83]&#39;</span>, </span>
<span id="cb75-3"><a href="03-Manipulation-variables.html#cb75-3" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&#39;2&#39;</span><span class="ot">=</span><span class="st">&#39;(1.83,21]&#39;</span>, <span class="st">&#39;3&#39;</span><span class="ot">=</span><span class="st">&#39;(21,1.64e+03]&#39;</span>, </span>
<span id="cb75-4"><a href="03-Manipulation-variables.html#cb75-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">na.bucket=</span><span class="st">&#39;Manquant&#39;</span>)</span>
<span id="cb75-5"><a href="03-Manipulation-variables.html#cb75-5" aria-hidden="true" tabindex="-1"></a>dt_aidesCovid <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(total_meuros_cat1) <span class="sc">%&gt;%</span> <span class="fu">adorn_pct_formatting</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-6"><a href="03-Manipulation-variables.html#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="st">&quot;row&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code></pre></div>

</div>
</div>
</div>
<script src="js/tidyverse.js"></script>
            </section>

          </div>
        </div>
      </div>
<a href="02-Manipulation-base.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="04-Récapitulatif.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Camille-Sisi/github.io-Data-Mining-2023/master/03-Manipulation-variables.Rmd",
"text": "Source"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
