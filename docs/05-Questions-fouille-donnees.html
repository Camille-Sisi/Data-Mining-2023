<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 5 Quelles questions intéressantes pour une “fouille de données” sur cette base ? | DATA MINING</title>
  <meta name="description" content="Titre du cours" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 5 Quelles questions intéressantes pour une “fouille de données” sur cette base ? | DATA MINING" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Titre du cours" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 5 Quelles questions intéressantes pour une “fouille de données” sur cette base ? | DATA MINING" />
  
  <meta name="twitter:description" content="Titre du cours" />
  

<meta name="author" content="Camille Signoretto, Maîtresse de conférences en économie, Université Paris Cité" />


<meta name="date" content="2023-05-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="04-Récapitulatif.html"/>
<link rel="next" href="06-Intro-a-Shiny-theorique.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/tidyverse.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Mining :  <em>Camille Signoretto</em></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html"><i class="fa fa-check"></i>Présentation</a>
<ul>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html#à-propos-de-ce-document"><i class="fa fa-check"></i>À propos de ce document</a></li>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html#prérequis"><i class="fa fa-check"></i>Prérequis</a></li>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html#remerciements"><i class="fa fa-check"></i>Remerciements</a></li>
<li class="chapter" data-level="" data-path="00-Presentation.html"><a href="00-Presentation.html#licence"><i class="fa fa-check"></i>Licence</a></li>
</ul></li>
<li class="part"><span><b>Séance 1 : Data Wrangling</b></span></li>
<li class="chapter" data-level="1" data-path="01-Base-de-donnees.html"><a href="01-Base-de-donnees.html"><i class="fa fa-check"></i><b>1</b> Récupération de la base de données</a>
<ul>
<li class="chapter" data-level="1.1" data-path="01-Base-de-donnees.html"><a href="01-Base-de-donnees.html#les-données-du-recensement-de-la-population-rp"><i class="fa fa-check"></i><b>1.1</b> Les données du Recensement de la Population (RP)</a></li>
<li class="chapter" data-level="1.2" data-path="01-Base-de-donnees.html"><a href="01-Base-de-donnees.html#quelles-informations-intéressantes-dans-cette-base"><i class="fa fa-check"></i><b>1.2</b> Quelles informations intéressantes dans cette base ?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="02-Manipulation-base.html"><a href="02-Manipulation-base.html"><i class="fa fa-check"></i><b>2</b> Manipulation de la base</a>
<ul>
<li class="chapter" data-level="2.1" data-path="02-Manipulation-base.html"><a href="02-Manipulation-base.html#format-des-données---wide-ou-long"><i class="fa fa-check"></i><b>2.1</b> Format des données - WIDE ou LONG</a></li>
<li class="chapter" data-level="2.2" data-path="02-Manipulation-base.html"><a href="02-Manipulation-base.html#sélectionner-un-champ-réduit-de-la-base-séparer-les-données"><i class="fa fa-check"></i><b>2.2</b> Sélectionner un champ réduit de la base, séparer les données</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html"><i class="fa fa-check"></i><b>3</b> Manipulation des variables</a>
<ul>
<li class="chapter" data-level="3.1" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#manipulation-des-variables-qualitatives"><i class="fa fa-check"></i><b>3.1</b> Manipulation des variables qualitatives</a></li>
<li class="chapter" data-level="3.2" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#manipulation-des-variables-quantitatives"><i class="fa fa-check"></i><b>3.2</b> Manipulation des variables quantitatives</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#détecter-et-visualiser-les-valeurs-manquantes"><i class="fa fa-check"></i><b>3.2.1</b> Détecter et “visualiser” les valeurs manquantes</a></li>
<li class="chapter" data-level="3.2.2" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#gérer-les-valeurs-manquantes"><i class="fa fa-check"></i><b>3.2.2</b> Gérer les valeurs manquantes</a></li>
<li class="chapter" data-level="3.2.3" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#détecter-et-visualiser-les-valeurs-aberrantes"><i class="fa fa-check"></i><b>3.2.3</b> Détecter et “visualiser” les valeurs aberrantes</a></li>
<li class="chapter" data-level="3.2.4" data-path="03-Manipulation-variables.html"><a href="03-Manipulation-variables.html#découper-en-classes-une-variable-quantitative"><i class="fa fa-check"></i><b>3.2.4</b> Découper en classes une variable quantitative</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="04-Récapitulatif.html"><a href="04-Récapitulatif.html"><i class="fa fa-check"></i><b>4</b> Récapitulatig séance 1 - Data Wrangling</a>
<ul>
<li class="chapter" data-level="4.1" data-path="04-Récapitulatif.html"><a href="04-Récapitulatif.html#ce-quon-a-appris"><i class="fa fa-check"></i><b>4.1</b> Ce qu’on a appris</a></li>
<li class="chapter" data-level="4.2" data-path="04-Récapitulatif.html"><a href="04-Récapitulatif.html#enregistrement-des-tables"><i class="fa fa-check"></i><b>4.2</b> Enregistrement des tables</a></li>
</ul></li>
<li class="part"><span><b>Séance 2 : Data Mining - Analyse descriptive</b></span></li>
<li class="chapter" data-level="5" data-path="05-Questions-fouille-donnees.html"><a href="05-Questions-fouille-donnees.html"><i class="fa fa-check"></i><b>5</b> Quelles questions intéressantes pour une “fouille de données” sur cette base ?</a>
<ul>
<li class="chapter" data-level="5.1" data-path="05-Questions-fouille-donnees.html"><a href="05-Questions-fouille-donnees.html#caractéristiques-des-logements-de-la-commune-de-paris"><i class="fa fa-check"></i><b>5.1</b> Caractéristiques des logements de la commune de Paris</a></li>
<li class="chapter" data-level="5.2" data-path="05-Questions-fouille-donnees.html"><a href="05-Questions-fouille-donnees.html#systématiser-nos-procédures-construire-une-fonction"><i class="fa fa-check"></i><b>5.2</b> Systématiser nos procédures : construire une fonction</a></li>
</ul></li>
<li class="part"><span><b>Séance 3 : Introduction à ShinyApp</b></span></li>
<li class="chapter" data-level="6" data-path="06-Intro-a-Shiny-theorique.html"><a href="06-Intro-a-Shiny-theorique.html"><i class="fa fa-check"></i><b>6</b> Les applications interactives avec Shiny App</a>
<ul>
<li class="chapter" data-level="6.1" data-path="06-Intro-a-Shiny-theorique.html"><a href="06-Intro-a-Shiny-theorique.html#la-structure-générale-dune-application-shiny"><i class="fa fa-check"></i><b>6.1</b> La structure générale d’une application Shiny</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="06-Intro-a-Shiny-theorique.html"><a href="06-Intro-a-Shiny-theorique.html#la-partie-ui"><i class="fa fa-check"></i><b>6.1.1</b> La partie “UI”</a></li>
<li class="chapter" data-level="6.1.2" data-path="06-Intro-a-Shiny-theorique.html"><a href="06-Intro-a-Shiny-theorique.html#la-partie-server"><i class="fa fa-check"></i><b>6.1.2</b> La partie “Server”</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="06-Intro-a-Shiny-theorique.html"><a href="06-Intro-a-Shiny-theorique.html#la-réactivité"><i class="fa fa-check"></i><b>6.2</b> La réactivité</a></li>
<li class="chapter" data-level="6.3" data-path="06-Intro-a-Shiny-theorique.html"><a href="06-Intro-a-Shiny-theorique.html#un-exemple-avec-le-code-du-script-par-défaut"><i class="fa fa-check"></i><b>6.3</b> Un exemple avec le code du script par défaut</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="07-Intro-a-Shiny-exemples.html"><a href="07-Intro-a-Shiny-exemples.html"><i class="fa fa-check"></i><b>7</b> La création d’une application Shiny “pas à pas” avec l’une de nos bases de données</a>
<ul>
<li class="chapter" data-level="7.1" data-path="07-Intro-a-Shiny-exemples.html"><a href="07-Intro-a-Shiny-exemples.html#application-vide"><i class="fa fa-check"></i><b>7.1</b> Application vide</a></li>
<li class="chapter" data-level="7.2" data-path="07-Intro-a-Shiny-exemples.html"><a href="07-Intro-a-Shiny-exemples.html#ajout-dun-titre-et-dun-widget"><i class="fa fa-check"></i><b>7.2</b> Ajout d’un titre et d’un widget</a></li>
<li class="chapter" data-level="7.3" data-path="07-Intro-a-Shiny-exemples.html"><a href="07-Intro-a-Shiny-exemples.html#ajout-dun-graphique"><i class="fa fa-check"></i><b>7.3</b> Ajout d’un graphique</a></li>
<li class="chapter" data-level="7.4" data-path="07-Intro-a-Shiny-exemples.html"><a href="07-Intro-a-Shiny-exemples.html#modification-du-graphique-filtrer-selon-une-variable"><i class="fa fa-check"></i><b>7.4</b> Modification du graphique : filtrer selon une variable</a></li>
<li class="chapter" data-level="7.5" data-path="07-Intro-a-Shiny-exemples.html"><a href="07-Intro-a-Shiny-exemples.html#modification-du-graphique-selon-une-variable-au-choix-parmi-deux"><i class="fa fa-check"></i><b>7.5</b> Modification du graphique : selon une variable au choix parmi deux</a></li>
</ul></li>
<li class="part"><span><b>Séances 4 à 6 : Data Visualization</b></span></li>
<li class="chapter" data-level="8" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html"><i class="fa fa-check"></i><b>8</b> Data Visualization et Ggplot2 : aspects théoriques</a>
<ul>
<li class="chapter" data-level="8.1" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#présentation-générale-de-ggplot2"><i class="fa fa-check"></i><b>8.1</b> Présentation générale de Ggplot2</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#les-aesthetics-ou-arguments-esthétiques"><i class="fa fa-check"></i><b>8.1.1</b> Les “aesthetics” ou arguments esthétiques</a></li>
<li class="chapter" data-level="8.1.2" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#les-géométries"><i class="fa fa-check"></i><b>8.1.2</b> Les géométries</a></li>
<li class="chapter" data-level="8.1.3" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#les-facettes"><i class="fa fa-check"></i><b>8.1.3</b> Les facettes</a></li>
<li class="chapter" data-level="8.1.4" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#les-statistiques"><i class="fa fa-check"></i><b>8.1.4</b> Les statistiques</a></li>
<li class="chapter" data-level="8.1.5" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#les-coordonnées"><i class="fa fa-check"></i><b>8.1.5</b> Les coordonnées</a></li>
<li class="chapter" data-level="8.1.6" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#les-thèmes"><i class="fa fa-check"></i><b>8.1.6</b> Les thèmes</a></li>
<li class="chapter" data-level="8.1.7" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#les-autres-options-graphiques-titres-échelles-des-axes-etc."><i class="fa fa-check"></i><b>8.1.7</b> Les autres options graphiques : titres, échelles des axes, etc.</a></li>
<li class="chapter" data-level="8.1.8" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#code-minimal"><i class="fa fa-check"></i><b>8.1.8</b> Code minimal</a></li>
<li class="chapter" data-level="8.1.9" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#liens-utiles-pour-aller-plus-loin"><i class="fa fa-check"></i><b>8.1.9</b> Liens utiles pour aller plus loin</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="08-Ggplot-theorique.html"><a href="08-Ggplot-theorique.html#les-grands-principes-de-data-visualization"><i class="fa fa-check"></i><b>8.2</b> Les grands principes de data visualization</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="09-Ggplot-pratique.html"><a href="09-Ggplot-pratique.html"><i class="fa fa-check"></i><b>9</b> Le package Ggplot en pratiques</a>
<ul>
<li class="chapter" data-level="9.1" data-path="09-Ggplot-pratique.html"><a href="09-Ggplot-pratique.html#exemple-de-la-construction-dun-graphique-pas-à-pas"><i class="fa fa-check"></i><b>9.1</b> Exemple de la construction d’un graphique pas à pas</a></li>
<li class="chapter" data-level="9.2" data-path="09-Ggplot-pratique.html"><a href="09-Ggplot-pratique.html#dautres-exemples-à-travers-des-exercices"><i class="fa fa-check"></i><b>9.2</b> D’autres exemples à travers des exercices</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="09-Ggplot-pratique.html"><a href="09-Ggplot-pratique.html#distribution-du-prix-au-m2-pour-les-appartements-selon-les-arrondissements-de-paris"><i class="fa fa-check"></i><b>9.2.1</b> Distribution du prix au m2 pour les appartements, selon les arrondissements de Paris</a></li>
<li class="chapter" data-level="9.2.2" data-path="09-Ggplot-pratique.html"><a href="09-Ggplot-pratique.html#comparaison-des-montants-moyen-et-médian-du-prix-au-m2-par-département-de-paris-et-sa-petite-couronne"><i class="fa fa-check"></i><b>9.2.2</b> Comparaison des montants moyen et médian du prix au m2, par département de Paris et sa petite couronne</a></li>
<li class="chapter" data-level="9.2.3" data-path="09-Ggplot-pratique.html"><a href="09-Ggplot-pratique.html#evolution-du-prix-moyen-au-m2-des-ventes-dappartements-à-paris"><i class="fa fa-check"></i><b>9.2.3</b> Evolution du prix moyen au m2 des ventes d’appartements à Paris</a></li>
<li class="chapter" data-level="9.2.4" data-path="09-Ggplot-pratique.html"><a href="09-Ggplot-pratique.html#top-5-du-prix-au-m2-des-ventes-dappartements-selon-les-communes-ou-arrondissements"><i class="fa fa-check"></i><b>9.2.4</b> Top 5 du prix au m2 des ventes d’appartements selon les communes (ou arrondissements)</a></li>
<li class="chapter" data-level="9.2.5" data-path="09-Ggplot-pratique.html"><a href="09-Ggplot-pratique.html#à-vous-de-jouer"><i class="fa fa-check"></i><b>9.2.5</b> À vous de “jouer” !</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-Retour-sur-Shiny.html"><a href="10-Retour-sur-Shiny.html"><i class="fa fa-check"></i><b>10</b> Application sur Shiny</a>
<ul>
<li class="chapter" data-level="10.1" data-path="10-Retour-sur-Shiny.html"><a href="10-Retour-sur-Shiny.html#application-avec-un-tableau-et-un-graphique"><i class="fa fa-check"></i><b>10.1</b> Application avec un tableau et un graphique</a></li>
<li class="chapter" data-level="10.2" data-path="10-Retour-sur-Shiny.html"><a href="10-Retour-sur-Shiny.html#introduction-dune-réactivité-appliquée-à-la-table-de-données"><i class="fa fa-check"></i><b>10.2</b> Introduction d’une réactivité appliquée à la table de données</a></li>
<li class="chapter" data-level="10.3" data-path="10-Retour-sur-Shiny.html"><a href="10-Retour-sur-Shiny.html#introduction-dune-réactivité-sur-les-inputs-contexte-réactif"><i class="fa fa-check"></i><b>10.3</b> Introduction d’une réactivité sur les inputs (contexte réactif)</a></li>
</ul></li>
<li class="part"><span><b>Séance 7 : Data Mining</b></span></li>
<li class="chapter" data-level="11" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html"><i class="fa fa-check"></i><b>11</b> Clustering : application sur le RP 2019</a>
<ul>
<li class="chapter" data-level="11.1" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#choix-des-variables-et-préparation-du-tableau-final"><i class="fa fa-check"></i><b>11.1</b> Choix des variables et préparation du tableau final</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#variables-socio-professionnelles-caractérisant-la-personne-de-référence-du-ménage"><i class="fa fa-check"></i><b>11.1.1</b> Variables socio-professionnelles caractérisant la personne de référence du ménage</a></li>
<li class="chapter" data-level="11.1.2" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#création-des-différents-tableaux-de-contingence"><i class="fa fa-check"></i><b>11.1.2</b> Création des différents tableaux de contingence</a></li>
<li class="chapter" data-level="11.1.3" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#création-du-tableau-final"><i class="fa fa-check"></i><b>11.1.3</b> Création du tableau final</a></li>
<li class="chapter" data-level="11.1.4" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#choix-des-variables-actives-dans-le-clustering"><i class="fa fa-check"></i><b>11.1.4</b> choix des variables actives dans le clustering</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#la-méthode-de-la-cah-appliquée-à-nos-données"><i class="fa fa-check"></i><b>11.2</b> La méthode de la CAH appliquée à nos données</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#constitution-des-classes"><i class="fa fa-check"></i><b>11.2.1</b> Constitution des classes</a></li>
<li class="chapter" data-level="11.2.2" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#visualisation-sur-la-carte-de-la-commune"><i class="fa fa-check"></i><b>11.2.2</b> Visualisation sur la carte de la commune</a></li>
<li class="chapter" data-level="11.2.3" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#interprétation"><i class="fa fa-check"></i><b>11.2.3</b> Interprétation</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="11-Clustering-application.html"><a href="11-Clustering-application.html#la-méthode-des-k-means-appliquée-à-nos-données"><i class="fa fa-check"></i><b>11.3</b> La méthode des <em>k-means</em> appliquée à nos données</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="12-Modeles-regression.html"><a href="12-Modeles-regression.html"><i class="fa fa-check"></i><b>12</b> Modèles de régression : application sur le RP 2019</a>
<ul>
<li class="chapter" data-level="12.1" data-path="12-Modeles-regression.html"><a href="12-Modeles-regression.html#la-création-des-bases-dapprentissage-et-de-test"><i class="fa fa-check"></i><b>12.1</b> La création des bases d’apprentissage et de test</a></li>
<li class="chapter" data-level="12.2" data-path="12-Modeles-regression.html"><a href="12-Modeles-regression.html#un-modèle-à-visée-principale-descriptiveexplicative-la-régression-logistique"><i class="fa fa-check"></i><b>12.2</b> Un modèle à visée principale descriptive/explicative : la régression logistique</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="12-Modeles-regression.html"><a href="12-Modeles-regression.html#le-modèle-initial"><i class="fa fa-check"></i><b>12.2.1</b> Le modèle initial</a></li>
<li class="chapter" data-level="12.2.2" data-path="12-Modeles-regression.html"><a href="12-Modeles-regression.html#lévaluation-du-modèle-et-la-recherche-éventuelle-dun-meilleur-modèle"><i class="fa fa-check"></i><b>12.2.2</b> L’évaluation du modèle et la recherche éventuelle d’un “meilleur” modèle</a></li>
<li class="chapter" data-level="12.2.3" data-path="12-Modeles-regression.html"><a href="12-Modeles-regression.html#le-modèle-final-et-linterprétation-des-résultats"><i class="fa fa-check"></i><b>12.2.3</b> Le modèle final et l’interprétation des résultats</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="12-Modeles-regression.html"><a href="12-Modeles-regression.html#un-modèle-à-visée-principale-prédictive-labre-de-décision"><i class="fa fa-check"></i><b>12.3</b> Un modèle à visée principale prédictive : l’abre de décision</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="12-Modeles-regression.html"><a href="12-Modeles-regression.html#le-modèle-initial-1"><i class="fa fa-check"></i><b>12.3.1</b> Le modèle initial</a></li>
<li class="chapter" data-level="12.3.2" data-path="12-Modeles-regression.html"><a href="12-Modeles-regression.html#lévaluation-du-modèle"><i class="fa fa-check"></i><b>12.3.2</b> L’évaluation du modèle</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DATA MINING</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="c05-Questions-fouille-donnees" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Section 5</span> Quelles questions intéressantes pour une “fouille de données” sur cette base ?<a href="05-Questions-fouille-donnees.html#c05-Questions-fouille-donnees" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div align="justify">

<p>Quelles sont les questions intéressantes que l’on peut se poser ? Qu’est-ce qu’on va pouvoir mettre en évidence à partir de ces données ?</p>
<p>D’abord, on pourrait caractériser les logements fanciliens selon le type de logement (appartement, maison, HLM, …), la superficie, le nombre de pièces, le nombre de personnes y habitant, le statut d’occupation (propriétaire, locataire, …). Ensuite, on pourrait décrire plus précisément les pièces du logement en termes de confort (baignoire / douche, salle climatisée, moyen de chauffage), ainsi que les parties communes de l’immeuble (ascenseur, place de stationnement). Enfin, on pourrait étudier les caractéristiques des occupants de ces logements, et en premier lieu ici ce que l’Insee appelle la “personne de référence du ménage”. Par ailleurs, toutes ces analyses peuvent être réalisées en comparant les différentes communes de la région, ou à un niveau géographique plus fin par quartiers, arrondissements ou encore IRIS.</p>
<p>Pour manipuler cette base et répondre à quelques-unes de ces questions, nous allons nous concentrer sur la commune de Paris, et allons chercher à reproduire des statistiques publiées sur le site de l’Insee. Nous produirons principalement, lors de cette séance, des tableaux de statistiques, l’analyse graphique fera en effet l’objet d’une séance entière car elle nécessite la présentation détaillée de la “grammaire” <strong><code>Ggplot</code></strong>.</p>
<p>Avant cela, si les tables de données (“RP” et “meta”) ne sont plus dans votre environnement local, il faut de nouveau les importer à partir de l’enregistrement précédemment effectué dans le dossier ‘data’ de votre projet. Pour cela, il faut utiliser la fonction <code>readRDS()</code>, comme ci-dessous :</p>
<div id="caractéristiques-des-logements-de-la-commune-de-paris" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Caractéristiques des logements de la commune de Paris<a href="05-Questions-fouille-donnees.html#caractéristiques-des-logements-de-la-commune-de-paris" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Sur le site de l’Insee, vous pouvez trouver les statistiques générales sur les logements à Paris en 2019 <a href="https://www.insee.fr/fr/statistiques/2011101?geo=DEP-75#chiffre-cle-3" target="_blank">ici</a>.</p>
<p>Comme nous devons utiliser la pondération pour avoir des statistiques représentatives de la population française, une manière de faire est d’utiliser une méthode de comptage par variable catégorielle en indiquant la pondération à utiliser. La fonction <code>count()</code> avec l’argument <code>wt=</code> est un des moyens assez efficace d’y arriver. Cela nous donnera le nombre de ménages concernés par la caractéristique étudiée (par défaut, la variable créée s’appelle “n”, on peut la renommer dans une étape ultérieure avec la fonction <code>rename()</code>). Souvent, c’est aussi les pourcentages que l’on souhaite avoir, il faudra alors créer une variable faisant la proportion de chaque catégorie sur le nombre total de logements, en utilisant la fonction <code>mutate()</code> et la fonction <code>prop.table()</code>. Le package <strong><code>janitor</code></strong> permet enfin d’ajouter une ligne totale (ou une colonne totale selon ce qu’on souhaite faire) avec la fonction <code>adorn_totals()</code>, argument “row” pour avoir le total en ligne.</p>
<p>A partir de ces indications, afficher le tableau suivant à partir d’un code utilisant le langage <strong>tidyverse</strong> et en une seule procédure (sans nécessairement créer de table dans votre environnement) :</p>
<div id="doehulahww" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#doehulahww .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#doehulahww .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#doehulahww .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#doehulahww .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#doehulahww .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#doehulahww .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#doehulahww .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#doehulahww .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#doehulahww .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#doehulahww .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#doehulahww .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#doehulahww .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#doehulahww .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#doehulahww .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#doehulahww .gt_from_md > :first-child {
  margin-top: 0;
}

#doehulahww .gt_from_md > :last-child {
  margin-bottom: 0;
}

#doehulahww .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#doehulahww .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#doehulahww .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#doehulahww .gt_row_group_first td {
  border-top-width: 2px;
}

#doehulahww .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#doehulahww .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#doehulahww .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#doehulahww .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#doehulahww .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#doehulahww .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#doehulahww .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#doehulahww .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#doehulahww .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#doehulahww .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#doehulahww .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#doehulahww .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#doehulahww .gt_left {
  text-align: left;
}

#doehulahww .gt_center {
  text-align: center;
}

#doehulahww .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#doehulahww .gt_font_normal {
  font-weight: normal;
}

#doehulahww .gt_font_bold {
  font-weight: bold;
}

#doehulahww .gt_font_italic {
  font-style: italic;
}

#doehulahww .gt_super {
  font-size: 65%;
}

#doehulahww .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#doehulahww .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#doehulahww .gt_indent_1 {
  text-indent: 5px;
}

#doehulahww .gt_indent_2 {
  text-indent: 10px;
}

#doehulahww .gt_indent_3 {
  text-indent: 15px;
}

#doehulahww .gt_indent_4 {
  text-indent: 20px;
}

#doehulahww .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Type de logement">Type de logement</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Effectif">Effectif</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Pourcentage">Pourcentage</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Type de logement" class="gt_row gt_center">Maison</td>
<td headers="Effectif" class="gt_row gt_right">11 260</td>
<td headers="Pourcentage" class="gt_row gt_right">0.8</td></tr>
    <tr><td headers="Type de logement" class="gt_row gt_center">Appartement</td>
<td headers="Effectif" class="gt_row gt_right">1 346 430</td>
<td headers="Pourcentage" class="gt_row gt_right">96.9</td></tr>
    <tr><td headers="Type de logement" class="gt_row gt_center">Autres</td>
<td headers="Effectif" class="gt_row gt_right">31 685</td>
<td headers="Pourcentage" class="gt_row gt_right">2.3</td></tr>
    <tr><td headers="Type de logement" class="gt_row gt_center">Total</td>
<td headers="Effectif" class="gt_row gt_right">1 389 375</td>
<td headers="Pourcentage" class="gt_row gt_right">100.0</td></tr>
  </tbody>
  
  
</table>
</div>
<div class="solution-exo">
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="05-Questions-fouille-donnees.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb76-2"><a href="05-Questions-fouille-donnees.html#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb76-3"><a href="05-Questions-fouille-donnees.html#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb76-4"><a href="05-Questions-fouille-donnees.html#cb76-4" aria-hidden="true" tabindex="-1"></a>RP <span class="sc">%&gt;%</span> </span>
<span id="cb76-5"><a href="05-Questions-fouille-donnees.html#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COMMUNE <span class="sc">==</span> <span class="st">&quot;75056&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-6"><a href="05-Questions-fouille-donnees.html#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(TYPL_moda, <span class="at">wt=</span>IPONDL) <span class="sc">%&gt;%</span> </span>
<span id="cb76-7"><a href="05-Questions-fouille-donnees.html#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pourcentage=</span><span class="fu">round</span>(<span class="fu">prop.table</span>(n)<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-8"><a href="05-Questions-fouille-donnees.html#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="st">&quot;row&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-9"><a href="05-Questions-fouille-donnees.html#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Effectif=</span>n, <span class="st">&#39;Type de logement&#39;</span><span class="ot">=</span>TYPL_moda) <span class="sc">%&gt;%</span> </span>
<span id="cb76-10"><a href="05-Questions-fouille-donnees.html#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-11"><a href="05-Questions-fouille-donnees.html#cb76-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="dv">2</span>, <span class="at">sep_mark =</span> <span class="st">&quot; &quot;</span>, <span class="at">decimals =</span> <span class="dv">0</span>)</span></code></pre></div>
</div>
<p>Non sans grande surprise, la commune de Paris est constituée en majorité d’appartements, presque 97%.</p>
<p>Cherchons maintenant la répartition des logements parisiens par type, est-ce plutôt des résidences principales ou secondaires ? combien y a-t-il de logements vacants ?</p>
<div id="seyyneyhox" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#seyyneyhox .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#seyyneyhox .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#seyyneyhox .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#seyyneyhox .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#seyyneyhox .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#seyyneyhox .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#seyyneyhox .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#seyyneyhox .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#seyyneyhox .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#seyyneyhox .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#seyyneyhox .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#seyyneyhox .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#seyyneyhox .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#seyyneyhox .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#seyyneyhox .gt_from_md > :first-child {
  margin-top: 0;
}

#seyyneyhox .gt_from_md > :last-child {
  margin-bottom: 0;
}

#seyyneyhox .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#seyyneyhox .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#seyyneyhox .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#seyyneyhox .gt_row_group_first td {
  border-top-width: 2px;
}

#seyyneyhox .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#seyyneyhox .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#seyyneyhox .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#seyyneyhox .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#seyyneyhox .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#seyyneyhox .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#seyyneyhox .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#seyyneyhox .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#seyyneyhox .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#seyyneyhox .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#seyyneyhox .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#seyyneyhox .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#seyyneyhox .gt_left {
  text-align: left;
}

#seyyneyhox .gt_center {
  text-align: center;
}

#seyyneyhox .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#seyyneyhox .gt_font_normal {
  font-weight: normal;
}

#seyyneyhox .gt_font_bold {
  font-weight: bold;
}

#seyyneyhox .gt_font_italic {
  font-style: italic;
}

#seyyneyhox .gt_super {
  font-size: 65%;
}

#seyyneyhox .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#seyyneyhox .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#seyyneyhox .gt_indent_1 {
  text-indent: 5px;
}

#seyyneyhox .gt_indent_2 {
  text-indent: 10px;
}

#seyyneyhox .gt_indent_3 {
  text-indent: 15px;
}

#seyyneyhox .gt_indent_4 {
  text-indent: 20px;
}

#seyyneyhox .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Catégorie de logement">Catégorie de logement</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Effectif">Effectif</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Pourcentage">Pourcentage</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Catégorie de logement" class="gt_row gt_center">Résidences principales</td>
<td headers="Effectif" class="gt_row gt_right">1 137 759</td>
<td headers="Pourcentage" class="gt_row gt_right">81.9</td></tr>
    <tr><td headers="Catégorie de logement" class="gt_row gt_center">Résidences secondaires</td>
<td headers="Effectif" class="gt_row gt_right">85 675</td>
<td headers="Pourcentage" class="gt_row gt_right">6.2</td></tr>
    <tr><td headers="Catégorie de logement" class="gt_row gt_center">Logements vacants</td>
<td headers="Effectif" class="gt_row gt_right">120 295</td>
<td headers="Pourcentage" class="gt_row gt_right">8.7</td></tr>
    <tr><td headers="Catégorie de logement" class="gt_row gt_center">Logements occasionnels</td>
<td headers="Effectif" class="gt_row gt_right">45 645</td>
<td headers="Pourcentage" class="gt_row gt_right">3.3</td></tr>
    <tr><td headers="Catégorie de logement" class="gt_row gt_center">Total</td>
<td headers="Effectif" class="gt_row gt_right">1 389 375</td>
<td headers="Pourcentage" class="gt_row gt_right">100.1</td></tr>
  </tbody>
  
  
</table>
</div>
<div class="solution-exo">
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="05-Questions-fouille-donnees.html#cb77-1" aria-hidden="true" tabindex="-1"></a>RP <span class="sc">%&gt;%</span> </span>
<span id="cb77-2"><a href="05-Questions-fouille-donnees.html#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COMMUNE <span class="sc">==</span> <span class="st">&quot;75056&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb77-3"><a href="05-Questions-fouille-donnees.html#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CATL_moda=</span><span class="fu">case_when</span>(CATL <span class="sc">==</span> <span class="st">&quot;1&quot;</span> <span class="sc">~</span> <span class="st">&quot;Résidences principales&quot;</span>,</span>
<span id="cb77-4"><a href="05-Questions-fouille-donnees.html#cb77-4" aria-hidden="true" tabindex="-1"></a>                             CATL <span class="sc">==</span> <span class="st">&quot;2&quot;</span> <span class="sc">~</span> <span class="st">&quot;Logements occasionnels&quot;</span>,</span>
<span id="cb77-5"><a href="05-Questions-fouille-donnees.html#cb77-5" aria-hidden="true" tabindex="-1"></a>                             CATL <span class="sc">==</span> <span class="st">&quot;3&quot;</span> <span class="sc">~</span> <span class="st">&quot;Résidences secondaires&quot;</span>,</span>
<span id="cb77-6"><a href="05-Questions-fouille-donnees.html#cb77-6" aria-hidden="true" tabindex="-1"></a>                             CATL <span class="sc">==</span> <span class="st">&quot;4&quot;</span> <span class="sc">~</span> <span class="st">&quot;Logements vacants&quot;</span>,</span>
<span id="cb77-7"><a href="05-Questions-fouille-donnees.html#cb77-7" aria-hidden="true" tabindex="-1"></a>                             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Autres&quot;</span>),</span>
<span id="cb77-8"><a href="05-Questions-fouille-donnees.html#cb77-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">CATL_moda=</span><span class="fu">fct_relevel</span>(CATL_moda, <span class="fu">c</span>(<span class="st">&quot;Résidences principales&quot;</span>, <span class="st">&quot;Résidences secondaires&quot;</span>,</span>
<span id="cb77-9"><a href="05-Questions-fouille-donnees.html#cb77-9" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">&quot;Logements vacants&quot;</span>, <span class="st">&quot;Logements occasionnels&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb77-10"><a href="05-Questions-fouille-donnees.html#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(CATL_moda, <span class="at">wt=</span>IPONDL) <span class="sc">%&gt;%</span> </span>
<span id="cb77-11"><a href="05-Questions-fouille-donnees.html#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pourcentage=</span><span class="fu">round</span>(<span class="fu">prop.table</span>(n)<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb77-12"><a href="05-Questions-fouille-donnees.html#cb77-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="st">&quot;row&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb77-13"><a href="05-Questions-fouille-donnees.html#cb77-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Effectif=</span>n, <span class="st">&#39;Catégorie de logement&#39;</span><span class="ot">=</span>CATL_moda) <span class="sc">%&gt;%</span> </span>
<span id="cb77-14"><a href="05-Questions-fouille-donnees.html#cb77-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb77-15"><a href="05-Questions-fouille-donnees.html#cb77-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="dv">2</span>, <span class="at">sep_mark =</span> <span class="st">&quot; &quot;</span>, <span class="at">decimals =</span> <span class="dv">0</span>)</span></code></pre></div>
</div>
<p>La plupart des logements parisiens sont des résidences principales (81,9%), alors que 6,2% sont des résidences secondaires ; à noter que la part des logements vacants n’est pas négligeable, elle s’élève à 8,7%.</p>
<p>Maintenant, affichons la seule colonne 2019 de ce tableau tiré de l’Insee , en mettant la ligne “Ensemble des résidences principales” plutôt en fin de tableau (ces 2 usages sont possibles, question de préférence…) ; attention au champ sur lequel porte ces moyennes…</p>
<img src="images/Nb%20moyen%20pieces%20des%20residences%20principales.png" />
<div class="solution-exo">
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="05-Questions-fouille-donnees.html#cb78-1" aria-hidden="true" tabindex="-1"></a>RP <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="05-Questions-fouille-donnees.html#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COMMUNE <span class="sc">==</span> <span class="st">&quot;75056&quot;</span> <span class="sc">&amp;</span> CATL<span class="sc">==</span> <span class="st">&quot;1&quot;</span> <span class="sc">&amp;</span> TYPL_moda <span class="sc">!=</span> <span class="st">&quot;Autres&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-3"><a href="05-Questions-fouille-donnees.html#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TYPL_moda) <span class="sc">%&gt;%</span></span>
<span id="cb78-4"><a href="05-Questions-fouille-donnees.html#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&#39;2019&#39;</span> <span class="ot">=</span> <span class="fu">weighted.mean</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(NBPI)), IPONDL, <span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span></span>
<span id="cb78-5"><a href="05-Questions-fouille-donnees.html#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">summarise</span>(<span class="at">TYPL_moda =</span> <span class="st">&quot;Ensemble des résidences principales&quot;</span>, </span>
<span id="cb78-6"><a href="05-Questions-fouille-donnees.html#cb78-6" aria-hidden="true" tabindex="-1"></a>                      RP[RP<span class="sc">$</span>COMMUNE <span class="sc">==</span> <span class="st">&quot;75056&quot;</span> <span class="sc">&amp;</span> RP<span class="sc">$</span>CATL <span class="sc">==</span> <span class="st">&quot;1&quot;</span> <span class="sc">&amp;</span> RP<span class="sc">$</span>TYPL_moda <span class="sc">!=</span> <span class="st">&quot;Autres&quot;</span>,], </span>
<span id="cb78-7"><a href="05-Questions-fouille-donnees.html#cb78-7" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&#39;2019&#39;</span>  <span class="ot">=</span> <span class="fu">weighted.mean</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(NBPI)), IPONDL, <span class="at">na.rm=</span>T))) <span class="sc">%&gt;%</span></span>
<span id="cb78-8"><a href="05-Questions-fouille-donnees.html#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39; &#39;</span> <span class="ot">=</span> TYPL_moda) <span class="sc">%&gt;%</span> </span>
<span id="cb78-9"><a href="05-Questions-fouille-donnees.html#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb78-10"><a href="05-Questions-fouille-donnees.html#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="dv">2</span>, <span class="at">dec_mark =</span> <span class="st">&quot;,&quot;</span>, <span class="at">decimals =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
<p>A Paris, sur les seules résidences principales, les maisons comportent plus de pièces que les appartements, presque 2 pièces de plus en moyenne. Etant donné que la majorité des logements est constituée par des appartements, la moyenne de l’ensemble des résidences principales est la même que celle des appartements.</p>
<p>Etudions maintenant les résidences principales et l’ancienneté d’emménagement selon le statut d’occupation. Attention, ici il faut procéder en plusieurs étapes : d’abord créer un tableau donnant la répartition en nombre et en pourcentage des ménages par statut d’occupation, puis créer un second tableau donnant la moyenne de l’ancienneté d’emménagement en années par statut d’occupation, puis fusionner ces deux tableaux.</p>
<div id="zmcnftgdwa" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#zmcnftgdwa .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zmcnftgdwa .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zmcnftgdwa .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zmcnftgdwa .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zmcnftgdwa .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zmcnftgdwa .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zmcnftgdwa .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zmcnftgdwa .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zmcnftgdwa .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zmcnftgdwa .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zmcnftgdwa .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zmcnftgdwa .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zmcnftgdwa .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zmcnftgdwa .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zmcnftgdwa .gt_from_md > :first-child {
  margin-top: 0;
}

#zmcnftgdwa .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zmcnftgdwa .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zmcnftgdwa .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zmcnftgdwa .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zmcnftgdwa .gt_row_group_first td {
  border-top-width: 2px;
}

#zmcnftgdwa .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zmcnftgdwa .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zmcnftgdwa .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zmcnftgdwa .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zmcnftgdwa .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zmcnftgdwa .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zmcnftgdwa .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zmcnftgdwa .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zmcnftgdwa .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zmcnftgdwa .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zmcnftgdwa .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zmcnftgdwa .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zmcnftgdwa .gt_left {
  text-align: left;
}

#zmcnftgdwa .gt_center {
  text-align: center;
}

#zmcnftgdwa .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zmcnftgdwa .gt_font_normal {
  font-weight: normal;
}

#zmcnftgdwa .gt_font_bold {
  font-weight: bold;
}

#zmcnftgdwa .gt_font_italic {
  font-style: italic;
}

#zmcnftgdwa .gt_super {
  font-size: 65%;
}

#zmcnftgdwa .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#zmcnftgdwa .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zmcnftgdwa .gt_indent_1 {
  text-indent: 5px;
}

#zmcnftgdwa .gt_indent_2 {
  text-indent: 10px;
}

#zmcnftgdwa .gt_indent_3 {
  text-indent: 15px;
}

#zmcnftgdwa .gt_indent_4 {
  text-indent: 20px;
}

#zmcnftgdwa .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Statut d'occupation">Statut d'occupation</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Nombre">Nombre</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Pourcentage">Pourcentage</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Ancienneté moyenne d'emménagement en année(s)">Ancienneté moyenne d'emménagement en année(s)</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Statut d'occupation" class="gt_row gt_left">Propriétaire</td>
<td headers="Nombre" class="gt_row gt_right">379 745</td>
<td headers="Pourcentage" class="gt_row gt_right">33.4</td>
<td headers="Ancienneté moyenne d'emménagement en année(s)" class="gt_row gt_right">18.2</td></tr>
    <tr><td headers="Statut d'occupation" class="gt_row gt_left">Locataire</td>
<td headers="Nombre" class="gt_row gt_right">701 943</td>
<td headers="Pourcentage" class="gt_row gt_right">61.7</td>
<td headers="Ancienneté moyenne d'emménagement en année(s)" class="gt_row gt_right">10.3</td></tr>
    <tr><td headers="Statut d'occupation" class="gt_row gt_left">Logé gratuitement</td>
<td headers="Nombre" class="gt_row gt_right">56 071</td>
<td headers="Pourcentage" class="gt_row gt_right">4.9</td>
<td headers="Ancienneté moyenne d'emménagement en année(s)" class="gt_row gt_right">10.4</td></tr>
    <tr><td headers="Statut d'occupation" class="gt_row gt_left">Total</td>
<td headers="Nombre" class="gt_row gt_right">1 137 759</td>
<td headers="Pourcentage" class="gt_row gt_right">100.0</td>
<td headers="Ancienneté moyenne d'emménagement en année(s)" class="gt_row gt_right">13.0</td></tr>
  </tbody>
  
  
</table>
</div>
<div class="solution-exo">
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="05-Questions-fouille-donnees.html#cb79-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> RP <span class="sc">%&gt;%</span> </span>
<span id="cb79-2"><a href="05-Questions-fouille-donnees.html#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COMMUNE <span class="sc">==</span> <span class="st">&quot;75056&quot;</span> <span class="sc">&amp;</span> CATL<span class="sc">==</span><span class="st">&quot;1&quot;</span> <span class="sc">&amp;</span> STOCD <span class="sc">!=</span> <span class="st">&quot;0&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb79-3"><a href="05-Questions-fouille-donnees.html#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">st_occupation=</span><span class="fu">case_when</span>(STOCD<span class="sc">==</span><span class="st">&quot;10&quot;</span> <span class="sc">~</span> <span class="st">&quot;Propriétaire&quot;</span>,</span>
<span id="cb79-4"><a href="05-Questions-fouille-donnees.html#cb79-4" aria-hidden="true" tabindex="-1"></a>                                 STOCD <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;21&quot;</span>,<span class="st">&quot;22&quot;</span>,<span class="st">&quot;23&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Locataire&quot;</span>,</span>
<span id="cb79-5"><a href="05-Questions-fouille-donnees.html#cb79-5" aria-hidden="true" tabindex="-1"></a>                                 STOCD<span class="sc">==</span><span class="st">&quot;30&quot;</span> <span class="sc">~</span> <span class="st">&quot;Logé gratuitement&quot;</span>),</span>
<span id="cb79-6"><a href="05-Questions-fouille-donnees.html#cb79-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">st_occupation=</span><span class="fu">fct_relevel</span>(st_occupation, <span class="fu">c</span>(<span class="st">&quot;Propriétaire&quot;</span>, </span>
<span id="cb79-7"><a href="05-Questions-fouille-donnees.html#cb79-7" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">&quot;Locataire&quot;</span>,</span>
<span id="cb79-8"><a href="05-Questions-fouille-donnees.html#cb79-8" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">&quot;Logé gratuitement&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb79-9"><a href="05-Questions-fouille-donnees.html#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(st_occupation, <span class="at">wt=</span>IPONDL) <span class="sc">%&gt;%</span> </span>
<span id="cb79-10"><a href="05-Questions-fouille-donnees.html#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pourcentage=</span><span class="fu">round</span>(<span class="fu">prop.table</span>(n)<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb79-11"><a href="05-Questions-fouille-donnees.html#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="st">&quot;row&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb79-12"><a href="05-Questions-fouille-donnees.html#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Nombre=</span>n) </span>
<span id="cb79-13"><a href="05-Questions-fouille-donnees.html#cb79-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-14"><a href="05-Questions-fouille-donnees.html#cb79-14" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> RP <span class="sc">%&gt;%</span></span>
<span id="cb79-15"><a href="05-Questions-fouille-donnees.html#cb79-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COMMUNE <span class="sc">==</span> <span class="st">&quot;75056&quot;</span> <span class="sc">&amp;</span> CATL<span class="sc">==</span><span class="st">&quot;1&quot;</span> <span class="sc">&amp;</span> <span class="sc">!</span>STOCD <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;ZZ&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb79-16"><a href="05-Questions-fouille-donnees.html#cb79-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">st_occupation=</span><span class="fu">case_when</span>(STOCD<span class="sc">==</span><span class="st">&quot;10&quot;</span> <span class="sc">~</span> <span class="st">&quot;Propriétaire&quot;</span>,</span>
<span id="cb79-17"><a href="05-Questions-fouille-donnees.html#cb79-17" aria-hidden="true" tabindex="-1"></a>                                 STOCD <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;21&quot;</span>,<span class="st">&quot;22&quot;</span>,<span class="st">&quot;23&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Locataire&quot;</span>,</span>
<span id="cb79-18"><a href="05-Questions-fouille-donnees.html#cb79-18" aria-hidden="true" tabindex="-1"></a>                                 STOCD<span class="sc">==</span><span class="st">&quot;30&quot;</span> <span class="sc">~</span> <span class="st">&quot;Logé gratuitement&quot;</span>),</span>
<span id="cb79-19"><a href="05-Questions-fouille-donnees.html#cb79-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">st_occupation=</span><span class="fu">fct_relevel</span>(st_occupation, <span class="fu">c</span>(<span class="st">&quot;Propriétaire&quot;</span>, </span>
<span id="cb79-20"><a href="05-Questions-fouille-donnees.html#cb79-20" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">&quot;Locataire&quot;</span>,</span>
<span id="cb79-21"><a href="05-Questions-fouille-donnees.html#cb79-21" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">&quot;Logé gratuitement&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb79-22"><a href="05-Questions-fouille-donnees.html#cb79-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(st_occupation) <span class="sc">%&gt;%</span></span>
<span id="cb79-23"><a href="05-Questions-fouille-donnees.html#cb79-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">anc_moy =</span> <span class="fu">weighted.mean</span>(ANEM, IPONDL, <span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span></span>
<span id="cb79-24"><a href="05-Questions-fouille-donnees.html#cb79-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">summarise</span>(<span class="at">st_occupation =</span> <span class="st">&quot;Total&quot;</span>, RP[RP<span class="sc">$</span>COMMUNE <span class="sc">==</span> <span class="st">&quot;75056&quot;</span> <span class="sc">&amp;</span> RP<span class="sc">$</span>CATL<span class="sc">==</span><span class="st">&quot;1&quot;</span> <span class="sc">&amp;</span> <span class="sc">!</span>RP<span class="sc">$</span>STOCD <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;ZZ&quot;</span>),], </span>
<span id="cb79-25"><a href="05-Questions-fouille-donnees.html#cb79-25" aria-hidden="true" tabindex="-1"></a>                      <span class="at">anc_moy =</span> <span class="fu">weighted.mean</span>(ANEM, IPONDL, <span class="at">na.rm=</span>T))) <span class="sc">%&gt;%</span></span>
<span id="cb79-26"><a href="05-Questions-fouille-donnees.html#cb79-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">anc_moy=</span><span class="fu">round</span>(anc_moy, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb79-27"><a href="05-Questions-fouille-donnees.html#cb79-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&quot;Ancienneté moyenne d&#39;emménagement en année(s)&quot;</span><span class="ot">=</span>anc_moy)</span>
<span id="cb79-28"><a href="05-Questions-fouille-donnees.html#cb79-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-29"><a href="05-Questions-fouille-donnees.html#cb79-29" aria-hidden="true" tabindex="-1"></a>t1 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(t2, <span class="at">by=</span><span class="fu">join_by</span>(st_occupation)) <span class="sc">%&gt;%</span> </span>
<span id="cb79-30"><a href="05-Questions-fouille-donnees.html#cb79-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&quot;Statut d&#39;occupation&quot;</span><span class="ot">=</span>st_occupation) <span class="sc">%&gt;%</span> </span>
<span id="cb79-31"><a href="05-Questions-fouille-donnees.html#cb79-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()  <span class="sc">%&gt;%</span> </span>
<span id="cb79-32"><a href="05-Questions-fouille-donnees.html#cb79-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="dv">2</span>, <span class="at">sep_mark =</span> <span class="st">&quot; &quot;</span>, <span class="at">decimals =</span> <span class="dv">0</span>)</span></code></pre></div>
</div>
<p>Il y a donc 1/3 de propriétaires à Paris quand on se concentre sur les résidences principales, et les propriétaires y sont présents depuis plus longtemps que les locataires : 18,2 ans en moyenne contre 10,3 ans.</p>
<p>Enfin, on peut vouloir comparer la moyenne des pièces des appartements parisiens par arrondissement par exemple.</p>
<div id="cjyxzevxgx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#cjyxzevxgx .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cjyxzevxgx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cjyxzevxgx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cjyxzevxgx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cjyxzevxgx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cjyxzevxgx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cjyxzevxgx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cjyxzevxgx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cjyxzevxgx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cjyxzevxgx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cjyxzevxgx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cjyxzevxgx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cjyxzevxgx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cjyxzevxgx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cjyxzevxgx .gt_from_md > :first-child {
  margin-top: 0;
}

#cjyxzevxgx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cjyxzevxgx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cjyxzevxgx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cjyxzevxgx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cjyxzevxgx .gt_row_group_first td {
  border-top-width: 2px;
}

#cjyxzevxgx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cjyxzevxgx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cjyxzevxgx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cjyxzevxgx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cjyxzevxgx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cjyxzevxgx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cjyxzevxgx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cjyxzevxgx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cjyxzevxgx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cjyxzevxgx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cjyxzevxgx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cjyxzevxgx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cjyxzevxgx .gt_left {
  text-align: left;
}

#cjyxzevxgx .gt_center {
  text-align: center;
}

#cjyxzevxgx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cjyxzevxgx .gt_font_normal {
  font-weight: normal;
}

#cjyxzevxgx .gt_font_bold {
  font-weight: bold;
}

#cjyxzevxgx .gt_font_italic {
  font-style: italic;
}

#cjyxzevxgx .gt_super {
  font-size: 65%;
}

#cjyxzevxgx .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#cjyxzevxgx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cjyxzevxgx .gt_indent_1 {
  text-indent: 5px;
}

#cjyxzevxgx .gt_indent_2 {
  text-indent: 10px;
}

#cjyxzevxgx .gt_indent_3 {
  text-indent: 15px;
}

#cjyxzevxgx .gt_indent_4 {
  text-indent: 20px;
}

#cjyxzevxgx .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Arrondissement">Arrondissement</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Nombre moyen de pièces">Nombre moyen de pièces</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Arrondissement" class="gt_row gt_left">75101</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">2,6</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">75102</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">2,4</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">75103</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">2,4</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">75104</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">2,6</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">75105</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">2,6</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">75106</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">2,8</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">75107</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">3,0</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">75108</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">3,2</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">75109</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">2,7</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">75110</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">2,5</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">75111</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">2,3</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">75112</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">2,5</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">75113</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">2,6</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">75114</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">2,6</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">75115</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">2,6</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">75116</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">3,2</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">75117</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">2,7</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">75118</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">2,3</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">75119</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">2,6</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">75120</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">2,5</td></tr>
    <tr><td headers="Arrondissement" class="gt_row gt_left">Ensemble des appartements</td>
<td headers="Nombre moyen de pièces" class="gt_row gt_right">2,2</td></tr>
  </tbody>
  
  
</table>
</div>
<div class="solution-exo">
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="05-Questions-fouille-donnees.html#cb80-1" aria-hidden="true" tabindex="-1"></a>RP <span class="sc">%&gt;%</span> </span>
<span id="cb80-2"><a href="05-Questions-fouille-donnees.html#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COMMUNE <span class="sc">==</span> <span class="st">&quot;75056&quot;</span> <span class="sc">&amp;</span> CATL<span class="sc">==</span> <span class="st">&quot;1&quot;</span> <span class="sc">&amp;</span> TYPL_moda <span class="sc">==</span> <span class="st">&quot;Appartement&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-3"><a href="05-Questions-fouille-donnees.html#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ARM) <span class="sc">%&gt;%</span></span>
<span id="cb80-4"><a href="05-Questions-fouille-donnees.html#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Moy_pieces =</span> <span class="fu">weighted.mean</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(NBPI)), IPONDL, <span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span></span>
<span id="cb80-5"><a href="05-Questions-fouille-donnees.html#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">summarise</span>(<span class="at">ARM =</span> <span class="st">&quot;Ensemble des appartements&quot;</span>, </span>
<span id="cb80-6"><a href="05-Questions-fouille-donnees.html#cb80-6" aria-hidden="true" tabindex="-1"></a>                      RP[RP<span class="sc">$</span>COMMUNE <span class="sc">==</span> <span class="st">&quot;75056&quot;</span> <span class="sc">&amp;</span> RP<span class="sc">$</span>CATL <span class="sc">==</span> <span class="st">&quot;1&quot;</span> <span class="sc">&amp;</span> RP<span class="sc">$</span>TYPL_moda <span class="sc">!=</span> <span class="st">&quot;Appartement&quot;</span>,], </span>
<span id="cb80-7"><a href="05-Questions-fouille-donnees.html#cb80-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Moy_pieces =</span> <span class="fu">weighted.mean</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(NBPI)), IPONDL, <span class="at">na.rm=</span>T))) <span class="sc">%&gt;%</span></span>
<span id="cb80-8"><a href="05-Questions-fouille-donnees.html#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Arrondissement=</span>ARM, <span class="st">&#39;Nombre moyen de pièces&#39;</span><span class="ot">=</span>Moy_pieces) <span class="sc">%&gt;%</span> </span>
<span id="cb80-9"><a href="05-Questions-fouille-donnees.html#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb80-10"><a href="05-Questions-fouille-donnees.html#cb80-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="dv">2</span>, <span class="at">dec_mark =</span> <span class="st">&quot;,&quot;</span>, <span class="at">decimals =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
<p>Ainsi, si l’on veut créer des tableaux de répartition à une seule variable, on peut utiliser ces procédures qui se structurent toujours de la même façon. Au lieu de faire un copié-collé du code et de changer le nom des variables, autrement dit pour systématiser nos procédures, une astuce est de créer ses propres fonctions. C’est ce que nous allons étudier maintenant.</p>
</div>
<div id="systématiser-nos-procédures-construire-une-fonction" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Systématiser nos procédures : construire une fonction<a href="05-Questions-fouille-donnees.html#systématiser-nos-procédures-construire-une-fonction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div align="justify">

<p>Pour ré-utiliser un code de façon plus automatique, créer des fonctions est très utile (et on peut même les stocker dans un fichier <code>.r</code> pour les réutiliser plus tard pour une autre étude).</p>
<p>L’idée est qu’à partir d’un bloc d’instructions ou de lignes de codes, on l’intègre dans une fonction qui portera un nom et qui pourra être appliquée sur les paramètres que l’on veut (table/objet différent, variables différentes) et qui nous retournera une valeur en sortie (qu’il faut préciser donc). Par exemple :</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="05-Questions-fouille-donnees.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemple fonction avec 3 arguments</span></span>
<span id="cb81-2"><a href="05-Questions-fouille-donnees.html#cb81-2" aria-hidden="true" tabindex="-1"></a>nom_fonction <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var1, var2) {</span>
<span id="cb81-3"><a href="05-Questions-fouille-donnees.html#cb81-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-4"><a href="05-Questions-fouille-donnees.html#cb81-4" aria-hidden="true" tabindex="-1"></a>  expression...  <span class="co"># Ce que la fonction fait</span></span>
<span id="cb81-5"><a href="05-Questions-fouille-donnees.html#cb81-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-6"><a href="05-Questions-fouille-donnees.html#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>()  <span class="co"># Optionnel, mais la plupart du temps utilisé (!), </span></span>
<span id="cb81-7"><a href="05-Questions-fouille-donnees.html#cb81-7" aria-hidden="true" tabindex="-1"></a>               <span class="co"># pour sortir le résultat de la fonction</span></span>
<span id="cb81-8"><a href="05-Questions-fouille-donnees.html#cb81-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-9"><a href="05-Questions-fouille-donnees.html#cb81-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-10"><a href="05-Questions-fouille-donnees.html#cb81-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-11"><a href="05-Questions-fouille-donnees.html#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="co"># L&#39;appel de la fonction devra ainsi préciser la table de données sur laquelle </span></span>
<span id="cb81-12"><a href="05-Questions-fouille-donnees.html#cb81-12" aria-hidden="true" tabindex="-1"></a><span class="co"># l&#39;appliquer et les autres arguments : </span></span>
<span id="cb81-13"><a href="05-Questions-fouille-donnees.html#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="fu">nom_fonction</span>(<span class="at">data =</span> nom_de_ma_table , <span class="at">var1 =</span> nom_de_ma_variable1,  </span>
<span id="cb81-14"><a href="05-Questions-fouille-donnees.html#cb81-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">var2 =</span> nom_de_ma_variable2)</span>
<span id="cb81-15"><a href="05-Questions-fouille-donnees.html#cb81-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-16"><a href="05-Questions-fouille-donnees.html#cb81-16" aria-hidden="true" tabindex="-1"></a><span class="co"># De plus, on pourra créer un nouvel objet (ici &quot;tab_var&quot;) pour stocker la table </span></span>
<span id="cb81-17"><a href="05-Questions-fouille-donnees.html#cb81-17" aria-hidden="true" tabindex="-1"></a><span class="co"># qui est en valeur de sortie de la fonction : </span></span>
<span id="cb81-18"><a href="05-Questions-fouille-donnees.html#cb81-18" aria-hidden="true" tabindex="-1"></a>tab_var <span class="ot">&lt;-</span> <span class="fu">nom_fonction</span>(<span class="at">data =</span> nom_de_ma_table , <span class="at">var1 =</span> nom_de_ma_variable1,</span>
<span id="cb81-19"><a href="05-Questions-fouille-donnees.html#cb81-19" aria-hidden="true" tabindex="-1"></a>                        <span class="at">var2 =</span> nom_de_ma_variable2)</span></code></pre></div>
<p>Les arguments doivent donc être précisés en entrée de notre fonction, si on ne les précise pas cela nous retournera une erreur… à moins que l’on ait spécifié des valeurs par défaut (ce qui peut être utile si on utilise souvent les mêmes paramètres, par exemple la même base de données) ; il peut y avoir autant d’arguments que l’on souhaite.</p>
<p>Si l’on utilise le langage tidyverse, il faut connaître quelques petits “trucs” pour écrire une fonction. Le schéma suivant réalisé par Julien Barnier du CNRS nous sera très utile.</p>
<div class="figure">
<img src="images/Schéma%20tidyverse%20functions_Julien%20Barnier.jpg" alt="" />
<p class="caption">Pour une fonction utilisant le langage tidyverse</p>
</div>
<div align="center">
<p><em>Source</em> : Julien Barnier, <a href="https://twitter.com/lapply/status/1493908215796535296?s=20&t=p4aYIEV4GsGS3TGftPa0Nw" target="_blank">https://twitter.com/lapply/status/1493908215796535296?s=20&amp;t=p4aYIEV4GsGS3TGftPa0Nw</a>.</p>
<div align="justify">
<p>Vous trouverez également des informations utiles <a href="https://thinkr.fr/comment-creer-des-fonctions-dans-le-tidyverse-avec-la-tidyeval-et-le-stash-stash/" target="_blank">ici</a> ou <a href="https://www.vishalkatti.com/posts/2021-07-17-programmingwithdplyr/" target="_blank">là</a>.</p>
<p>On peut d’abord créer une fonction reprenant le code précédent pour la construction de tableau. On l’appelle <code>tableau</code>, et on lui donne comme arguments “data”, “filtre_com”, “var_quali”, “pond” et “nom_var_quali”.</p>
<p>Dans le langage tidyverse, au sein d’une fonction, il faut appeler une variable avec des doubles-accolades <code>{{  }}</code>.</p>
<p>Si l’on utilise une fonction <code>summarise()</code>, une autre subtilité à connaître est que cette syntaxe <code>summarise({{ nom_var }} = mean({{ var }}, na.rm=TRUE))</code> ne sera pas reconnue, car il faut indiquer non pas un “=” mais un “:=” pour que la fonction puisse être lue lorsque le nom donné à la variable est de type caractère ou “string”.</p>
<p>Enfin, il ne faut pas oublier de retourner un objet en sortie avec <code>return()</code>.</p>
<p>Essayez donc de créer une fonction <code>tableau()</code>, reprenant le premier code de la section précédente et remise ci-dessous pour information :</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="05-Questions-fouille-donnees.html#cb82-1" aria-hidden="true" tabindex="-1"></a>RP <span class="sc">%&gt;%</span> </span>
<span id="cb82-2"><a href="05-Questions-fouille-donnees.html#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COMMUNE <span class="sc">==</span> <span class="st">&quot;75056&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-3"><a href="05-Questions-fouille-donnees.html#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(TYPL_moda, <span class="at">wt=</span>IPONDL) <span class="sc">%&gt;%</span> </span>
<span id="cb82-4"><a href="05-Questions-fouille-donnees.html#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pourcentage=</span><span class="fu">prop.table</span>(n)<span class="sc">*</span><span class="dv">100</span>, <span class="at">Pourcentage=</span><span class="fu">round</span>(Pourcentage, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-5"><a href="05-Questions-fouille-donnees.html#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="st">&quot;row&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-6"><a href="05-Questions-fouille-donnees.html#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Effectif=</span>n, <span class="st">&#39;Type de logement&#39;</span><span class="ot">=</span>TYPL_moda) <span class="sc">%&gt;%</span> </span>
<span id="cb82-7"><a href="05-Questions-fouille-donnees.html#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb82-8"><a href="05-Questions-fouille-donnees.html#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="dv">2</span>, <span class="at">sep_mark =</span> <span class="st">&quot; &quot;</span>, <span class="at">decimals =</span> <span class="dv">0</span>)</span></code></pre></div>
<div id="dclhvabrwr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#dclhvabrwr .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dclhvabrwr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dclhvabrwr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dclhvabrwr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dclhvabrwr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dclhvabrwr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dclhvabrwr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dclhvabrwr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dclhvabrwr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dclhvabrwr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dclhvabrwr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dclhvabrwr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dclhvabrwr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dclhvabrwr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dclhvabrwr .gt_from_md > :first-child {
  margin-top: 0;
}

#dclhvabrwr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dclhvabrwr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dclhvabrwr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dclhvabrwr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dclhvabrwr .gt_row_group_first td {
  border-top-width: 2px;
}

#dclhvabrwr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dclhvabrwr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dclhvabrwr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dclhvabrwr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dclhvabrwr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dclhvabrwr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dclhvabrwr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dclhvabrwr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dclhvabrwr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dclhvabrwr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dclhvabrwr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dclhvabrwr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dclhvabrwr .gt_left {
  text-align: left;
}

#dclhvabrwr .gt_center {
  text-align: center;
}

#dclhvabrwr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dclhvabrwr .gt_font_normal {
  font-weight: normal;
}

#dclhvabrwr .gt_font_bold {
  font-weight: bold;
}

#dclhvabrwr .gt_font_italic {
  font-style: italic;
}

#dclhvabrwr .gt_super {
  font-size: 65%;
}

#dclhvabrwr .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#dclhvabrwr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dclhvabrwr .gt_indent_1 {
  text-indent: 5px;
}

#dclhvabrwr .gt_indent_2 {
  text-indent: 10px;
}

#dclhvabrwr .gt_indent_3 {
  text-indent: 15px;
}

#dclhvabrwr .gt_indent_4 {
  text-indent: 20px;
}

#dclhvabrwr .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Type de logement">Type de logement</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Effectif">Effectif</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Pourcentage">Pourcentage</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Type de logement" class="gt_row gt_center">Maison</td>
<td headers="Effectif" class="gt_row gt_right">11 260</td>
<td headers="Pourcentage" class="gt_row gt_right">0.8</td></tr>
    <tr><td headers="Type de logement" class="gt_row gt_center">Appartement</td>
<td headers="Effectif" class="gt_row gt_right">1 346 430</td>
<td headers="Pourcentage" class="gt_row gt_right">96.9</td></tr>
    <tr><td headers="Type de logement" class="gt_row gt_center">Autres</td>
<td headers="Effectif" class="gt_row gt_right">31 685</td>
<td headers="Pourcentage" class="gt_row gt_right">2.3</td></tr>
    <tr><td headers="Type de logement" class="gt_row gt_center">Total</td>
<td headers="Effectif" class="gt_row gt_right">1 389 375</td>
<td headers="Pourcentage" class="gt_row gt_right">100.0</td></tr>
  </tbody>
  
  
</table>
</div>
<div class="solution-exo">
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="05-Questions-fouille-donnees.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tidyverse)</span></span>
<span id="cb83-2"><a href="05-Questions-fouille-donnees.html#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(janitor)</span></span>
<span id="cb83-3"><a href="05-Questions-fouille-donnees.html#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(gt)</span></span>
<span id="cb83-4"><a href="05-Questions-fouille-donnees.html#cb83-4" aria-hidden="true" tabindex="-1"></a>tableau <span class="ot">&lt;-</span> <span class="cf">function</span>(data, filtre_com, var_quali, <span class="at">pond=</span>IPONDL, nom_var_quali){</span>
<span id="cb83-5"><a href="05-Questions-fouille-donnees.html#cb83-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-6"><a href="05-Questions-fouille-donnees.html#cb83-6" aria-hidden="true" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb83-7"><a href="05-Questions-fouille-donnees.html#cb83-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(COMMUNE <span class="sc">==</span> filtre_com) <span class="sc">%&gt;%</span> </span>
<span id="cb83-8"><a href="05-Questions-fouille-donnees.html#cb83-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>({{ var_quali }}, <span class="at">wt=</span>{{ pond }}) <span class="sc">%&gt;%</span> </span>
<span id="cb83-9"><a href="05-Questions-fouille-donnees.html#cb83-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Pourcentage=</span><span class="fu">prop.table</span>(n)<span class="sc">*</span><span class="dv">100</span>, <span class="at">Pourcentage=</span><span class="fu">round</span>(Pourcentage, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb83-10"><a href="05-Questions-fouille-donnees.html#cb83-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_totals</span>(<span class="st">&quot;row&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb83-11"><a href="05-Questions-fouille-donnees.html#cb83-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Effectif=</span>n, {{nom_var_quali}}<span class="sc">:</span><span class="er">=</span>{{ var_quali }}) </span>
<span id="cb83-12"><a href="05-Questions-fouille-donnees.html#cb83-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-13"><a href="05-Questions-fouille-donnees.html#cb83-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tab)</span>
<span id="cb83-14"><a href="05-Questions-fouille-donnees.html#cb83-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-15"><a href="05-Questions-fouille-donnees.html#cb83-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p>On peut vérifier qu’on obtient bien la même chose :</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="05-Questions-fouille-donnees.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tableau</span>(<span class="at">data=</span>RP, <span class="at">filtre_com=</span><span class="st">&quot;75056&quot;</span>, <span class="at">var_quali=</span>TYPL_moda, <span class="at">nom_var_quali=</span><span class="st">&quot;Type de logement&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb84-2"><a href="05-Questions-fouille-donnees.html#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb84-3"><a href="05-Questions-fouille-donnees.html#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="dv">2</span>, <span class="at">sep_mark =</span> <span class="st">&quot; &quot;</span>, <span class="at">decimals =</span> <span class="dv">0</span>)</span></code></pre></div>
<div id="oyofultpvx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#oyofultpvx .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#oyofultpvx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oyofultpvx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#oyofultpvx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#oyofultpvx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#oyofultpvx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oyofultpvx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oyofultpvx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#oyofultpvx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#oyofultpvx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#oyofultpvx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#oyofultpvx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#oyofultpvx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#oyofultpvx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#oyofultpvx .gt_from_md > :first-child {
  margin-top: 0;
}

#oyofultpvx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#oyofultpvx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#oyofultpvx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#oyofultpvx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#oyofultpvx .gt_row_group_first td {
  border-top-width: 2px;
}

#oyofultpvx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oyofultpvx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#oyofultpvx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#oyofultpvx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oyofultpvx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oyofultpvx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#oyofultpvx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#oyofultpvx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oyofultpvx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oyofultpvx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oyofultpvx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oyofultpvx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oyofultpvx .gt_left {
  text-align: left;
}

#oyofultpvx .gt_center {
  text-align: center;
}

#oyofultpvx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#oyofultpvx .gt_font_normal {
  font-weight: normal;
}

#oyofultpvx .gt_font_bold {
  font-weight: bold;
}

#oyofultpvx .gt_font_italic {
  font-style: italic;
}

#oyofultpvx .gt_super {
  font-size: 65%;
}

#oyofultpvx .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#oyofultpvx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#oyofultpvx .gt_indent_1 {
  text-indent: 5px;
}

#oyofultpvx .gt_indent_2 {
  text-indent: 10px;
}

#oyofultpvx .gt_indent_3 {
  text-indent: 15px;
}

#oyofultpvx .gt_indent_4 {
  text-indent: 20px;
}

#oyofultpvx .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Type de logement">Type de logement</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Effectif">Effectif</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Pourcentage">Pourcentage</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Type de logement" class="gt_row gt_center">Maison</td>
<td headers="Effectif" class="gt_row gt_right">11 260</td>
<td headers="Pourcentage" class="gt_row gt_right">0.8</td></tr>
    <tr><td headers="Type de logement" class="gt_row gt_center">Appartement</td>
<td headers="Effectif" class="gt_row gt_right">1 346 430</td>
<td headers="Pourcentage" class="gt_row gt_right">96.9</td></tr>
    <tr><td headers="Type de logement" class="gt_row gt_center">Autres</td>
<td headers="Effectif" class="gt_row gt_right">31 685</td>
<td headers="Pourcentage" class="gt_row gt_right">2.3</td></tr>
    <tr><td headers="Type de logement" class="gt_row gt_center">Total</td>
<td headers="Effectif" class="gt_row gt_right">1 389 375</td>
<td headers="Pourcentage" class="gt_row gt_right">100.0</td></tr>
  </tbody>
  
  
</table>
</div>
<!--Et on peut tester cette fonction, par exemple pour calculer la proposition de logements HLM parmi les résidences principales dans Paris :  -->
<p>Essayez d’écrire une seconde fonction <code>somme()</code> permettant de systématiser le code suivant qui donne un tableau de contingence du nombre de propriétaires par IRIS (cela nous servira pour plus tard…), en ajoutant une fonction de filtre qui peut contenir plusieurs variables. Pour cela, on va utiliser l’argument “…” (lire “dot”) : cet argument est très pratique si l’on ne sait pas combien il y aura de variable(s) dans la fonction à laquelle elle s’applique, c’est-à-dire autant 0 variable, 1 variable ou plus d’une variable ; mais elle peut aussi être “dangereuse” si on ne se souvient plus qu’on l’a créée et/ou si on ne fait pas attention à bien remplir les autres arguments avec les noms correspondants.</p>
<p>On va également introduire la fonction <code>group_by()</code> pour avoir les tableaux de contingence par IRIS.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="05-Questions-fouille-donnees.html#cb85-1" aria-hidden="true" tabindex="-1"></a>RP <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="05-Questions-fouille-donnees.html#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COMMUNE <span class="sc">==</span> <span class="st">&quot;75056&quot;</span> <span class="sc">&amp;</span> STOCD <span class="sc">==</span> <span class="st">&quot;10&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="05-Questions-fouille-donnees.html#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(IRIS) <span class="sc">%&gt;%</span></span>
<span id="cb85-4"><a href="05-Questions-fouille-donnees.html#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">nb_proprietaires =</span> <span class="fu">sum</span>(IPONDL)) <span class="sc">%&gt;%</span> </span>
<span id="cb85-5"><a href="05-Questions-fouille-donnees.html#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nb_proprietaires=</span><span class="fu">round</span>(nb_proprietaires, <span class="dv">0</span>))</span></code></pre></div>
<pre><code># A tibble: 917 x 2
   IRIS      nb_proprietaires
   &lt;fct&gt;                &lt;dbl&gt;
 1 751010101              107
 2 751010102               52
 3 751010103               35
 4 751010201              472
 5 751010202              302
 6 751010203              511
 7 751010204              328
 8 751010206               95
 9 751010301              584
10 751010302               34
# i 907 more rows</code></pre>
<div class="solution-exo">
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="05-Questions-fouille-donnees.html#cb87-1" aria-hidden="true" tabindex="-1"></a>somme <span class="ot">&lt;-</span> <span class="cf">function</span>(data, ..., var_gpe, nom_var, var1){</span>
<span id="cb87-2"><a href="05-Questions-fouille-donnees.html#cb87-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-3"><a href="05-Questions-fouille-donnees.html#cb87-3" aria-hidden="true" tabindex="-1"></a>  som_1 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb87-4"><a href="05-Questions-fouille-donnees.html#cb87-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(...) <span class="sc">%&gt;%</span> </span>
<span id="cb87-5"><a href="05-Questions-fouille-donnees.html#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>({{var_gpe}}) <span class="sc">%&gt;%</span> </span>
<span id="cb87-6"><a href="05-Questions-fouille-donnees.html#cb87-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>({{nom_var}}<span class="sc">:</span><span class="er">=</span><span class="fu">sum</span>({{var1}}, <span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-7"><a href="05-Questions-fouille-donnees.html#cb87-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>({{nom_var}}<span class="sc">:</span><span class="er">=</span><span class="fu">round</span>({{nom_var}}, <span class="dv">0</span>))</span>
<span id="cb87-8"><a href="05-Questions-fouille-donnees.html#cb87-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-9"><a href="05-Questions-fouille-donnees.html#cb87-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(som_1)</span>
<span id="cb87-10"><a href="05-Questions-fouille-donnees.html#cb87-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-11"><a href="05-Questions-fouille-donnees.html#cb87-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p>Vérifions :</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="05-Questions-fouille-donnees.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">somme</span>(<span class="at">data=</span>RP, COMMUNE <span class="sc">==</span> <span class="st">&quot;75056&quot;</span> <span class="sc">&amp;</span> STOCD <span class="sc">==</span> <span class="st">&quot;10&quot;</span>, </span>
<span id="cb88-2"><a href="05-Questions-fouille-donnees.html#cb88-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">var_gpe=</span>IRIS, <span class="at">nom_var=</span>nb_proprietaires, <span class="at">var1=</span>IPONDL) </span></code></pre></div>
<pre><code># A tibble: 917 x 2
   IRIS      nb_proprietaires
   &lt;fct&gt;                &lt;dbl&gt;
 1 751010101              107
 2 751010102               52
 3 751010103               35
 4 751010201              472
 5 751010202              302
 6 751010203              511
 7 751010204              328
 8 751010206               95
 9 751010301              584
10 751010302               34
# i 907 more rows</code></pre>
<p>La création de fonctions est donc très utile pour avoir un code plus efficace ; il faut toutefois réfléchir à son usage avant de la créer pour savoir à quel point il faut systématiser les procédures utilisées, certains éléments devant être laissés probablement en-dehors de la fonction, comme dans l’exemple précédent le fait d’arrondir les chiffres. Il faut par ailleurs toujours vérfier, sur un ou deux exemples, que la fonction fonctionne bien, c’est-à-dire donne les mêmes résultats que le code initial.</p>
<p>Pour pouvoir les réutiliser ultérieurement, on peut les réécrire dans un nouveau script qu’on enregistre dans un dossier de notre projet qu’on intitule “fonctions” ; il suffira ensuite d’appeler ce programme avec la fonction <code>source()</code> :</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="05-Questions-fouille-donnees.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;fonctions/fonctions.R&quot;</span>)</span></code></pre></div>

</div>
</div>



<script src="js/tidyverse.js"></script>
            </section>

          </div>
        </div>
      </div>
<a href="04-Récapitulatif.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="06-Intro-a-Shiny-theorique.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Camille-Sisi/github.io-Data-Mining-2023/master/05-Questions-fouille-donnees.Rmd",
"text": "Source"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
